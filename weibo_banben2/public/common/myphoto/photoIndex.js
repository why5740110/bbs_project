(function(f){var c={};var i=function(k){return c[k];};var r=function(k){if(!c[k]){var m={exports:{}};try{f[k].call(m.exports,m,m.exports,r,i)}catch(e){};c[k]=m.exports;}return c[k];};return r('a');})({a:function(e,t,n,r){var i=n("A");var s=n("b");var o=n("B");var u=n("c");var a=n("C");var f=n("D");var l=n("e");var c=n("E");var h=n("f");var p=n("F");var d=n("g");var v=n("G");var m=n("u");var g=n("L");var y=n("U");var b=n("v");var w=n("l");var E=n("V");var S=n("W");var x=n("X");var T=n("Z");var N=n("ab");n("o");n("ac")();var C=i.sizzle("div[node-type=user_info]")[0],k=i.sizzle("div[node-type=photo_list]")[0],L=i.sizzle("div[node-type=photo_page]")[0],A=i.sizzle("div[node-type=photos_info]")[0],O=i.sizzle("ul[node-type=album_list]")[0],M=i.sizzle("div[node-type=album_page]")[0],_=i.sizzle("div[node-type=album_info]")[0],D=u.baseURL,P=u.baseIMG;var H=$CONFIG.owner_uid;var B=$CONFIG.account_uid==$CONFIG.owner_uid;var j={pagination:null,who:"",slide:null,page:1,count:0,pSize:15,node:{},photoData:{},init:function(){var e=$CONFIG.owner_data;var t;if(e&&e.gender){t=e.gender}this.who=B?"我":t=="f"?"她":"他";var n=parseInt(c("page",true),10);if(n){this.page=n}else{this.page=$CONFIG.page||1}this.getAllPhoto(H,this.showPhotos);this.initEvent()},initEvent:function(){var e=i.delegatedEvent(k);var t=this;e.add("photo_forward","click",this.forward);e.add("photo_del","click",this.delPhoto);e.add("like","click",this.like);e.add("unlike","click",this.unlike);e.add("photo_edit","click",this.editPhoto);i.addEvent(i.sizzle("a[action-type=slide_open]")[0],"click",function(){if(!f.isLogin()){window.location.reload();return false}if(!t.slide){t.slide=new T({data:t.currentPageData,current:t.currentPageData[0]["photo_id"]||"",total:t.count,pageSize:t.pSize,inpage:t.page,dataurl:D+"photos/get_latest?uid="+$CONFIG["owner_uid"]});t.slide.closeCallback=function(){t.loadPhotos({page:t.page})};t.slide.init()}else{t.slide.update(t.currentPageData[0]["photo_id"],t.currentPageData,t.page,t.count,null)}return false});i.custEvent.define(b,["sendFeed"]);i.custEvent.add(b,"sendFeed",function(e,t){b.setFeed(t)})},forward:function(e){if(!f.isLogin()){location.reload();return}var t,n,r;var s=e.el;var u=a(s,{expr:"li"})[0];var l=i.queryToJson(u.getAttribute("action-data")).pid;var c={};if(j.photoData[l]){t=j.photoData[l];if(parseInt(t["property"])!=1)return;n=t.uid;r=t.type;c.who=$CONFIG.owner_data.name;c.img=p(t,"thumb150");c.album="";c.photoID=l;c.uid=n;c.target_id=l;c.target_uid=n;c.type=r;c.on_share=function(e){s.innerHTML='<span class="M_ico M_icon4"></span><span>'+e.retweet_count||0+"</span>"}}i.preventDefault(e.evt);o({url:D+"photos/get_photo_album_info",args:{photo_id:l,uid:n,type:r},onComplete:function(e){if(e&&e.data){c.caption=e.data.caption;v(c)}else{}}})},showPhotos:function(e){var t,n=[],r,i,s,o,u;n.push('<ul class="photoList clearfix">');for(var a=0,f=e.length;a<f;a++){n.push(this.createPhoto(e[a]))}n.push("</ul>");k.innerHTML=n.join("")},createPhoto:function(e){var t,n=[],r,i,s,o,u;if(e){t=e;this.photoData[t.photo_id]=t;i=t.count;o=t.type;u=t.url;s=t.is_liked;r=D+H+"/"+(o==15?"talbum":"photos")+"/detail/photo_id/"+t.photo_id;n.push('<li action-data="pid='+t.photo_id+"&aid="+t.album_id+"&type="+o+'">');n.push('<dl class="m_photoItem m_photoItem_a">');n.push('<dt class="photo"><a href="'+r+'" title="'+t.caption_render+'"><img src="'+p(t,"small")+'"></a></dt>');n.push("<dd>");n.push('<div class="mark_box M_txtb">');n.push('<p class="time">'+t.created_at+"</p>");if(parseInt(t.property,10)==1){n.push('<a class="M_linke M_transmit_sm" href="#" title="分享" action-type="photo_forward"><span class="M_ico M_icon4"></span>'+i.retweets+"</a>")}else{n.push('<a class="M_txtb M_transmit_un" href="javascript:void(0)"><span class="M_ico M_icon4_un"></span><span>'+i.retweets+"</span></a>")}n.push('<a class="M_linke M_comment_sm" title="评论" href="'+r+'"><span class="M_ico M_icon5"></span>'+i.comments+"</a>");n.push('<a class="M_linke M_like_sm" title="赞" href="#" action-data="target_id='+t.photo_id+"&like_uid="+t.uid+"&type="+o+"&property="+t.property+"&count="+i.likes+'" action-type="'+(s?"unlike":"like")+'"><span class="M_ico '+(s?"M_icon6_on":"M_icon6")+'"></span>'+i.likes+"</a>");n.push("</div>");n.push('<p class="desc" title="'+t.caption_render+'">'+t.caption_render.cutString(30,"...")+"</p>");if(B){n.push('<div class="edit_tip"><a href="#" action-type="photo_edit">编辑</a><span class="M_vline M_txtd"></span><a href="#" action-type="photo_del">删除</a></div>')}n.push("</dd>");n.push("</dl>");n.push("</li>")}return n.join("")},getAllPhoto:function(e,t){var n=this,r;o({url:D+"photos/get_latest",args:{uid:H,page:this.page,count:this.pSize},onComplete:function(e){if(e&&e.result){n.count=r=e.data.total;if(n.count===0){n.noData();l(i.sizzle("a[action-type=slide_open]")[0]);l(k)}else{A.innerHTML=n.who+"的照片<span>(共"+r+"张)</span>"}if(!n.pagination){n.pagination=new s({total:r,pageSize:n.pSize,pageIndex:n.page,node:L,callback:n.loadPhotos,scope:n});n.pagination.initUI()}n.currentPageData=e.data.photo_list;if(t&&typeof t==="function"){t.call(n,e.data.photo_list);n.pagination.updateUI(n.count)}}else{}}})},noData:function(){var e='<div class="m_yllw_clew">';if(this.isSelf){e+='<span class="txt">您还没有上传照片，点击这里<a class="M_linka" href="'+D+"upload/index"+'">开始上传</a>吧！</span>'}else{e+='<span class="txt">'+this.who+'还没有上传照片，去<a class="M_linka" href="'+D+"welcome/hot"+'">相册广场</a>看看吧！</span>'}e+="</div>"},editPhoto:function(e){i.preventDefault();var t=a(e.el,{expr:"li"})[0];var n=i.queryToJson(t.getAttribute("action-data")).pid;var r={};if(j.photoData[n]){var s=j.photoData[n];r.caption=s.caption_render;r.tags=s.tags;r.isCover=r.is_cover;r.photoID=n}r.afterEvent=function(e){t.innerHTML=j.createPhoto(e)};x(r)},delPhoto:function(e){function l(e){var n,r;if(e){n=e.parentNode;i.removeNode(e);r=n.children;A.innerHTML=t.who+"的照片<span>(共"+ --t.count+"张)</span>";if(r.length==0){if(t.pagination.pageCount==t.page&&t.page>1){t.pagination.pageIndex=--t.page}t.loadPhotos({page:t.page})}}}var t=j;var n=a(e.el,{expr:"li"})[0];var r=i.queryToJson(n.getAttribute("action-data"));var s=y["12003"],u="error";i.preventDefault(e.evt);m(y["12001"],{ok:function(){if(!f.isLogin()){location.reload();return}o({method:"post",url:D+"photos/trash",args:{photo_id:r.pid},onComplete:function(e){if(e&&e.data){s=y["12002"];u="suced";l(n)}g(e.msg||s,{type:u,autoClose:1500})}})}})},like:function(e){var t=e.data;b.set({like_uid:t["like_uid"],target_id:t["target_id"],type:t["type"]},function(n){var r=n.data;j.setLikeButton(t,e.el,"unlike","M_icon6_on",parseInt(t["count"],10)+1);t["is_feed"]=r.result.is_feed;if(t["property"]==1){delete t["count"];b.likeTip(function(e){g(n.msg||"赞图成功");t=w(t,e);i.custEvent.fire(b,"sendFeed",t)},e.el)}});i.preventDefault(e.evt)},unlike:function(e){var t=e.data;b.cancel({like_uid:t["like_uid"],target_id:t["target_id"],type:t["type"]},function(n){j.setLikeButton(t,e.el,"like","M_icon6",parseInt(t["count"],10)-1);g(n.msg||"取消赞图成功")});i.preventDefault(e.evt)},setLikeButton:function(e,t,n,r,s){if(t){e["count"]=s=s<0?0:s;t.setAttribute("action-data",i.jsonToQuery(e));t.setAttribute("action-type",n);t.innerHTML='<span class="M_ico '+r+'"></span>'+s}},loadPhotos:function(e){if(!f.isLogin()){location.reload();return}this.page=e.page;h({page:this.page});this.getAllPhoto(H,this.showPhotos);d(k)}};j.init();N.init(O,M,function(e,t){_.innerHTML="共"+t+"个专辑"});E(i.E("nav_normal"));S(i.E("user_info"))},A:function(e,t,n,r){e.exports=window.STK.getPKG("theia")},b:function(e,t,n,r){var i=n("A");var s=function(e){var t=this;var n=i.C("div");n.className="m_pages";this.total=e.total||0;this.pageSize=e.pageSize||2;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1;this.updateCount=function(){t.pageCount=t.total%t.pageSize===0?~~(t.total/t.pageSize):~~(t.total/t.pageSize)+1};this.pageIndex=e.pageIndex||1;this.maxShowNum=e.maxShowNum==undefined?10:e.maxShowNum;this.leftcallback=e.leftcallback||function(){};this.rightcallback=e.rightcallback||function(){};this.ui=e.node||n;this.callback=e.callback||function(){};this.scope=e.scope||this;this.uiMode=1;var r=i.delegatedEvent(this.ui);this.getDataRange=function(e){e=e||this.pageIndex;if(e>=1&&e<=this.pageCount){var t=this.pageSize*(e-1),n=t+this.pageSize-1;n=n>this.total-1?this.total-1:n;this.pageIndex=e;return{start:t,end:n,page:e}}};this.updateUI=function(e,t,n){this.total=e;this.pageIndex=t||this.pageIndex;this.pageSize=n||this.pageSize;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1;if(this.pageCount>1){if(this.uiMode==1){this.initUI(true)}else if(this.uiMode==2){this.initUI2()}else if(this.uiMode==3){this.initUI3()}}else{this.ui.innerHTML=""}};this.initUI=function(e){var t=[],n=this,s=parseInt(this.pageIndex,10);this.uiMode=1;if(this.pageCount>1){if(s!==1){t.push('<a href="#" action-type="pageTo" action-data="page=prev" class="M_btn_c pre">上一页</a>')}t.push('<div class="list" action-type="page_list">');t.push('<div class="its" style="display:none">');var o=parseInt(this.maxShowNum/2,10);var u=this.pageIndex+o<=this.maxShowNum?1:this.pageIndex-this.maxShowNum+o;u=u>0?u:1;var a=u+this.maxShowNum-1;a=a>this.pageCount?this.pageCount:a;for(var f=a;f>=u;f--){if(f!==s){t.push('<a href="#" action-type="pageTo" action-data="page='+f+'">第 '+f+" 页</a>")}else{t.push('<a href="#" class="current">第 '+f+" 页</a>")}}t.push("</div>");if(parseInt(this.maxShowNum,10)===0){t.push('<span class="t">第 '+s+" 页</span>")}else{t.push('<a class="M_linke" href="#"><span class="t">第 '+s+' 页</span><span class="M_ico M_icon31"></span></a>')}t.push("</div>");if(s!==this.pageCount){t.push('<a class="M_btn_c next" action-type="pageTo" action-data="page=next" href="#">下一页</a>')}t.push("</div>")}this.ui.innerHTML=t.join("");if(!e){var l,c=null,h=null;r.add("page_list","mouseover",function(e){if(n.maxShowNum>0){if(c)window.clearTimeout(c);if(h)window.clearTimeout(h);h=setTimeout(function(){l=i.sizzle(".its",e.el)[0];if(l)l.style.display="block"},500)}});r.add("page_list","mouseout",function(e){if(n.maxShowNum>0){l=i.sizzle(".its",e.el)[0];if(h)window.clearTimeout(h);c=window.setTimeout(function(){if(l)l.style.display="none"},500)}})}};this.initUI2=function(e){var t=[],n=this.pageIndex;this.uiMode=2;if(this.pageCount>1){if(n!==1){t.push('<a class="M_btn_c" href="#" action-type="pageTo" action-data="page=prev">上一页</a>')}var r=parseInt(this.maxShowNum/2,10);var i=this.pageIndex+r<=this.maxShowNum?1:this.pageIndex-this.maxShowNum+r;var s=i+this.maxShowNum-1;s=s>this.pageCount?this.pageCount:s;i=i>0?i:1;if(i>2){t.push('<a href="#" action-type="pageTo" action-data="page=1">1</a>');t.push('<span class="doccolor">...</span>')}for(var o=i;o<=s;o++){if(o!==n){t.push('<a href="#" action-type="pageTo" action-data="page='+o+'">'+o+"</a>")}else{t.push('<a href="#" class="current">'+o+"</a>")}}if(s<this.pageCount-1){t.push('<span class="doccolor">...</span>');t.push('<a href="#" action-type="pageTo" action-data="page'+this.pageCount+'">'+this.pageCount+"</a>")}if(n!==this.pageCount){t.push('<a class="M_btn_c" action-type="pageTo" action-data="page=next" href="#">下一页</a>')}}this.ui.innerHTML=t.join("")};this.initUI3=function(){var e=[],t=this.pageIndex;this.uiMode=3;if(this.pageCount>1){if(t!==1){e.push('<a class="M_btn_c" href="#" action-type="pageTo" action-data="page=prev">上一页</a>')}if(this.pageCount>1){e.push('<a href="#" class="current" action-type="pageTo" action-data="page='+t+'">'+t+"</a>")}if(t!==this.pageCount){e.push('<a class="M_btn_c" action-type="pageTo" action-data="page=next" href="#">下一页</a>')}}this.ui.innerHTML=e.join("")};this.gotoPage=function(e){var t=this;switch(e){case"prev":if(t.pageIndex-1>=1){t.pageIndex--}if(t.leftcallback&&typeof t.leftcallback==="function"){t.leftcallback.apply(t.scope,[t.pageIndex-1])}break;case"next":if(t.pageIndex+1<=t.pageCount){t.pageIndex++}if(t.rightcallback&&typeof t.rightcallback==="function"){t.rightcallback.apply(t.scope,[t.pageIndex-1])}break;default:e=parseInt(e,10)||parseInt(e.match(/\d{1,}/)[0],10);if(e===t.pageIndex){return}t.pageIndex=e;break}if(t.uiMode==1){t.initUI(true)}else if(t.uiMode==2){t.initUI2()}else if(t.uiMode==3){t.initUI3()}};this.init=function(){r.add("pageTo","click",function(e){var n=e.data["page"];window.setTimeout(function(){t.gotoPage(n);if(t.callback&&typeof t.callback==="function"){t.callback.apply(t.scope,[t.getDataRange()])}},0);i.preventDefault(e.evt)})};this.init();this.destroy=function(){r.destroy();i.removeNode(this.ui)}};e.exports=s},B:function(e,t,n,r){var i=n("A");var s=i.funcEmpty;e.exports=function(e){var t={};var n=[];var r=null;var o=false;var u=i.parseParam({url:"",method:"get",responseType:"json",args:{},timeout:30*1e3,onTraning:i.funcEmpty,isEncode:true},e);u.onComplete=function(t){o=false;if(typeof e.onComplete==="function"){e.onComplete(t,u.args)}};u.onFail=function(t){o=false;if(typeof e.onFail==="function"){try{s(u);e.onFail(t,u.args)}catch(n){}}};u.onTimeout=function(t){o=false;try{s(u);if(typeof e.onTimeout==="function"){e.onTimeout(t)}}catch(n){}};if(o&&u.needLock)return;o=true;i.ajax(u)}},c:function(e,t,n,r){var i="http://js.app.wcdn.cn/ops/photo/";var s="http://img.t.sinajs.cn/t4/appstyle/photo/";var o="http://img.app.wcdn.cn/ops/photo/style/";var u=$CONFIG.script_version;var a=$CONFIG.style_version;e.exports={baseURL:$CONFIG.base_url,baseIMG:s+"images/",baseCSS:s+"css/",baseSWF:"http://js.t.sinajs.cn/t5/album/static/swf/v5/",baseJS:i+"/js/v5/",base:o,imgVersion:a,jsVersion:u,cssVersion:a}},C:function(e,t,n,r){var i=n("A");var s=n("d");e.exports=function(e,t){t=i.parseParam({expr:undefined,endpoint:document,maxLength:1},t);var n=t.expr;if(!e||!n){i.log("kit parents: node or opts.expr is undefined.");return}return s(e,t)}},d:function(e,t,n,r){var i=n("A");e.exports=function(e,t){t=i.parseParam({dir:"parentNode",expr:undefined,endpoint:document,maxLength:1},t);var n=t.dir,r=t.expr,s=t.endpoint,o=t.maxLength;if(!e||!r){i.log("kit dir: node or opts.expr is undefined.");return}var u=[],a=e[n];while(a){if(a.nodeType==1&&i.sizzle(r,null,null,[a]).length>0){u.push(a);if(u.length==o){break}}if(a==s){break}a=a[n]}return u}},D:function(e,t,n,r){var i={isLogin:function(){var e=document.cookie+";";var t=["SUP","=([^;]*)?;"].join("");var n=["(\\?|&)","uid","=([^&]*)(&|$)"].join("");var r=e.match(new RegExp(t,"i"));r=r?r[1]||"":"";r=unescape(r);var i=r.match(new RegExp(n));i=i?i[2]||"":"";var s=$CONFIG.account_uid;if(i&&s==i)return true;return false}};e.exports=i},e:function(e,t,n,r){e.exports=function(e){if(!e||e.nodeType!==1){throw"/bp/dom/hide() need a element node as parameter"}e.style.display="none"}},E:function(e,t,n,r){var i=function(e,t){var n,r=location.href,i=r.indexOf("#!");n=r.substring(i+3);if(n==="")return false;var s=n.split("/");for(var o=0,u=s.length;o<u;o++){if(decodeURIComponent(s[o])==e){if(t&&s[o+1])return decodeURIComponent(s[o+1]);return true}}return false};e.exports=i},f:function(e,t,n,r){var i=function(e,t){var n=location.hash,r,i=[],s=[];var o=n.split("/");var u,a;o.shift();if(typeof e=="object"){if(t){for(u in e){s.push(u);s.push(e[u])}}else{for(u in e){r=true;for(a=0,len=o.length;a<len;a++){if(o[a]==u){o[a+1]=e[u];r=false;break}}if(r){i.push(u);i.push(e[u])}}s=o.concat(i)}}else if(typeof e=="string"){if(t){s.push(e)}else{r=true;for(a=0,len=o.length;a<len;a++){if(e==o[a]){r=false;break}}if(r)i.push(e);s=o.concat(i)}}location.hash="#!/"+s.join("/")};e.exports=i},F:function(e,t,n,r){var i=function(e,t){if(!e)return undefined;if(e["pic_type"]==2&&e["pri_"+t+"_pic"]){return e["pri_"+t+"_pic"]}var n=e["pic_host"],r=e["pic_type"],i=e["uid"],s=e["pic_name"];if(n&&s){if(r==1){return n+"/"+t+"/"+s}else if(r==0&&e["avatar_large"]){return e["avatar_large"]}}else{return e[t+"_pic"]}};e.exports=i},g:function(e,t,n,r){var i=n("A");var s=function(e){var t=45;var n=i.position(e);var r=n.t-t>0?n.t-t:0;window.scrollTo(n.l,r)};e.exports=s},G:function(e,t,n,r){function E(e,t){s({url:y+"sina/get_comment_setting",args:{target_id:e},onComplete:function(e){if(e&&e.result){if(t){t(e)}}}})}function S(e,t){s({url:y+"sina/retweet",method:"post",args:e,onComplete:function(e){if(t&&g(t)==="function"){t.call(this,e)}}})}var i=n("A");var s=n("B");var o=n("h");var u=n("L");var a=n("M");var f=n("O");var l=n("p");var c=n("l");var h=n("q");var p=n("t");var d=n("L");var v=n("T");var m=n("c");var g=i.getType;var y=$CONFIG.base_url||m.baseURL;var b=i.core.util.easyTemplate;var w='<#et temp data><div class="L_forward">'+'<div class="m_forward">'+'<p class="M_txtg letrCount" node-type="letterCount">还可以输入<span>${data.letterCount}</span>个字</p>'+'<div class="txtarea">'+'<textarea class="M_txtarea" node-type="cnt">${data.content}</textarea>'+"</div>"+'<div class="face_cmn clearfix">'+'<div class="face">'+'<span class="M_ico M_icon30" action-type="show_face"></span>'+'<label class="t M_txtg" node-type="reply"><input type="checkbox" node-type="checkbox" class="M_checkbox">同时评论给</label>'+'<a class="M_linkh" href="#" node-type="feed_owner"></a>'+"</div>"+'<div class="send_cmn"><a href="javascript:void(0)" node-type="share" class="M_btn_e" action-type="share"><span>分享</span></a></div>'+"</div>"+"</div>"+'<dl class="forwardAlbum clearfix">'+'<dt class="phto"><img src="${data.img}" width="150" height="150"></dt>'+"</dl>"+"</div></#et>";e.exports=function(e){var t,n,r,s,m;var g,y,x,T;var N,C;var k={};var L=false;var A=f;var O={init:function(){O.pars();O.build();O.bind()},pars:function(){t=c({title:"分享到我的微博"},e);var i=t.caption;r="@"+t.who||"";n=t.isAlbum?r+" 的专辑 "+i+" 很棒，推荐给大家！":r+" 的照片很棒(来自专辑 "+i+")，推荐给大家！"},build:function(){g=o(null,t);var e=b(w,{content:n,img:t.img,letterCount:130-Math.ceil(i.bLength(n)/2)});g.setContent(e.toString());g.setTitle(t["title"]);s=g.getDomList(true);y=s["cnt"];var u=s["feed_owner"];if(u){u.href="http://weibo.com/u/"+t.target_uid;u.innerHTML=r}E(t.target_id||0,function(e){if(e&&!e.data){i.removeNode(s["reply"]);i.removeNode(s["feed_owner"])}g.setMiddle().show();C=l({nodeList:{textEl:y,wordNum:s["letterCount"]},opts:{limitNum:130}})});m=h({nodeList:{textEl:y}});m.init()},bind:function(){N=i.delegatedEvent(g.getBox());var e=function(){var e=i.trim(y.value);if(""===e){miniTip("内容不能为空");return}var n=s["checkbox"];var r={url:t.img,content:e,type:t.type,is_comment:n?n.checked:false,target_id:t.target_id,target_uid:t.target_uid,album_id:t.albumId};t.from&&(r.from=t.from);var o=function(e){S(e,function(n){g.hide();if(n&&n.result){t.on_share&&t.on_share(n.data);u("分享成功")}else{if(n.code===20032){p({text:n.msg||"操作失败，请重试"})}else if(n.code===15001){v("info",e,o)}else if(n.code===15002){v("error",e,o)}else{d(n.msg||"操作失败，请重试",{type:"error"})}}})};o(r)};var n=function(e){i.stopEvent(e.evt);g.hide()};var r=function(e){a.ShowFace(e.el,y,false)};N.add("share","click",e);N.add("close","click",n);N.add("show_face","click",r);i.custEvent.add(g,"hide",function(){i.custEvent.remove(g,"hide",arguments.callee);N.destroy();C.destroy();g.destroy();a.hide()})}};O.init();k.dia=g;k.hide=g.hide;return k}},h:function(e,t,n,r){var i=n("A");var s=n("H");var o=n("i");var u=n("l");var a=""+'<div class="L_layer" node-type="outer" style="display:none;position:absolute;">'+'<div class="bg">'+'<table border="0" cellspacing="0" cellpadding="0">'+"<tr><td>"+'<div class="content" node-type="layoutContent">'+'<div node-type="title" class="title" style="cursor: move;"><span node-type="title_content"></span></div>'+'<a node-type="close" action-type="close" title="关闭" href="javascript:void(0)" class="close"></a>'+'<div node-type="inner"></div>'+"</div>"+"</td></tr>"+"</table>"+"</div>"+"</div>";e.exports=function(e,t){var n,r,f,l,c,h,p,d,v;var m;var g;var y=function(){m.hide()};var b={close:function(e){i.stopEvent();m.hide()},show:function(){if(i.IE){document.body.focus()}else{document.documentElement.focus()}i.hotKey.add(document.documentElement,["esc"],y,{type:"keyup",disableInInput:true})}};var w={init:function(){w.pars();w.build();w.bind()},pars:function(){t=u({haveMask:true},t);t.template=a},build:function(){n=o(e,t);r=n.getBox();f=n.getDomList(true);l=f["title"];c=f["title_content"];v=f["layoutContent"];h=f["inner"];p=f["close"];t.haveMask&&n.setMask();d=i.objSup(n,["hide"])},bind:function(){var e=i.delegatedEvent(r);e.add("close","click",b.close);s(l,{actObj:n,moveDom:r});i.custEvent.add(n,"show",b.show);i.custEvent.add(n,"hide",function(){i.custEvent.remove(n,"hide",arguments.callee);i.custEvent.remove(n,"show",b.show);e.destroy();i.hotKey.remove(document.documentElement,["esc"],y,{type:"keyup"});s.destroy()})}};w.init();m=n;m.hide=function(e){if(typeof g==="function"&&!e){if(g()===false){return false}}d.hide();return m};m.setClassName=function(e){v.className=e;return m};m.setTitle=function(e){c.innerHTML=e;return m};m.setContent=function(e){h.innerHTML="";if(typeof e==="string"){h.innerHTML=e}else{h.appendChild(e)}return m};m.insertElement=function(e,t){t=t||"beforeend";i.core.dom.insertElement(h,e,t);return m};m.clearContent=function(){while(h.children.length){i.removeNode(h.children[0])}return m};m.setBeforeHideFn=function(e){g=e};m.clearBeforeHideFn=function(){g=null};m.getClose=function(){return p};m.getIndex=function(){var e=r.style.zIndex||0;return parseInt(e,10)};return m}},H:function(e,t,n,r){var i=n("A");e.exports=function(e,t){var n,r,s,o,u,a,f,l;var c=function(){h();p()};var h=function(){n=i.parseParam({moveDom:e,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},t);s=n.moveDom;r={};o={};u=i.drag(e,{actObj:n.actObj});if(n["dragtype"]==="perch"){a=i.C("div");f=false;l=false;s=a}e.style.cursor="move"};var p=function(){i.custEvent.add(n.actObj,"dragStart",d);i.custEvent.add(n.actObj,"dragEnd",v);i.custEvent.add(n.actObj,"draging",m)};var d=function(t,r){document.body.style.cursor="move";var s=i.core.util.pageSize()["page"];o=i.core.dom.position(n.moveDom);o.pageX=r.pageX;o.pageY=r.pageY;o.height=n.moveDom.offsetHeight;o.width=n.moveDom.offsetWidth;o.pageHeight=s["height"];o.pageWidth=s["width"];if(n["dragtype"]==="perch"){var u=[];u.push(n["perchStyle"]);u.push("position:absolute");u.push("z-index:"+(n.moveDom.style.zIndex+10));u.push("width:"+n.moveDom.offsetWidth+"px");u.push("height:"+n.moveDom.offsetHeight+"px");u.push("left:"+o["l"]+"px");u.push("top:"+o["t"]+"px");a.style.cssText=u.join(";");l=true;setTimeout(function(){if(l){document.body.appendChild(a);f=true}},100)}if(e.setCapture!==undefined){e.setCapture()}};var v=function(t,r){document.body.style.cursor="auto";if(e.setCapture!==undefined){e.releaseCapture()}if(n["dragtype"]==="perch"){l=false;n.moveDom.style.top=a.style.top;n.moveDom.style.left=a.style.left;if(f){document.body.removeChild(a);f=false}}};var m=function(e,t){var r=o.t+(t.pageY-o.pageY);var i=o.l+(t.pageX-o.pageX);var u=r+o["height"];var a=i+o["width"];var f=o["pageHeight"]-n["pagePadding"];var l=o["pageWidth"]-n["pagePadding"];if(u<f&&r>0){s.style.top=r+"px"}else{var c;if(u>=f){c=f-o["height"]}if(r<0||c<0){c=0}s.style.top=c+"px"}if(a<l&&i>0){s.style.left=i+"px"}else{if(i<0){s.style.left="0px"}if(a>=l){s.style.left=l-o["width"]+"px"}}};c();r.destroy=function(){document.body.style.cursor="auto";if(typeof s.setCapture==="function"){s.releaseCapture()}if(n["dragtype"]==="perch"){l=false;if(f){document.body.removeChild(a);f=false}}i.custEvent.remove(n.actObj,"dragStart",d);i.custEvent.remove(n.actObj,"dragEnd",v);i.custEvent.remove(n.actObj,"draging",m);if(u.destroy){u.destroy()}n=null;s=null;o=null;u=null;a=null;f=null;l=null};r.getActObj=function(){return n.actObj};return r}},i:function(e,t,n,r){var i=n("A");var s=n("I");var o=n("j");var u=n("k");e.exports=function(e,t){var n,r,a;var f=false;var l;var c={init:function(){c.pars();c.build();c.bind()},pars:function(){},build:function(){n=u(e,t);r=n.getBox();a=i.builder(r).list},bind:function(){}};c.init();l=n;l.getDomList=function(e){if(e){a=s(i.builder(r).list)}return a};l.setMask=function(){i.custEvent.add(n,"show",function(){if(!f){o.showUnderNode(r)}f=true});i.custEvent.add(n,"hide",function(){o.back();f=false})};return l}},I:function(e,t,n,r){e.exports=function(e){for(var t in e){if(e[t]&&e[t].length==1){e[t]=e[t][0]}}return e}},j:function(e,t,n,r){function d(){o=i.C("div");var e='<div node-type="outer">';if(i.core.util.browser.IE6){e+='<div style="position:absolute;width:100%;height:100%;"></div>'}e+="</div>";o=i.builder(e).list["outer"][0];document.body.appendChild(o);f=true;a=s(o,"lt");var t=function(){var e=i.core.util.winSize();o.style.cssText=i.core.dom.cssText(o.style.cssText).push("width",e.width+"px").push("height",e.height+"px").getCss()};p.add(a,"beforeFix",t);t()}function v(e){var t;if(!(t=e.getAttribute(l))){e.setAttribute(l,t=i.getUniqueKey())}return">"+e.tagName.toLowerCase()+"["+l+'="'+t+'"]'}var i=n("A");var s=n("J");var o,u=[],a,f=false,l="STK-Mask-Key";var c=i.core.dom.setStyle,h=i.core.dom.getStyle,p=i.core.evt.custEvent;var m={getNode:function(){return o},show:function(e,t){if(f){e=i.core.obj.parseParam({opacity:.3,background:"#000000"},e);o.style.background=e.background;c(o,"opacity",e.opacity);o.style.display="";a.setAlign("lt");t&&t()}else{d();m.show(e,t)}return m},hide:function(){o.style.display="none";u=[];return m},showUnderNode:function(e,t){if(i.isNode(e)){m.show(t,function(){c(o,"zIndex",h(e,"zIndex"));var t=v(e);var n=i.core.arr.indexOf(u,t);if(n!=-1){u.splice(n,1)}u.push(t);i.core.dom.insertElement(e,o,"beforebegin")})}return m},back:function(){if(u.length<1){return m}var e,t;u.pop();if(u.length<1){m.hide()}else if((t=u[u.length-1])&&(e=i.sizzle(t,document.body)[0])){c(o,"zIndex",h(e,"zIndex"));i.core.dom.insertElement(e,o,"beforebegin")}else{m.back()}return m},resetSize:function(){var e=i.core.util.winSize();o.style.cssText=i.core.dom.cssText(o.style.cssText).push("width",e.width+"px").push("height",e.height+22+"px").getCss();return m},destroy:function(){p.remove(a);o.style.display="none"}};e.exports=m},J:function(e,t,n,r){function u(e){return i.core.dom.getStyle(e,"display")!="none"}function a(e){e=i.core.arr.isArray(e)?e:[0,0];for(var t=0;t<2;t++){if(typeof e[t]!="number")e[t]=0}return e}function f(e,t,n){if(!u(e))return;var r="fixed",o,a,f,l,c=e.offsetWidth,h=e.offsetHeight,p=i.core.util.winSize(),d=0,v=0,m=i.core.dom.cssText(e.style.cssText);if(!s){r="absolute";var g=i.core.util.scrollPos();d=o=g.top;v=a=g.left;switch(t){case"lt":o+=n[1];a+=n[0];break;case"lb":o+=p.height-h-n[1];a+=n[0];break;case"rt":o+=n[1];a+=p.width-c-n[0];break;case"rb":o+=p.height-h-n[1];a+=p.width-c-n[0];break;case"c":default:o+=(p.height-h)/2+n[1];a+=(p.width-c)/2+n[0];break}f=l=""}else{o=l=n[1];a=f=n[0];switch(t){case"lt":l=f="";break;case"lb":o=f="";break;case"rt":a=l="";break;case"rb":o=a="";break;case"c":default:o=(p.height-h)/2+n[1];a=(p.width-c)/2+n[0];l=f="";break}}if(t=="c"){if(o<d)o=d;if(a<v)a=v}m.push("position",r).push("top",o+"px").push("left",a+"px").push("right",f+"px").push("bottom",l+"px");e.style.cssText=m.getCss()}var i=n("A");var s=!(i.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),o=/^(c)|(lt)|(lb)|(rt)|(rb)$/;e.exports=function(e,t,n){var r,u,l=true,c;if(i.core.dom.isNode(e)&&o.test(t)){var h={getNode:function(){return e},isFixed:function(){return l},setFixed:function(t){(l=!!t)&&f(e,r,u);return this},setAlign:function(t,n){if(o.test(t)){r=t;u=a(n);l&&f(e,r,u)}return this},destroy:function(){if(!s){s&&i.core.evt.removeEvent(window,"scroll",p)}i.core.evt.removeEvent(window,"resize",p);i.core.evt.custEvent.undefine(c)}};c=i.core.evt.custEvent.define(h,"beforeFix");h.setAlign(t,n);function p(t){t=t||window.event;i.core.evt.custEvent.fire(c,"beforeFix",t.type);if(l&&(!s||r=="c")){f(e,r,u)}}if(!s){i.core.evt.addEvent(window,"scroll",p)}i.core.evt.addEvent(window,"resize",p);return h}}},k:function(e,t,n,r){var i=n("A");var s=n("K");var o=n("J");var u=n("H");var a='<div node-type="outer" class="L_layer" style="display:none;position:absolute;"></div>';var f=100100;e.exports=function(e,t){var n,r,l,c;var h=null;var p=function(e){var t={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";t.w=e.offsetWidth;t.h=e.offsetHeight;e.style.display="none";e.style.visibility="visible"}else{t.w=e.offsetWidth;t.h=e.offsetHeight}return t};var d=function(e,t){t=t||"topleft";var n={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";n=i.core.dom.position(e);e.style.display="none";e.style.visibility="visible"}else{n=i.core.dom.position(e)}var r=p(e);switch(t){case"topleft":break;case"topright":n["l"]=n["l"]+r["w"];break;case"bottomleft":n["t"]=n["t"]+r["h"];break;case"bottomright":n["l"]=n["l"]+r["w"];n["t"]=n["t"]+r["h"];break;default:break}return n};var v={show:function(){r.style.display="";document.body.appendChild(r);i.custEvent.fire(v,"show");return v},hide:function(){r.style.display="none";i.custEvent.fire(v,"hide");return v},getState:function(){if(r.style.display=="none"){return false}else{return true}},getID:function(){return n.id},getBox:function(){return r},html:function(e){if(typeof e==="string"){r.innerHTML=e}else{r.appendChild(e)}return v},setTop:function(){r.parentNode&&r.parentNode.appendChild(r);return v},setPosition:function(e){r.style.top=e["t"]+"px";r.style.left=e["l"]+"px";return v},getPosition:function(e){return d(r,e)},setLayoutPos:function(e,t){s(r,e,t);return v},setMiddle:function(){var e=i.winSize();var t=v.getSize(true);var s=i.scrollPos()["top"]+(e.height-t.h)/2;r.style.top=(s>0?s:0)+n.offset[1]+"px";r.style.left=(e.width-t.w)/2+n.offset[0]+"px";return v},setAlign:function(e){e=i.parseParam({type:"c",offset:[0,0]},e||{});c=o(r,e.type,e.offset);return v},getSize:function(e){if(e||!h){h=p(r)}return h},setIndex:function(e){r.style.zIndex=e},destroy:function(){r.style.display="none";i.removeNode(r);c&&c.destroy();r=null}};var m={init:function(){m.pars();m.build();m.bind()},pars:function(){n=i.parseParam({id:"layer_"+i.core.util.getUniqueKey(),node:null,template:"",appendTo:document.body,draggable:false,zIndex:null,offset:[0,0]},t||{});if(i.isNode(e)){n.node=e||n.node}else{switch((typeof e||"").toLowerCase()){case"string":n.id=e||n.id;n.node=i.E(n.id)||null;break;case"object":n=i.parseParam(n,e||{});break}}},build:function(){r=n.node;l=n.appendTo;if(!r){nodes=i.builder(n.template||a);r=nodes.list["outer"][0];l&&l.appendChild(r)}else{if(!i.contains(l,r)){l&&l.appendChild(r)}}v.setIndex(n.zIndex||f);r.id=n.id},bind:function(){i.custEvent.define(v,["show","hide"]);if(n.draggable){u(r,{actObj:r,moveDom:r})}}};m.init();return v}},K:function(e,t,n,r){var i=n("A");e.exports=function(e,t,n){if(!i.isNode(t)){throw"kit.dom.layerOutElement need element as first parameter"}if(t===document.body){return false}if(!t.parentNode){return false}if(t.style.display==="none"){return false}var r,s,o,u,a,f,l;r=i.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},n);s=t;if(!s){return false}while(s!==document.body){s=s.parentNode;if(s.style.display==="none"){return false}f=i.getStyle(s,"position");l=s.getAttribute("layout-shell");if(f==="absolute"||f==="fixed"){break}if(l==="true"&&f==="relative"){break}}s.appendChild(e);o=i.position(t,{parent:s});u={w:t.offsetWidth,h:t.offsetHeight};a=r["pos"].split("-");if(a[0]==="left"){e.style.left=o.l+r.offsetX+"px"}else if(a[0]==="right"){e.style.left=o.l+u.w+r.offsetX+"px"}else if(a[0]==="center"){e.style.left=o.l+u.w/2+r.offsetX+"px"}if(a[1]==="top"){e.style.top=o.t+r.offsetY+"px"}else if(a[1]==="bottom"){e.style.top=o.t+u.h+r.offsetY+"px"}else if(a[1]==="middle"){e.style.top=o.t+u.h/2+r.offsetY+"px"}return true}},l:function(e,t,n,r){var i=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=Array.apply([],arguments),r=1,s,o=typeof n[n.length-1]=="boolean"?n.pop():true;if(n.length===1){e=!this.window?this:{};r=0}while(t=n[r++]){for(s in t){if(i.call(t,s)&&(o||!(s in e))){e[s]=t[s]}}}return e}},L:function(e,t,n,r){var i=n("A");var s=n("m");var o=n("l");var u='<div class="L_min_prompt">'+'<div class="prompt M_txtc">'+'<span class="mk_ico" node-type="icon"></span><span class="cont" node-type="msg"></span>'+"</div>"+"</div>";var a={suced:"mk_suced",error:"mk_fail",remind:"mk_remind"};e.exports=function(e,t){var n,r,f,l={};var c={init:function(){c.pars();c.build();c.bind()},pars:function(){t=o({temp:"",mask:false,type:"suced",timer:2e3},t)},build:function(){r=s(t.temp||u,t);f=r.getDomList(true);if(f.icon){i.addClassName(f.icon,a[t["type"]||"suced"])}if(f.msg){f.msg.innerHTML=e}r.setMiddle().show()},bind:function(){var e=parseInt(t.timer,10);if(e){setTimeout(function(){r.hide()},e)}}};c.init();l.layer=r;return l}},m:function(e,t,n,r){var i=n("A");var s=n("i");var o=n("H");e.exports=function(e,t){var n={};var r,u,a,f,l,c;var h=10003;var p;var d;var v={box:'<div class="L_layer" node-type="outer" style="position:absolute;clear:both;display:none;">'+'<div node-type="inner" class="bg">'+'<table border="0" cellpadding="0" cellspacing="0">'+"<tbody><tr><td>"+'<div class="content" node-type="content"></div>'+"</td></tr></tbody>"+"</table>"+"</div>"+"</div>"};var m={ok:function(e){i.stopEvent(e.evt);if(i.getType(t.okCallback)=="function"&&t.okCallback(e)==false){return}n.hide()},cancel:function(e){i.stopEvent(e.evt);if(i.getType(t.cancelCallback)=="function"){t.cancelCallback(e)}n.hide()}};var g={init:function(){g.pars();g.build();g.bind()},pars:function(){t=i.parseParam({okCallback:i.funcEmpty,cancelCallback:i.funcEmpty,showCallback:i.funcEmpty,hideCallback:i.funcEmpty,draggable:true,mask:true},t||{})},build:function(){var n=i.builder(v.box).list;a=n.outer[0];r=s(a);f=n.inner[0];content=n.content[0];content.innerHTML=e||"";u=r.getDomList(true);l=u.title;if(t.mask){r.setMask()}c=i.objSup(r,["destroy"])},bind:function(){d=i.delegatedEvent(a);d.add("ok","click",m.ok);d.add("cancel","click",m.cancel);if(l&&t.draggable){o(l,{actObj:r,moveDom:a})}i.custEvent.add(r,"hide",function(){i.custEvent.remove(r,"hide",arguments.callee);n.destroy();o.destroy()})}};g.init();n=r;n.layer_size=r.getSize();n.setContent=function(e){if(typeof e=="string"){content.innerHTML=e}else{content.appendChild(e)}return n};n.setLayerXY=function(e){if(!e){i.log("ui.tip.setLayerXY need element as pNode")}var t=i.position(e);var s=t.l;var o=e.offsetWidth;var u=e.offsetHeight;var a=n.layer_size.w;var f=Math.min(Math.max(s+(o-a)/2,i.scrollPos().left),i.scrollPos().left+STK.winSize().width-a);var l=t.t+u;var c=[";"];c.push("height:",n.tipHeight,"px;");c.push("top:",l,"px;");c.push("left:",f,"px;");r.getBox().style.cssText+=c.join("")};n.addEvent=function(e,t,n){d.add(e,t,n)};n.destroy=function(){c.destroy();d.destroy();r=null};return n}},M:function(e,t,n,r){function p(){if(h)h.style.display="none"}var i=n("A");var s=n("B");var o=$CONFIG["base_url"];var u=n("b");var a=n("j");var f=n("n");var l=n("N");var c={};var h=null;n("o");c.ShowFace=function(){function L(){A();y=new u({node:d,callback:j});b=new u({node:w,callback:P});B();M();var e=i.delegatedEvent(h);i.addEvent(document.body,"click",function(e){var n=e.target||e.srcElement;if(t!==n&&!i.contains(h,n)){p()}else{i.preventDefault(e)}});e.add("face_close","click",function(e){i.preventDefault(e.evt);p()});e.add("category","click",function(e){i.preventDefault(e.evt);var t=e.el.parentNode.children;for(var n=0,r=t.length;n<r;n++){i.removeClassName(t[n],"current")}i.addClassName(e.el,"current");i.core.dom.neighbor(e.el);var s=e.data["name"];if(s){if(s==E)return;E=s;q()}});i.addEvent(m,"click",function(e){if(v=="general")return;i.addClassName(m,"current");i.removeClassName(g,"current");f.style.display="block";z("general","face");i.preventDefault(e)});i.addEvent(g,"click",function(e){if(v=="magic")return;i.addClassName(g,"current");i.removeClassName(m,"current");f.style.display="none";n.innerHTML="";a.innerHTML='<li class="M_loading"></li>';z("magic","ani");i.preventDefault(e)});e.add("insert","click",function(e){var t=e.el;var n=e.data["text"];if(n&&r){N.insertText(n,k);k.start+=n.length;N.setCursor(k)}h.style.display="none"});e.add("play","click",function(e){var t=e.data["url"];c.PopUpSwfPlayer(t)})}function A(){var e='<div class="bg">                                <table border="0" cellspacing="0" cellpadding="0">                                        <tbody><tr>                                            <td>                                                <div class="content">                                                    <a href="#" class="close" action-type="face_close"></a>                                                    <div class="m_tab M_txtb">                                                      <p class="M_txtb"><a href="#" class="current" node-type="general">常用表情</a><em class="M_vline"></em><a href="#" node-type="magic"><span class="M_ico ico_magic"></span>魔法表情</a></p>                                                    </div>                                                    <div class="L_faces">                                                        <p class="tab_kind M_linka">                                                            <span class="right" node-type="tabPage"></span>                                                            <em node-type="categorys"></em>                                                        </p>                                                        <div class="detail">                                                            <ul class="faces_list faces_list_hot clearfix" node-type="hotFace"></ul>                                                            <ul class="faces_list clearfix" node-type="inner"><li class="M_loading"></li></ul>                                                            <div class="m_pages_minibtn M_linke" node-type="page"></div>                                                        </div>                                                    </div>                                                </div>                                            </td>                                        </tr>                                </tbody></table>                                <div class="arrow arrow_t" node-type="arrow"></div>                            </div>';h=i.C("div");h.innerHTML=e;h.className="L_layer";var t=i.builder(h).list;h.style.zIndex=C;n=t["categorys"][0];a=t["inner"][0];f=t["hotFace"][0];d=t["page"][0];w=t["tabPage"][0];m=t["general"][0];g=t["magic"][0];document.body.appendChild(h)}function O(e,t){s({method:"get",url:o+"sina/get_faces",args:{type:e},onComplete:function(e){if(t&&typeof t==="function"){t.apply(this,arguments)}}})}function M(){b.initUI=function(){var e=[];if(this.pageIndex>1){e.push('<a href="#" action-type="pageTo" action-data="page=prev" class="pre"></a>')}else{e.push('<a href="#" class="pre_d"></a>')}if(this.pageCount>1&&this.pageIndex<this.pageCount){e.push('<a href="#" action-type="pageTo" action-data="page=next" class="next"></a>')}else{e.push('<a href="#" class="next_d"></a>')}this.ui.innerHTML=e.join("")};b.init=function(e,t){this.pageIndex=1;this.pageSize=t;this.total=e;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1}}function _(e){var t=[];t=Object.keys(e);t.unshift("默认");return t}function D(){var t,n=[],r,i;if(e["general"]&&e["general"]["usual"]["hot"]){i=e["general"]["usual"]["hot"];for(var s=0,o=i.length;s<o&&s<12;s++){t=i[s];r=t.phrase.replace(/\[([^\]]+)\]/,"$1");n.push('<li action-type="insert" action-data="text='+t.value+'"><img title="'+r+'" alt="'+r+'" src="'+t.url+'"></li>')}}f.innerHTML=n.join("")}function P(e){var t=[],r;for(var i=e.start;i<=e.end;i++){r=x[i];t.push("<a "+(E==r?'class="current"':"")+' action-type="category" action-data="name='+r+'" href="#">'+r+"</a>");t.push('<em class="M_vline"></em>')}t.pop();n.innerHTML=t.join("")}function H(){x=_(v!=="magic"?e["general"]["more"]:e["magic"]["more"]);b.init(x.length,5);b.initUI();P(b.getDataRange())}function B(){y.initUI=function(){var e=[],t=this.pageIndex;if(this.pageCount>1){if(t!==1){e.push('<a class="reverse" action-type="pageTo" action-data="page=prev" href="#"></a>')}var n=this.pageCount;var r=1;r=r>this.pageCount?this.pageCount:r;for(var i=r;i<=n;i++){if(i!==t){e.push('<a href="#" action-type="pageTo" action-data="page='+i+'">'+i+"</a>")}else{e.push('<a href="#" class="current">'+i+"</a>")}}if(t!==this.pageCount){e.push('<a class="next" action-type="pageTo" action-data="page=next" href="#"></a>')}}this.ui.innerHTML=e.join("")};y.init=function(e,t){this.pageSize=t;this.total=e;this.pageIndex=1;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1}}function j(e){if(v!=="magic"){F(e)}else{I(e)}U()}function F(e){var t,n=[],r;if(S){for(var s=e.start,o=e.end;s<=o;s++){t=S[s];r=t.phrase.replace(/\[([^\]]+)\]/,"$1");n.push('<li action-type="insert" action-data="text='+t.value+'"><img title="'+r+'" alt="'+r+'" src="'+t.url+'"></li>')}}i.addClassName(a,"faces_list");i.removeClassName(a,"faces_magic_list");a.innerHTML=n.join("")}function I(e){var t,n=[],r;if(S){for(var s=e.start,o=e.end;s<=o;s++){t=S[s];r=t.phrase.replace(/\[([^\]]+)\]/,"$1");n.push('<li><a href="#" action-type="insert" action-data="text='+t.value+' " class="img"><img src="'+t.url+'" title="'+r+'" alt="'+r+'" /></a><a href="#" action-type="play" action-data="url='+t.swf+'" class="M_ico play" title="表情预览"></a><span>'+r+"</span></li>")}}i.addClassName(a,"faces_magic_list");i.removeClassName(a,"faces_list");a.innerHTML=n.join("")}function q(){var t=72,n;if(v!=="magic"){if(E!=="默认"){S=e["general"]["more"][E];f.style.display="none"}else{S=e["general"]["usual"]["norm"];f.style.display=""}}else{S=E!=="默认"?e["magic"]["more"][E]:e["magic"]["usual"]["norm"];t=12}y.init(S.length,t);y.initUI();n=y.getDataRange();j(n)}function R(){if(T){i.sizzle("div[node-type=arrow]")[0].className="arrow arrow_b"}h.style.display="block";document.body.appendChild(h)}function U(){var e=-30,n=5,r,s;if(t){var o=i.position(t);var u=i.core.dom.getSize(t).height;if(T){var a=i.core.dom.getSize(h).height;r=o.t-a-n;s=o.l+e}else{r=o.t+u;s=o.l+e}h.style.top=r+"px";h.style.left=s+"px"}}function z(t,n){v=t;E="默认";if(!e[t]){O(n,function(n){if(n&&n.data){e[t]=n.data;D();H();q()}})}else{H();q()}}var e={};var t=null;var n=null;var r=null;var a=null;var f=null;var d=null;var v="general";var m=null;var g=null;var y=null;var b=null;var w=null;var E="默认";var S=null;var x=null;var T=false;var N=null;var C=1000100;var k;return function(e,n,s,o){t=e||t;T=s||T;C=o||C;r=n||r;N=l(r);k=N.getCursor();if(!h)L();i.addClassName(m,"current");i.removeClassName(g,"current");z("general","face");R()}}();c.hide=function(){p()};c.popLay=function(){return h};c.PopUpSwfPlayer=function(){var e,t,n=360,r=440;return function(s){var o="view_ani",u,l=window,c=document,h=c.documentElement||{},p=c.body;if(!f.hasFlashPlayerVersion("9.0.0")){return}if(!e){e=i.C("div");e.style.position="absolute";e.style.zIndex=_zIndex;document.body.appendChild(e)}e.innerHTML='<div id="'+o+'"></div>';var d=function(){var t="fixed",s=(i.winSize().height-n)/2,o=(i.winSize().width-r)/2;if(i.core.util.browser.IE6){s+=i.scrollPos(document).top;o+=i.scrollPos(document).left;t="absolute"}s=s>0?s:0;o=o>0?o:0;e.style.position=t;e.style.top=s+"px";e.style.left=o+"px"};a.show();d();var v={id:"view_ani",quality:"high",allowScriptAccess:"never",wmode:"transparent",allowFullscreen:true,allownetworking:"internal"};var m={playMovie:"true"};var g=function(e){if(e&&e.keyCode!==27&&(e.type!=="mouseup"||u&&u==e.target)){return}clearInterval(t);f.removeSWF(o);a.hide();i.removeEvent(document.body,"mouseup",g);i.removeEvent(document.body,"keyup",g);if(!e){return}i.preventDefault(e)};f.embedSWF(s,o,r,n,"10.0.0",null,m,v);a.show();l.clearInterval(t);i.addEvent(document.body,"mouseup",g);i.addEvent(document.body,"keyup",g);t=setInterval(function(){var e=0;u=f.getObjectById(o);if(u&&u.PercentLoaded()==100){l.clearInterval(t);t=setInterval(function(){var t=u.CurrentFrame(),n;try{n=u.TotalFrames()}catch(r){n=u.TotalFrames}if(t<0){return}if(t<n&&e<=t){e=t}else{g()}},80)}},100)}}();e.exports=c},n:function(e,t,n,r){var i=function(){function k(){if(w){return}try{var e=f.getElementsByTagName("body")[0].appendChild(z("span"));e.parentNode.removeChild(e)}catch(t){return}w=true;var n=h.length;for(var r=0;r<n;r++){h[r]()}}function L(e){if(w){e()}else{h[h.length]=e}}function A(t){if(typeof a.addEventListener!=e){a.addEventListener("load",t,false)}else if(typeof f.addEventListener!=e){f.addEventListener("load",t,false)}else if(typeof a.attachEvent!=e){W(a,"onload",t)}else if(typeof a.onload=="function"){var n=a.onload;a.onload=function(){n();t()}}else{a.onload=t}}function O(){if(c){M()}else{_()}}function M(){var n=f.getElementsByTagName("body")[0];var r=z(t);r.setAttribute("type",s);var i=n.appendChild(r);if(i){var o=0;(function(){if(typeof i.GetVariable!=e){var t=i.GetVariable("$version");if(t){t=t.split(" ")[1].split(",");N.pv=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)]}}else if(o<10){o++;setTimeout(arguments.callee,10);return}n.removeChild(r);i=null;_()})()}else{_()}}function _(){var t=p.length;if(t>0){for(var n=0;n<t;n++){var r=p[n].id;var i=p[n].callbackFn;var s={success:false,id:r};if(N.pv[0]>0){var o=U(r);if(o){if(X(p[n].swfVersion)&&!(N.wk&&N.wk<312)){$(r,true);if(i){s.success=true;s.ref=D(r);i(s)}}else if(p[n].expressInstall&&P()){var u={};u.data=p[n].expressInstall;u.width=o.getAttribute("width")||"0";u.height=o.getAttribute("height")||"0";if(o.getAttribute("class")){u.styleclass=o.getAttribute("class")}if(o.getAttribute("align")){u.align=o.getAttribute("align")}var a={};var f=o.getElementsByTagName("param");var l=f.length;for(var c=0;c<l;c++){if(f[c].getAttribute("name").toLowerCase()!="movie"){a[f[c].getAttribute("name")]=f[c].getAttribute("value")}}H(u,a,r,i)}else{B(o);if(i){i(s)}}}}else{$(r,true);if(i){var h=D(r);if(h&&typeof h.SetVariable!=e){s.success=true;s.ref=h}i(s)}}}}}function D(n){var r=null;var i=U(n);if(i&&i.nodeName=="OBJECT"){if(typeof i.SetVariable!=e){r=i}else{var s=i.getElementsByTagName(t)[0];if(s){r=s}}}return r}function P(){return!E&&X("6.0.65")&&(N.win||N.mac)&&!(N.wk&&N.wk<312)}function H(t,n,r,i){E=true;y=i||null;b={success:false,id:r};var s=U(r);if(s){if(s.nodeName=="OBJECT"){m=j(s);g=null}else{m=s;g=r}t.id=o;if(typeof t.width==e||!/%$/.test(t.width)&&parseInt(t.width,10)<310){t.width="310"}if(typeof t.height==e||!/%$/.test(t.height)&&parseInt(t.height,10)<137){t.height="137"}f.title=f.title.slice(0,47)+" - Flash Player Installation";var u=N.ie&&N.win?"ActiveX":"PlugIn",l="MMredirectURL="+encodeURI(a.location).toString().replace(/&/g,"%26")+"&MMplayerType="+u+"&MMdoctitle="+f.title;if(typeof n.flashvars!=e){n.flashvars+="&"+l}else{n.flashvars=l}if(N.ie&&N.win&&s.readyState!=4){var c=z("div");r+="SWFObjectNew";c.setAttribute("id",r);s.parentNode.insertBefore(c,s);s.style.display="none";(function(){if(s.readyState==4){s.parentNode.removeChild(s)}else{setTimeout(arguments.callee,10)}})()}F(t,n,r)}}function B(e){if(N.ie&&N.win&&e.readyState!=4){var t=z("div");e.parentNode.insertBefore(t,e);t.parentNode.replaceChild(j(e),t);e.style.display="none";(function(){if(e.readyState==4){e.parentNode.removeChild(e)}else{setTimeout(arguments.callee,10)}})()}else{e.parentNode.replaceChild(j(e),e)}}function j(e){var n=z("div");if(N.win&&N.ie){n.innerHTML=e.innerHTML}else{var r=e.getElementsByTagName(t)[0];if(r){var i=r.childNodes;if(i){var s=i.length;for(var o=0;o<s;o++){if(!(i[o].nodeType==1&&i[o].nodeName=="PARAM")&&!(i[o].nodeType==8)){n.appendChild(i[o].cloneNode(true))}}}}}return n}function F(n,r,i){var o,u=U(i);if(N.wk&&N.wk<312){return o}if(u){if(typeof n.id==e){n.id=i}if(N.ie&&N.win){var a="";for(var f in n){if(n[f]!=Object.prototype[f]){if(f.toLowerCase()=="data"){r.movie=n[f]}else if(f.toLowerCase()=="styleclass"){a+=' class="'+n[f]+'"'}else if(f.toLowerCase()!="classid"){a+=" "+f+'="'+n[f]+'"'}}}var l="";for(var c in r){if(r[c]!=Object.prototype[c]){l+='<param name="'+c+'" value="'+r[c]+'" />'}}u.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+l+"</object>";d[d.length]=n.id;o=U(n.id)}else{var h=z(t);h.setAttribute("type",s);for(var p in n){if(n[p]!=Object.prototype[p]){if(p.toLowerCase()=="styleclass"){h.setAttribute("class",n[p])}else if(p.toLowerCase()!="classid"){h.setAttribute(p,n[p])}}}for(var v in r){if(r[v]!=Object.prototype[v]&&v.toLowerCase()!="movie"){I(h,v,r[v])}}u.parentNode.replaceChild(h,u);o=h}}return o}function I(e,t,n){var r=z("param");r.setAttribute("name",t);r.setAttribute("value",n);e.appendChild(r)}function q(e){var t=U(e);if(t&&t.nodeName=="OBJECT"){if(N.ie&&N.win){t.style.display="none";(function(){if(t.readyState==4){R(e)}else{setTimeout(arguments.callee,10)}})()}else{t.parentNode.removeChild(t)}}}function R(e){var t=U(e);if(t){for(var n in t){if(typeof t[n]=="function"){t[n]=null}}t.parentNode.removeChild(t)}}function U(e){if(typeof e==="string"){return f.getElementById(e)}return e}function z(e){return f.createElement(e)}function W(e,t,n){e.attachEvent(t,n);v[v.length]=[e,t,n]}function X(e){var t=N.pv,n=e.split(".");n[0]=parseInt(n[0],10);n[1]=parseInt(n[1],10)||0;n[2]=parseInt(n[2],10)||0;return t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?true:false}function V(n,r,i,s){if(N.ie&&N.mac){return}var o=f.getElementsByTagName("head")[0];if(!o){return}var u=i&&typeof i=="string"?i:"screen";if(s){S=null;x=null}if(!S||x!=u){var a=z("style");a.setAttribute("type","text/css");a.setAttribute("media",u);S=o.appendChild(a);if(N.ie&&N.win&&typeof f.styleSheets!=e&&f.styleSheets.length>0){S=f.styleSheets[f.styleSheets.length-1]}x=u}if(N.ie&&N.win){if(S&&typeof S.addRule==t){S.addRule(n,r)}}else{if(S&&typeof f.createTextNode!=e){S.appendChild(f.createTextNode(n+" {"+r+"}"))}}}function $(e,t){if(!T){return}var n=t?"visible":"hidden";if(w&&U(e)){U(e).style.visibility=n}else{V("#"+e,"visibility:"+n)}}function J(t){var n=/[\\\"<>\.;]/;var r=n.exec(t)!=null;return r&&typeof encodeURIComponent!=e?encodeURIComponent(t):t}var e="undefined",t="object",n="Shockwave Flash",r="ShockwaveFlash.ShockwaveFlash",s="application/x-shockwave-flash",o="SWFObjectExprInst",u="onreadystatechange",a=window,f=document,l=navigator,c=false,h=[O],p=[],d=[],v=[],m,g,y,b,w=false,E=false,S,x,T=true,N=function(){var i=typeof f.getElementById!=e&&typeof f.getElementsByTagName!=e&&typeof f.createElement!=e,o=l.userAgent.toLowerCase(),u=l.platform.toLowerCase(),h=u?/win/.test(u):/win/.test(o),p=u?/mac/.test(u):/mac/.test(o),d=/webkit/.test(o)?parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,v=!+"1",m=[0,0,0],g=null;if(typeof l.plugins!=e&&typeof l.plugins[n]==t){g=l.plugins[n].description;if(g&&!(typeof l.mimeTypes!=e&&l.mimeTypes[s]&&!l.mimeTypes[s].enabledPlugin)){c=true;v=false;g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1");m[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10);m[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10);m[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof a.ActiveXObject!=e){try{var y=new ActiveXObject(r);if(y){g=y.GetVariable("$version");if(g){v=true;g=g.split(" ")[1].split(",");m=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}}}catch(b){}}return{w3:i,pv:m,wk:d,ie:v,win:h,mac:p}}(),C=function(){if(!N.w3){return}if(typeof f.readyState!=e&&f.readyState=="complete"||typeof f.readyState==e&&(f.getElementsByTagName("body")[0]||f.body)){k()}if(!w){if(typeof f.addEventListener!=e){f.addEventListener("DOMContentLoaded",k,false)}if(N.ie&&N.win){f.attachEvent(u,function(){if(f.readyState=="complete"){f.detachEvent(u,arguments.callee);k()}});if(a==top){(function(){if(w){return}try{f.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}k()})()}}if(N.wk){(function(){if(w){return}if(!/loaded|complete/.test(f.readyState)){setTimeout(arguments.callee,0);return}k()})()}A(k)}}();var K=function(){if(N.ie&&N.win){window.attachEvent("onunload",function(){var e=v.length;for(var t=0;t<e;t++){v[t][0].detachEvent(v[t][1],v[t][2])}var n=d.length;for(var r=0;r<n;r++){q(d[r])}for(var s in N){N[s]=null}N=null;for(var o in i){i[o]=null}i=null})}}();return{registerObject:function(e,t,n,r){if(N.w3&&e&&t){var i={};i.id=e;i.swfVersion=t;i.expressInstall=n;i.callbackFn=r;p[p.length]=i;$(e,false)}else if(r){r({success:false,id:e})}},getObjectById:function(e){if(N.w3){return D(e)}},embedSWF:function(n,r,i,s,o,u,a,f,l,c){var h={success:false,id:r};if(N.w3&&!(N.wk&&N.wk<312)&&n&&r&&i&&s&&o){$(r,false);L(function(){i+="";s+="";var p={};if(l&&typeof l===t){for(var d in l){p[d]=l[d]}}p.data=n;p.width=i;p.height=s;var v={};if(f&&typeof f===t){for(var m in f){v[m]=f[m]}}if(a&&typeof a===t){for(var g in a){if(typeof v.flashvars!=e){v.flashvars+="&"+g+"="+a[g]}else{v.flashvars=g+"="+a[g]}}}if(X(o)){var y=F(p,v,r);if(p.id==r){$(r,true)}h.success=true;h.ref=y}else if(u&&P()){p.data=u;H(p,v,r,c);return}else{$(r,true)}if(c){c(h)}})}else if(c){c(h)}},switchOffAutoHideShow:function(){T=false},ua:N,getFlashPlayerVersion:function(){return{major:N.pv[0],minor:N.pv[1],release:N.pv[2]}},hasFlashPlayerVersion:X,createSWF:function(e,t,n){if(N.w3){return F(e,t,n)}else{return undefined}},showExpressInstall:function(e,t,n,r){if(N.w3&&P()){H(e,t,n,r)}},removeSWF:function(e){if(N.w3){q(e)}},createCSS:function(e,t,n,r){if(N.w3){V(e,t,n,r)}},addDomLoadEvent:L,addLoadEvent:A,getQueryParamValue:function(e){var t=f.location.search||f.location.hash;if(t){if(/\?/.test(t)){t=t.split("?")[1]}if(e==null){return J(t)}var n=t.split("&");for(var r=0;r<n.length;r++){if(n[r].substring(0,n[r].indexOf("="))==e){return J(n[r].substring(n[r].indexOf("=")+1))}}}return""},expressInstallCallback:function(){if(E){var e=U(o);if(e&&m){e.parentNode.replaceChild(m,e);if(g){$(g,true);if(N.ie&&N.win){m.style.display="block"}}if(y){y(b)}}E=false}}}}();e.exports=i},N:function(e,t,n,r){var i=n("A");e.exports=function(e,t){var n,r;n={};r=i.parseParam({},t);var s=function(t){return i.core.dom.selectText(e,t)};var o=function(){e["__areaQuery"]=i.jsonToQuery(i.core.dom.textSelectArea(e))};var u=function(){e["__areaQuery"]=false};i.addEvent(e,"beforedeactivate",o);i.addEvent(e,"active",u);var a=function(){var t=null;try{t=i.core.dom.textSelectArea(e)}catch(n){t=i.queryToJson(e["__areaQuery"])}if(t.start===0&&t.len===0&&e["__areaQuery"]){t=i.queryToJson(e["__areaQuery"])}t.start=parseInt(t.start,10);t.len=parseInt(t.len,10);return t};var f=function(t,n){var r=e.value;var i=n.start;var s=n.len||0;var o=r.slice(0,i);var u=r.slice(i+s,r.length);e.value=o+t+u;r=null;o=null;u=null;i=null;s=null};n.setCursor=function(e){s(e)};n.getCursor=function(){return a()};n.insertCursor=function(e){var t=a();f(e,t);t.len=e.length;s(t)};n.TempletCursor=function(t){var n,r,o;n=a();if(n.len>0){r=e.value.substr(n.start,n.len)}else{r=""}o=i.templet(t,{origin:r});f(o,n);n.start=n.start+t.indexOf("#{origin");n.len=o.length-t.replace(/#\{[origin].+?\}/,"").length;s(n)};n.insertText=f;n.destroy=function(){i.removeEvent(e,"beforedeactivate",o);i.removeEvent(e,"active",u);e=null};return n}},o:function(e,t,n,r){String.prototype.trim=function(){var e=this.replace(/(^\s*)|(\s*$)/g,"");return e.replace(/(^　*)|(　*$)/g,"")};String.prototype.encodeHTML=function(){var e=document.createElement("div");e.appendChild(document.createTextNode(this));return e.innerHTML.replace(/\s/g,"&nbsp;").replace(/"/g,"&quot;")};String.prototype.getByteLength=function(){return this.replace(/[^\x00-\xff]/g,"rr").length};String.prototype.decodeHTML=function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&")};String.prototype.cutString=function(e,t,n){var r=this,t=t||"";if(!!n===false){r=this.decodeHTML();if(r.getByteLength()<=e)return r.encodeHTML();var i=Math.floor(e/2);for(var s=i,o=r.getByteLength();s<=o;s++){if(r.substr(0,s).getByteLength()>e){return(r.substr(0,s-1)+t).encodeHTML()}}return(r+t).encodeHTML()}else{if(r.getByteLength()<=e)return r;var i=Math.floor(e/2);for(var s=i,o=r.getByteLength();s<=o;s++){if(r.substr(0,s).getByteLength()>e){return r.substr(0,s-1)+t}}return r+t}};Object.keys||(Object.keys=function(e){var t=[];for(var n in e){t.push(n)}return t});String.prototype.hasDoubleByte=function(e){return e?/^[^\x00-\xff]+$/.test(this):/[^\x00-\xff]/.test(this)};String.prototype.getByteLength=function(){return this.hasDoubleByte()?this.replace(/[^\x00-\xff]/g,"**").length:this.length};String.prototype.sliceByte=function(e,t){var n=this.slice(0,e);if(n.hasDoubleByte()){var r=n.getByteLength();while(r>e){r-=n.charAt(n.length-1).getByteLength();n=n.slice(0,-1)}if(r<e&&t)n+=this.charAt(n.length)}return n};String.prototype.cutHtml=function(e,t,n){var r=arguments.length,i="",s=0,o=[],u=0;var a=/([\s\S]*?)(<\/?([a-zA-Z0-9]+)[^>]*>|$)/gi;var f=100,l=0,c=false;while(s<e&&a.exec(this)){l++;if(l>=f)break;var h=RegExp.$1,p=RegExp.$2,d=RegExp.$3,v=r>2?h.getByteLength():h.length;s+=v;if(p){if(p.indexOf("</")!==0){if(s>=e)p="</"+o.splice(o.length-1,1)+">";else o.push(d)}else if((u=o.lastIndexOf(d))>-1){o.splice(u,1)}}if(s>e){var m=r>2?h.sliceByte(e-s+v,n):h.slice(0,e-s+v);i+=m+t+p}else if(s==e)i+=h+t+p;else i+=h+p}var g=o.length;if(g){if($.msie&&/^(p|li|dt|dd|tr|th|td)$/i.test(o[g-1])&&!RegExp("</"+RegExp.$1+">$","i").test(i))i+="</"+o.splice(g-1,1)+">";o=o.filter(function(e){return!this.test(e)},$.msie?/^(abbr|br|col|img|input|link|meta|param|hr|area|embed|p|li|dt|dd|tr|th|td)$/i:/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i);if(o.length)i+="</"+o.reverse().join("></")+">"}return i}},O:function(e,t,n,r){var i=n("A");window.$LANG||(window.$LANG={});e.exports=function(e){var t=[].splice.call(arguments,1,arguments.length);var n=[e,$LANG].concat(t);var r=i.core.util.language.apply(this,n);return r}},p:function(e,t,n,r){function u(e,t){var n=s(e);var r={overflow:false,sum:n,overnum:Math.abs(t-n)};if(n>t){r.overflow=true}return r}var i=n("A");var s=n("P");var o=n("O");e.exports=function(e){function v(e){var t=e.textEl;if(!t){throw"[editor plugin count]: plz check nodeList"}i.removeEvent(t,"focus",m);i.removeEvent(t,"blur",g)}function m(){if(p){return}p=true;d=false;l=setInterval(function(){b()},100)}function g(e){if(d){return}d=true;p=false;if(l){clearInterval(l)}}var t=e.nodeList;var n=e.opts;var r=e.fn||false;var s=e.before_cut||i.funcEmpty;var a=o;var f=n.limitNum;var l;v(t);var c=t.textEl;var h=t.wordNum;var p=false;var d=false;i.addEvent(c,"focus",m);i.addEvent(c,"blur",g);var y=i.trim;var b=function(){var e=c.value;var t=y(e);var n;t=t.replace(/\r\n/g,"\n");var o=u(t,f);if(o.overflow){if(s(o,t)!==false){c.value=i.leftB(t,f*2)}n=0}else{n=o.overnum}if(h&&1===h.nodeType){var a="";if(r&&"function"===i.getType(r)){a=r(n)}else{a="还可以输入<span>"+n+"</span>个字"}h.innerHTML=a}};return{destroy:function(){i.removeEvent(c,"focus",m);i.removeEvent(c,"blur",g);c=null}}}},P:function(e,t,n,r){var i=n("A");e.exports=function(e){return Math.ceil(i.bLength(e)/2)}},q:function(e,t,n,r){var i=n("A");var s=n("K");var o=n("Q");var u=n("O");var a=n("r");var f=n("S");var l=n("B");var c=u;var h=""+'<div class="L_menu_list">'+'<span class="title">想用@提到谁？</span>'+'<ul class="atList" node-type="suggestWrap">'+"</ul>"+"</div>";var p={"@":{normalTitle:c("#L{选择昵称或轻敲空格完成输入}"),moreTitle:c("#L{选择最近@的人或直接输入}"),noTilte:c("#L{轻敲空格完成输入}")},"#":{normalTitle:c("#L{想用什么话题？}")}};var d={"@":"<#et temp data>"+"<#list data.data as list>"+'<li action-type="item" '+"<#if (list_index == 0)>"+'class="cur" '+"</#if>"+'action-data="value=${list.nickname}" value="${list.nickname}"><a href="#">${list.nickname}<#if (list.remark)>(${list.remark})</#if></a></li>'+"<#if (list.count)>"+"<span>${list.count}</span>"+"</#if>"+"</#list>"+"</#et>"};var v,m,g,y,b,w=false,E;var S;var x={"@":"followList","#":"topicList"};var T=0;var N=function(){setTimeout(function(){i.custEvent.fire(v,"close")},200)};var C=function(){b.style.display="none"};var k=function(){i.custEvent.add(v,"onIndexChange",function(e,t){_(t)});i.custEvent.add(v,"onSelect",function(e,t,n,r){T=0;i.core.evt.stopEvent();var s=S[t].getAttribute("value")+"";s=s.replace(/\(.*\)/,"");try{n.focus()}catch(u){}var a=o.selectionStart(n)*1;var f=new RegExp(r+"([a-zA-Z0-9一-龥_-]{0,20})$");var l=n.value.replace(/\r+/g,"").slice(0,a).match(f);var c=n.value.slice(a,a+1);l=l&&l[1]?l[1].length:0;var h=o;if(r=="#"){if(typeof c!="undefined"&&c!=r){s=s+r+" "}}else{s=s+" "}h.insertText(n,s,a,l);var p=h.getCursorPos(n);if(r=="#"&&c==r){h.setCursor(n,p+1);h.insertText(n," ",p+1,0)}p=h.getCursorPos(n);var d=h.getSelectedText(n);var m=d===""||d===null?0:d.length;n.setAttribute("range",p+"&"+m);i.custEvent.fire(v,"close")});i.addEvent(g.textEl,"blur",N);i.custEvent.add(v,"onClose",C);i.custEvent.add(v,"onOpen",function(e,t){y.style.display="";b.style.display="";w=true;setTimeout(function(){i.custEvent.fire(v,"indexChange",0)},100)})};var L=function(e,t,n){var r="";if(t.result){r=i.core.util.easyTemplate(d[e],t.data)}return r};var A=function(){i.custEvent.add(m,"hidden",function(e,t){i.custEvent.fire(v,"close")});var e="";i.custEvent.add(m,"at",function(t,n){var r=e=n.key;var s=n.flag;if(r.length===0&&s!=="@"){i.custEvent.fire(v,"close");return}l({url:$CONFIG.base_url+"sina/aj_searchat",args:{key:r,count:20},onComplete:function(t){var o=L(s,t,r);if(!o){i.custEvent.fire(v,"close");return}if(e===r){var u=n.textarea;i.custEvent.fire(v,"openSetFlag",s);i.custEvent.fire(v,"open",u);var a=i.core.dom.builder(o);var f=a.box;y.innerHTML=f;b.style.cssText=["width:180px;z-index:11001;background-color:#ffffff;position:absolute;"].join("");var l=n.l;if(document.body.clientWidth<n.fl+i.core.dom.getSize(b).width&&n.fl>i.core.dom.getSize(b).width){l=n.l-i.core.dom.getSize(b).width}var c=i.position(u);b.style.top=c.t+n.t+"px";b.style.left=c.l+n.l+"px"}},onFail:function(){i.custEvent.fire(v,"close")}})})};var O=function(){E=g.textEl;m=a({textEl:E,flag:"@|#"})};var M=function(e){T=0;b&&(b.style.display="none");b&&(b.innerHTML="");b=STK.C("div");document.body.appendChild(b);if(b.innerHTML.length===0){b.innerHTML=h;y=i.sizzle('[node-type="suggestWrap"]',b)[0];b.style.display="none"}v&&i.custEvent.fire(v,"close");v&&i.custEvent.remove(v);v=f({textNode:e,uiNode:y,actionType:"item",actionData:"value",flag:"@"});k()};var _=function(e){S=i.sizzle("li[class!=suggest_title]",y);S&&S[0]&&i.core.dom.removeClassName(S[T],"cur");i.core.dom.addClassName(S[e],"cur");T=e};e.exports=function(e,t){g=e.nodeList;var n={};n.init=function(){O();M(g.textEl);A()};return n}},Q:function(e,t,n,r){var i={},s=document.selection;i.selectionStart=function(e){if(!s){try{return e.selectionStart}catch(t){return 0}}var n=s.createRange(),r,i,o=0;var u=document.body.createTextRange();try{u.moveToElementText(e)}catch(t){}for(o;u.compareEndPoints("StartToStart",n)<0;o++){u.moveStart("character",1)}return o};i.selectionBefore=function(e){return e.value.slice(0,i.selectionStart(e))};i.selectText=function(e,t,n){e.focus();if(!s){e.setSelectionRange(t,n);return}var r=e.createTextRange();r.collapse(1);r.moveStart("character",t);r.moveEnd("character",n-t);r.select()};i.insertText=function(e,t,n,r){e.focus();r=r||0;if(!s){var o=e.value,u=n-r,a=u+t.length;e.value=o.slice(0,u)+t+o.slice(n,o.length);i.selectText(e,a,a);return}var f=s.createRange();f.moveStart("character",-r);f.text=t};i.replaceText=function(e,t){e.focus();var n=e.value;var r=i.getSelectedText(e);var o=r.length;if(r.length==0){i.insertText(e,t,i.getCursorPos(e))}else{var u=i.getCursorPos(e);if(s){var a=s.createRange();a.text=t;i.setCursor(e,u+t.length)}else{var f=u+r.length;e.value=n.slice(0,u)+t+n.slice(u+o,n.length);i.setCursor(e,u+t.length);return}}};i.getCursorPos=function(e){var t=0;if(STK.core.util.browser.IE){e.focus();var n=null;n=s.createRange();var r=n.duplicate();r.moveToElementText(e);r.setEndPoint("EndToEnd",n);e.selectionStartIE=r.text.length-n.text.length;e.selectionEndIE=e.selectionStartIE+n.text.length;t=e.selectionStartIE}else if(e.selectionStart||e.selectionStart=="0"){t=e.selectionStart}return t};i.getSelectedText=function(e){var t="";var n=function(e){if(e.selectionStart!=undefined&&e.selectionEnd!=undefined)return e.value.substring(e.selectionStart,e.selectionEnd);else return""};if(window.getSelection){t=n(e)}else{t=s.createRange().text}return t};i.setCursor=function(e,t,n){t=t==null?e.value.length:t;n=n==null?0:n;e.focus();if(e.createTextRange){var r=e.createTextRange();r.move("character",t);r.moveEnd("character",n);r.select()}else if(e.setSelectionRange){e.setSelectionRange(t,t+n)}};i.unCoverInsertText=function(e,t,n){n=n==null?{}:n;n.rcs=n.rcs==null?e.value.length:n.rcs*1;n.rccl=n.rccl==null?0:n.rccl*1;var r=e.value,i=r.slice(0,n.rcs),s=r.slice(n.rcs+n.rccl,r==""?0:r.length);e.value=i+t+s;this.setCursor(e,n.rcs+(t==null?0:t.length))};e.exports=i},r:function(e,t,n,r){var i=n("A");var s=n("R");var o=n("Q");var u=n("s");var a=window,f=document,l=i.core.util.browser,c="font-family:Tahoma,宋体;",h=o.selectionStart;var p;var d,v,m,g;var y=function(){var e={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',c,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',c,'"> </span>'].join("")};return function(t){var n=t.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(t){return e[t]});return n}}();var b=function(){var e=[],t=p.textEl.style.cssText,n;i.foreach(["margin","padding","border"],function(t){i.foreach(["Top","Left","Bottom","Right"],function(n){var r;if(t!="border"){r=e.push(t,"-",n.toLowerCase(),":",i.getStyle(p.textEl,t+n),";");return}i.foreach(["Style","Width"],function(r){e.push(t,"-",n.toLowerCase(),"-",r.toLowerCase(),":",i.getStyle(p.textEl,[t,n,r].join("")),";")})})});e.push("font-size:"+i.getStyle(p.textEl,""+"fontSize")+";");return s([t,e.join(""),c,"        word-wrap: break-word;        line-height: 18px;        overflow-y:auto;        overflow-x:hidden;        outline:none;    "].join("")).getCss()};var w=function(){var e=i.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list;var t=e["wrap"][0],n=e["flag"][0],r=e["after"][0],s=e["before"][0],o=0,u,a,c;var h=function(e){if(l.MOZ){return-2}if(l.MOBILE&&l.SAFARI&&(l.IPAD||l.ITOUCH||l.IPHONE)){return-2}return 0};return{bind:function(){if(a===p.textEl){return}g=i.position(p.textEl);var e=["left:",g.l,"px;top:",g.t+20,"px;"].join("");a=p.textEl;var n=b();a.style.cssText=n;c=[e,n,"                position:absolute;                filter:alpha(opacity=0);                opacity:0;                z-index:-1000;            "].join("");t.style.cssText=c;if(!o){o=1;f.body.appendChild(t)}},content:function(e,o,f,l){t.style.cssText=[c,"                width:",(parseInt(i.getStyle(a,"width"))||a.offsetWidth)+h(),"px;                height:",parseInt(i.getStyle(a,"height"))||a.offsetHeight,"px;                overflow-x:hidden;                overflow-y:",/webkit/i.test(navigator.userAgent)?"hidden":i.getStyle(a,"overflowY"),";            "].join("");s.innerHTML=y(e);n.innerHTML=y(o)||"&thinsp;";r.innerHTML=y([f,l].join(""));clearTimeout(u);u=setTimeout(function(){var e=i.position(n);i.custEvent.fire(p.eId,"at",{t:e.t-a.scrollTop-g.t,l:e.l-g.l,fl:e.l,key:f,flag:o,textarea:p.textEl})},200)},hide:function(){t.style.display="none"},show:function(){t.style.display=""}}}();var E=function(){if(u(p.textEl)){clearInterval(d);return}var e=p.textEl.value.replace(/\r/g,"");var t=h(p.textEl);if(t<0||t==m){return}m=t;var n=e.slice(0,t);var r=n.match(new RegExp(["(",p["flag"],")([a-zA-Z0-9一-龥_-]{0,20})$"].join("")));if(!r){i.custEvent.fire(p.eId,"hidden");return}var s=e.slice(t);n=n.slice(0,-r[0].length);w.content(n,r[1],r[2],s)};e.exports=function(e){if(!e||!e["textEl"]){return}e=i.parseParam({textEl:null,flag:"@",eId:i.custEvent.define({},["at","hidden"])},e);var t=function(){if(!p){return}clearInterval(d);i.removeEvent(p.textEl,"blur",t);w.hide()};var n=function(){t();p=e;m=null;w.bind();w.show();d=setInterval(E,200);i.addEvent(e.textEl,"blur",t)};i.addEvent(e.textEl,"focus",n);return e["eId"]}},R:function(e,t,n,r){var i=function(e,t){var n=(e+";"+t).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),r;while(n&&(r=n.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i))){n=n.replace(r[1]+r[2]+r[3],"")}return n};e.exports=function(e){e=e||"";var t=[],n={push:function(e,r){t.push(e+":"+r);return n},remove:function(e){for(var r=0;r<t.length;r++){if(t[r].indexOf(e+":")==0){t.splice(r,1)}}return n},getStyleList:function(){return t.slice()},getCss:function(){return i(e,t.join(";"))}};return n}},s:function(e,t,n,r){e.exports=function(e){return!(e.parentNode&&e.parentNode.nodeType!=11&&!e.disabled)}},S:function(e,t,n,r){var i=n("A");var s=null,o=i.custEvent,u=o.define,a=o.fire,f=o.add,l=i.addEvent,c=i.removeEvent,h=i.stopEvent;var p=[],d={};var v={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9};var m=function(e){var t=-1,n=[],r=e["textNode"],s=e["uiNode"];var o=i.core.evt.delegatedEvent(s);var p=u(r,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen","openSetFlag"]);p.setFlag=d;var d=function(t){e.flag=t};var m=function(){return i.sizzle(["[action-type=",e["actionType"],"]"].join(""),s)};var g=function(){t=-1;c(r,"keydown",y);o.destroy()};var y=function(n){var s,o;if(!(s=n)||!(o=s.keyCode)){return}if(o==v["ENTER"]){a(p,"onSelect",[t,r,e.flag]);i.preventDefault()}if(o==v["UP"]){h();var u=m().length;t=t<1?u-1:t-1;a(p,"onIndexChange",[t]);return false}if(o==v["DOWN"]){h();var u=m().length;t=t==u-1?0:t+1;a(p,"onIndexChange",[t]);return false}if(o==v["ESC"]){h();g();a(p,"onClose");return false}if(o==v["TAB"]){g();a(p,"onClose");return false}};var b=function(t){a(p,"onSelect",[i.core.arr.indexOf(t.el,m()),r,e["flag"]])};var w=function(e){t=i.core.arr.indexOf(e.el,m());a(p,"onIndexChange",[i.core.arr.indexOf(e.el,m())])};f(p,"open",function(t,n){r=n;g();l(n,"keydown",y);o.add(e["actionType"],"mouseover",w);o.add(e["actionType"],"click",b);a(p,"onOpen",[e.flag])});f(p,"openSetFlag",function(e,t){d(t)});f(p,"close",function(){g();a(p,"onClose",[e.flag])});f(p,"indexChange",function(n,r){t=r;a(p,"onIndexChange",[t,e.flag])});return p};var g=function(e){var t=e["textNode"];var n=i.core.arr.indexOf(t,p);if(!d[n]){p[n=p.length]=t;d[n]=m(e)}return d[n]};e.exports=function(e){if(!e["textNode"]||!e["uiNode"]){return}e=i.parseParam({textNode:s,uiNode:s,actionType:"item",actionData:"index",flag:""},e);return g(e)}},t:function(e,t,n,r){var i=n("A");var s=n("m");var o='<#et temp data><div class="title" node-type="title">${data.title}</div>'+'<a href="#" class="close" action-type="cancel"></a>'+'<div class="L_prompt">'+'<div class="prompt M_txtc">'+'<span class="mk_ico ${data.icon}"></span><span class="cont" node-type="text">${data.text}</span>'+"</div>"+'<div class="submit_centr">'+'<a href="javascript:void(0)" class="M_btn_e" node-type="ok" action-type="ok"><span>确定</span></a>'+"</div>"+"</div></#et>";var u={success:"mk_suced",error:"mk_fail",remind:"mk_remind"};e.exports=function(e){var t,n;var r={};var u=i.core.util.easyTemplate;var a={init:function(){a.pars();a.build();a.bind()},pars:function(){t=i.parseParam({title:"提示",text:"",icon:"remind",ok:i.funcEmpty},e)},build:function(){var e=u(o,{title:t.title,text:t.text,icon:t.icon}).toString();n=s(e,t);n.setMiddle().show();var r=n.getDomList(true);var i=r.ok;i.focus()},bind:function(){i.custEvent.add(n,"hide",function(){i.custEvent.remove(n,"hide",arguments.callee);t["ok"]()})}};a.init();r.layer=n;return r}},T:function(e,t,n,r){function c(e,t,n){function c(){nodes["prompt_icon"].className="mk_ico "+f["error"];nodes["prompt_msg"].innerHTML=r["error"]}function h(e){i.stopEvent(e.evt);nodes["checkcode"].src=l()}function p(e){i.stopEvent(e.evt);var r=nodes["paint"].value,s=i.trim(r).length;if(s<4||s>6){c()}else{u.hide();t["checkcode"]=r;n(t)}}var r={error:"你输入的验证码有误，请重新输入",info:"请输入验证码"};var o='<div class="L_prompt">'+'<div class="prompt M_txtc">'+'<span node-type="prompt_icon" class="mk_ico '+f[e]+'"></span>'+'<em class="cont" node-type="prompt_msg">'+r[e]+"</em>"+"</div>"+'<div class="verify">'+'<input class="M_inpt" type="text" maxlength="6" node-type="paint">'+'<span class="img">'+'<img src="'+l()+'" height="29" node-type="checkcode">'+"</span>"+'<a href="#" class="change" title="换一换" action-type="change_code">换一换</a>'+"</div>"+'<div class="submit_centr">'+'<a class="M_btn_e" href="#" action-type="submit"><span>确定</span></a>'+'<a class="M_btn_e" href="#" action-type="close"><span>取消</span></a>'+"</div>"+"</div>";u=s();u.setContent(o);u.setTitle("提示");nodes=u.getDomList(true);u.setMiddle();u.show();a=i.delegatedEvent(u.getBox());a.add("change_code","click",h);a.add("submit","click",p)}var i=n("A");var s=n("h");var o=$CONFIG.base_url;var u;var a;var f={error:"mk_fail",info:"mk_remind"};var l=function(){return o+"sina/paint?v="+(new Date).valueOf()};e.exports=c},u:function(e,t,n,r){var i=n("A");var s=n("h");var o=n("O");var u=n("l");var a;var f=i.getType;var l=$CONFIG.base_url;var c=""+'<div class="L_prompt">'+'<div class="prompt M_txtc">'+'<span class="mk_ico" node-type="icon"></span><span class="cont" node-type="msg"></span>'+"</div>"+'<div class="submit_centr"><a href="javascript:void(0)" class="M_btn_e" action-type="ok"><span>确定</span></a><a href="javascript:void(0)" class="M_btn_e" action-type="cancel"><span>取消</span></a></div>'+"</div>";var h={success:"mk_suced",error:"mk_fail",remind:"mk_remind"};e.exports=function(e,t,n){var r,l,p,d;var v,m;var g={};var y=o;var b={ok:function(e){if(f(t.ok)==="function"&&t.ok(e)===false){return}l.hide()},cancel:function(e){if(f(t.cancel)==="function"&&t.cancel(e)===false){return}l.hide()}};var w={init:function(){w.pars();w.build();w.bind()},pars:function(){t=u({title:"提示",okText:"确定",cancelText:"取消",ok:i.funcEmpty,cancel:i.funcEmpty},t);n=n?h[n]:h["remind"]},build:function(){l=s(null,t);l.setContent(t.temp||c);l.setTitle&&l.setTitle(t["title"]);r=l.getDomList(true);var o=r["icon"];o&&i.addClassName(o,n);r["msg"]&&(r["msg"].innerHTML=e);l.setMiddle().show()},bind:function(){a=i.delegatedEvent(l.getBox());a.add("ok","click",b.ok);a.add("cancel","click",b.cancel);i.custEvent.add(l,"hide",function(){a.destroy();i.custEvent.remove(l,"hide",arguments.callee);l.destroy()})}};w.init();g.dia=l;g.hide=l.hide;g.addEvent=function(e,t,n){a&&a.add(e,t,n)};return g}},U:function(e,t,n,r){e.exports={10001:"保存成功",10002:"分享成功",10003:"封面设置成功",10004:"头像设置成功",10005:"复制链接成功",10006:"关注成功",10007:"确定",10008:"取消",10009:"创建",10010:"操作失败，请重试",10011:"请选择一个你的好友",10012:"数据已经被删除或无权访问",10013:"复制连接地址成功",10014:"头像设置成功",10015:"头像设置失败",10016:"分享内容不能为空",10017:"操作成功",10018:"取消成功",11001:"创建成功",11002:"确定删除该专辑吗？",11003:"删除专辑成功",11004:"新建专辑",11005:"编辑专辑",11006:"删除专辑失败",11007:"该专辑已满",11008:"封面设置成功",11009:"封面设置失败",11010:"新建会员专辑",11011:"新建收费专辑",12001:"确定删除该照片吗？",12002:"删除照片成功",12003:"移动照片成功",12004:"排序已更改，是否保存？",12005:"删除照片失败",12006:"移动照片成功",12007:"移动照片失败",12008:"排序保存成功",12009:"排序保存失败",12010:"确定将照片移动到此专辑？",12011:"照片还未完全载入",12012:"高宽小于100px的图片不能进行圈人操作",12013:"此照片为私密微博图片",12014:"旋转保存失败",12015:"照片不存在或无权查看",12016:"请先关闭圈人再旋转照片",12017:"此操作将同时删除该条微博以及它包含的所有图片，确定删除？",12018:"此照片为密友可见图片",12019:"确定要移除该照片吗？",12020:"移除照片成功",12021:"移除照片失败",13001:"赞图成功",13002:"取消赞成功",13003:"确定取消赞吗？",13004:"取消赞失败",13005:"赞失败",13006:"获取喜欢列表失败",14001:"收藏成功",14002:"取消收藏成功",14003:"确定取消收藏吗？",14004:"取消收藏",14005:"收藏专辑",14006:"收藏照片",14007:"收藏失败",14008:"取消收藏失败",15001:"评论成功",15002:"删除评论成功",15003:"休息一下，相同内容的微博发一条就够啦",16001:"圈人成功",16002:"删除圈人成功",16003:"圈人失败",17001:"存在重复的标签",17002:"请输入标签",18001:"您选择的文件格式有错误",18002:"上传失败",18003:"请选择图片",18004:"未上传图片",18005:"上传照片不可大于20M"}},v:function(e,t,n,r){var i=n("A");var s=n("B");var o=n("m");var u=n("c");var a=n("L");var f=$CONFIG["base_url"]||u.baseURL;var l={set:function(e,t){s({url:f+"likes/like",method:"post",args:e,onComplete:function(e){if(e&&e.result){if(t&&typeof t==="function"){t.call(this,e)}}else{a(e.msg,{type:"error"})}}})},cancel:function(e,t){s({url:f+"likes/dislike",method:"post",args:e,onComplete:function(e){if(e&&e.result){if(t&&typeof t==="function"){t.call(this,e)}}else{a(e.msg,{type:"error"})}}})},setFeed:function(e,t){s({url:f+"likes/like_feed",method:"post",args:e,onComplete:function(e){if(e&&e.result){if(t&&typeof t==="function"){t.call(this,e)}}else{a(e.msg,{type:"error"})}}})},likeTip:function(e,t){if($CONFIG.account_settings.like_tip){this.syncWeiboPop(e,t)}else{if(e&&typeof e=="function"){e.call(this,{})}}},setLikeTip:function(e,t){s({url:f+"settings/set_like",method:"post",args:e,onComplete:function(e){if(e&&e.result){$CONFIG.account_settings.like_tip=!t}}})},syncWeiboPop:function(e,t){function u(t,r){var s=i.sizzle("input:checkbox",t.box)[0];n.setLikeTip({is_upload:r,like_tip:s.checked?0:1},s.checked);if(e&&typeof e=="function"){e.call(n,{is_sync:r})}}var n=this;var r='<div class="L_synchr_wb">                        <a class="close" action-type="cancel" href="#">×</a>                        <p class="prompt">是否将我赞过的同步到微博？</p>                        <div class="confirm">                            <a class="M_btn_e" action-type="ok" href="#"><span>是</span></a><a class="M_btn_e" action-type="cancel" href="#"><span>否</span></a>                        </div>                        <label class="rembr M_txta"><input action-type="remember_me" type="checkbox" class="M_checkbox">记住我的选择，不再提示</label>                        <p node-type="like-tip" style="display:none" class="M_txtb tips">您的选择可在相册“设置”中重置</p>                    </div>';var s={mask:false,okCallback:function(e){u(e,1)},cancelCallback:function(e){u(e,0)}};var a=o(r,s);a.setLayerXY(t);a.show();a.addEvent("remember_me","click",function(e){var t=e.el;var n=i.builder(e.box).list["like-tip"];window.setTimeout(function(){if(n&&n[0])n[0].style.display=t.checked?"block":"none"},10)})}};e.exports=l},V:function(e,t,n,r){function u(e){i.addClassName(o,"focus")}function a(e){i.removeClassName(o,"focus")}function f(e){var t=e;o=i.sizzle('[node-type="show_menu"]',t)[0];i.addEvent(o,"mouseover",u);i.addEvent(o,"mouseout",a);s.init(t);var n={};n.destroy=function(){};return n}var i=n("A");var s=n("w");var o;e.exports=f},w:function(e,t,n,r){var i=n("A");var s={inputEl:null,onsubmit:function(e){var t=i.trim(s.inputEl.value);if(t&&!i.hasClassName(s.inputEl,"M_txte"))location.href="/tags/search?tag="+encodeURIComponent(t);i.preventDefault(e)},onfocus:function(e){var t=e.target||e.srcElement;i.removeClassName(t,"M_txte");if(t.value==t.title)t.value=""},onblur:function(e){var t=e.target||e.srcElement;if(i.trim(t.value)===""){t.value=t.title;i.addClassName(t,"M_txte")}},init:function(e,t){var n=i.sizzle("form[name=searchForm]",e)[0];if(n){var r=this.inputEl=i.sizzle("input[node-type=search_input]",n)[0];var s=i.sizzle("a[node-type=search_btn]",n)[0];i.addEvent(r,"focus",this.onfocus);i.addEvent(r,"blur",this.onblur);i.addEvent(s,"click",this.onsubmit);n.onsubmit=this.onsubmit}}};e.exports=s},W:function(e,t,n,r){function u(e){s.add(e.data,function(t){var n=e.data["uid"];o.innerHTML='<a class="M_btn_d_done" href="javascript:void(0)">'+(t.isFollow==3?'<span class="M_ico M_icon32"></span>互相关注</a>':"已关注")+'<a href="#" action-type="doUnFollow" action-data="uid='+n+'">取消</a>'})}function a(e){var t=e.data["uid"];s.cancel(e.data,function(e){o.innerHTML='<a class="M_btn_d fllow" href="#" action-type="doFollow" action-data="uid='+t+'">加关注</a>'})}function f(e){if(!e)return;o=i.sizzle("span[node-type=follow_status]",e)[0];var t=i.delegatedEvent(e);t.add("doFollow","click",u);t.add("doUnFollow","click",a)}var i=n("A");var s=n("x");var o;e.exports=f},x:function(e,t,n,r){function a(){if(window.self!=window.top){window.top.location=window.self.location}return window.self==window.top}var i=n("B");var s=n("L");var o=n("c");var u=o.baseURL;var f={add:function(e,t,n){if(!n&&!a())return;i({url:u+"users/follow",args:e,method:"post",onComplete:function(e){if(e&&e.result){if(t&&typeof t==="function"){t.call(this,e.data)}}else{s(e.msg||"加关注失败")}},onFail:function(){s("操作失败")},onTimeout:function(){s("操作超时")}})},cancel:function(e,t,n){if(!n&&!a())return;i({url:u+"users/follow_destroy",args:e,method:"post",onComplete:function(e){if(e&&e.result){if(t&&typeof t==="function"){t.call(this,e.data)}else{s(e.msg||"取消关注失败")}}}})},failed:function(e){s(e)}};e.exports=f},X:function(e,t,n,r){function g(e,t){if(!u.isLogin()){location.reload();return}f({url:a+"photos/update",args:e,method:"post",onComplete:function(e){if(t&&i.getType(t)==="function"){t.call(this,e)}}})}var i=n("A");var s=n("h");var o=n("L");var u=n("D");var a=n("c").baseURL;var f=n("B");var l=n("y");var c=n("e");var h=n("p");var p=n("P");var d=n("Y");var v=n("U");var m=n("z");e.exports=function(e){var t,n,r,u=null,a=null,f=null,l=null;var c;var y,b;var w;var E={init:function(){E.pars();E.build();E.bind()},pars:function(){e=i.parseParam({title:"编辑照片",caption:"",tags:"",isCover:false,photoID:"",show_SetCover:false,afterEvent:i.funcEmpty},e||{});e.counter_caption=p(e.caption)},build:function(){n=s();n.setContent(m(e));n.setTitle(e.title);n.setMiddle().show();t=n.getBox();r=n.getDomList(true);u=r.caption;a=r.pid;f=r.single_tag_input;y=h({nodeList:{textEl:u,wordNum:r.caption_w},opts:{limitNum:140},fn:function(e){return e+"/140"}});var i=/(;|,|；|，|\s)$/;b=h({nodeList:{textEl:f},opts:{limitNum:10},before_cut:function(e,t){if(i.test(t)){return false}}});w=new d(t);w.createTag(e.tags,e.photoID,a)},bind:function(){var s=function(){i.preventDefault();var t=e.photoID;var s=f.value;if(s!==f.title){w.createTag(s,t,a)}f.value="";var l={photo_id:t,caption:i.trim(u.value),cover:e.show_SetCover?r.cbox_cover.checked:e.isCover,tags:a.value};g(l,function(t){n.hide();if(t&&t.result){var r=e.afterEvent;if(r&&i.getType(r)=="function"){r.call(this,t.data)}o(v[10001])}else{o(t.msg||v[10010],{type:"error"})}})};c=i.delegatedEvent(t);c.add("submit","click",s);var l=function(e){w.onBlur(e,true)};i.addEvent(f,"keyup",w.onKeyup);i.addEvent(f,"blur",l);i.addEvent(f,"focus",w.onFocus);var h=function(){f.focus()};var p=function(e){i.preventDefault();var t=e.el.title;w.createTag(t,e.photoID,a)};var d=function(e){w.removeTag(e.evt)};c.add("tag_box","click",h);c.add("remove_tag","click",d);c.add("single_add","click",p);i.custEvent.add(n,"hide",function(){i.custEvent.remove(n,"hide",arguments.callee);c.destroy();n.destroy();y.destroy();b.destroy()})}};E.init();l=n;return l}},y:function(e,t,n,r){e.exports=function(e){if(!e||e.nodeType!==1){throw"fn-->show need a element node as parameter"}e.style.display="block"}},Y:function(e,t,n,r){function c(e,t){var n=e;var r=n.split("&");var i={};for(var s=0;s<r.length;s++){var o=r[s].split("=");var u=o[0],a=o[1];i[u]=a;if(u==t){return i.s1}}return i}var i=n("A");var s=n("c");var o=n("e");var u=n("B");var a=n("C");n("o");var f=s.baseURL;var l=function(e,t,n,r,s){var l=this;var c=null;this.helper=null;this.editLayer=e;this.photoList=t||e;this.maxTags=n||10;this.maxByteLength=r||20;this.maxShowLength=s||13;this.getCommonTags=function(e,t){var n=this;if(this.commonTags){if(t&&typeof t=="function"){t.call(this,this.commonTags)}return}u({url:f+"tags/suggest_tags",args:{count:e},onComplete:function(e){if(e&&e.result){n.commonTags=e.data;if(t&&typeof t=="function"){t.call(n,n.commonTags)}}}})};this.createCommonTags=function(e,t){var n,r=[];for(var i=0,s=e.length;i<s;i++){n=e[i];r.push('<a title="'+n+'" href="#" action-type="'+(t?"batch_add":"single_add")+'">'+n+"</a>")}return r.join("")};this.onBatchInputKeyup=function(e){var t=this.value,n=this.name;if(/(;|,|；|，|\s+|　+)$/.test(t)){t=t.substring(0,t.length-1);l.addTagsAll(t,n);this.value=""}e.preventDefault()};this.addTagsAll=function(e,t,n){var r,s;var o=i.sizzle("input[type=hidden][name="+t+"]",l.editLayer)[0];l.createTag(e,t,o,true);if(!l.hiddenInputs)l.hiddenInputs=i.sizzle("input[type=hidden]",l.photoList);for(var u=0,a=l.hiddenInputs.length;u<a;u++){s=l.hiddenInputs[u];r=s.name;(function(t,n){window.setTimeout(function(){i.sizzle("input[type=text][name="+t+"]",l.editLayer)[0].value="";l.createTag(e,t,n,true)},1)})(r,s)}};this.onBatchInputFocus=function(e){var t=e.target||e.srcElement;t.value="";i.removeClassName(t,"M_txte")};this.onBatchInputBlur=function(e){var t=e.target||e.srcElement;value=t.value,name=t.name,$hiddenInput=i.sizzle("input[type=hidden][name="+name+"]",l.editLayer);if(i.trim(value)==""){if($hiddenInput.value==""){i.addClassName(t,"M_txte");t.value=t.title}else{t.value=""}return}l.addTagsAll(value,name);t.value=""};this.onKeyup=function(e){var t=e.target||e.srcElement;var n=t.value;var r=t.name;if(/(;|,|；|，|\s+|　+)$/.test(n)){n=n.substring(0,n.length-1);var s=i.sizzle("input[type=hidden][name="+r+"]",l.editLayer)[0];l.createTag(n,r,s,true);t.value="";t.focus()}i.preventDefault()};this.onFocus=function(e){var t=e.target||e.srcElement;t.value="";i.removeClassName(t,"M_txte");i.preventDefault()};this.hideHelpLayer=function(e){c=window.setTimeout(function(){if(l.helpLayer)o(l.helpLayer)},150)};this.showHelpLayer=function(e){function s(){window.clearTimeout(c);window.setTimeout(function(){if(c){window.clearTimeout(c);c=null}},20);if(l.helpLayer)l.helpLayer.style.display=""}var t=i.sizzle("li[photoid="+e+"]",l.photoList)[0];var n=i.sizzle("div.tagarea",t)[0];var r;if(!n||!n.length){if(!l.helpLayer){l.helpLayer=i.C("div");l.helpLayer.className="tagarea";l.getCommonTags(10,function(e){l.helpLayer.innerHTML='<p class="t"><span class="M_ico M_icon29" action-type="close_help" title="关闭"></span>热门标签：</p>'+'<div class="m_tag_a">'+l.createCommonTags(e,false)+"</div>"});i.builder(t).list["common_tag"][0].appendChild(l.helpLayer);r=i.delegatedEvent(l.helpLayer);r.add("close_help","click",l.hideHelpLayer);i.addEvent(document.body,"click",function(e){var t=e.target||e.srcElement;if(l.helpLayer==t||i.contains(l.helpLayer,t)){if(t.getAttribute("action-type")!="close_help"){s()}}else{if(t.getAttribute("node-type")!="single_tag_input"&&t.getAttribute("action-type")!="remove_tag"){l.hideHelpLayer(e)}}})}else{i.builder(t).list["common_tag"][0].appendChild(l.helpLayer)}}s()};this.onBlur=function(e,t){var n=e.target||e.srcElement;var r=n.value;var s=n.name;var o=i.sizzle("input[type=hidden][name="+s+"]",l.editLayer)[0];l.createTag(r,s,o,true);if(!o.value||t){n.value=n.title;i.addClassName(n,"M_txte")}else{n.value=""}};this.createTag=function(e,t,n,r){if(e.trim()!==""){e=e.decodeHTML();var s=e.split(/\s+|,|;|；|，|　+/),o,u,a,f,c;for(var h=0,p=s.length;h<p;h++){o=s[h].trim();u=o.cutString(l.maxByteLength);c=o.cutString(l.maxByteLength,"",true);a=l.createTagHtml(o,t);if(u=="")continue;if(l.checkAndWriteData(n,c)){var d=i.sizzle("div[node-type=photo_tags_"+t+"]",l.editLayer)[0];(function(e){window.setTimeout(function(){i.addHTML(d,e)},100)})(a)}}}};this.createTagHtml=function(e,t,n){var r=e.cutString(l.maxByteLength);var i=r.cutString(l.maxShowLength,"...");var s='<span class="M_ico M_icon29" pid="'+t+'" tag="'+r+'" action-type="remove_tag" title="删除"></span>';if(n)s="";return'<a href="javascript:void(0)" title="'+r+'" data="'+r+'">'+i+s+"</a>"};this.checkAndWriteData=function(e,t){var n=e.value;var r=n==""?[]:n.split(/[,|\s]/);var i=r.length;if(i>=l.maxTags)return false;for(var s=0;s<i;s++){if(r[s]==t)return false}r.push(t);e.value=r.join(" ");return true};this.removeData=function(e,t,n){var r=e.value;var s=e.getAttribute("name");var o=i.sizzle("input[type=text][name="+s+"]",l.editLayer)[0];var u=r.split(" ");for(var a=0,f=u.length;a<f;a++){if(u[a]==t){u.splice(a,1);break}}e.value=i.trim(u.join(" "));if(!o.value&&n=="batch"){o.blur()}};this.removeTag=function(e){var t=e.target||e.srcElement;var n=t.getAttribute("tag");var r=t.getAttribute("pid");var s=i.sizzle("input[type=hidden][name="+r+"]",l.editLayer)[0];l.removeData(s,n);i.removeNode(a(t,{expr:"a"})[0]);if(r=="batch"){if(!l.hiddenInputs)l.hiddenInputs=i.sizzle("input[type=hidden]",l.photoList);for(var o=0,u=l.hiddenInputs.length;o<u;o++){l.removeData(l.hiddenInputs[o],n,r);i.removeNode(i.sizzle('a[data="'+n+'"]',l.photoList)[0])}}i.preventDefault()}};e.exports=l},z:function(e,t,n,r){e.exports=function(e,t,n){t=t||function(e){return e};var r="",i=t('<div class="L_editphoto">\n    <dl class="m_Layform clearfix">\n        <dt>照片描述：</dt>\n        <dd class="contBox"><textarea class="M_txtarea" name="caption" node-type="caption">'),s=t('</textarea></dd>\n        <dd class="tipBox"><span class="M_txte" node-type="caption_w">'),o=t('/140</span></dd>\n    </dl>\n    <dl class="m_Layform clearfix">\n        <dt>照片标签：</dt>\n        <dd class="contBox">\n            <div class="inputtxt">\n                <div action-type="tag_box" class="inputbd clearfix">\n                    <div class="taglst m_tag_a M_linkc" node-type="photo_tags_'),u=t('"></div>\n                    <input title="标签间以空格隔开" type="text" name="'),a=t('" node-type="single_tag_input" value="标签间以空格隔开" class="M_txte">\n                    <input type="hidden" name="'),f=t('" node-type="pid">\n                </div>\n                <div class="tagarea">\n                    <div class="m_tag_a M_linkc" node-type="common_tags"></div>\n                </div>\n                <div class="setcover M_txtb">\n                    <label>\n                    '),l=t('<input type="checkbox" name="cover" '),c=t("checked"),h=t(' class="M_checkbox" node-type="cbox_cover">设为专辑封面'),p=t('                    </label>\n                </div>\n            </div>\n        </dd>\n    </dl>\n    <div class="submit_centr">\n        <a class="M_btn_e" action-type="submit" href="#"><span>保存</span></a><a class="M_btn_e" action-type="close" href="#"><span>取消</span></a>\n    </div>\n</div>');r+=i;r+=e.caption;r+=s;r+=140-e.counter_caption;r+=o;r+=e.photoID;r+=u;r+=e.photoID;r+=a;r+=e.photoID;r+=f;if(e.show_SetCover){r+=l;if(e.isCover){r+=c}r+=h}r+=p;return r}},Z:function(e,t,n,r){var i=n("A");var s=n("j");var o=n("c");var u=n("F");var a=n("B");var f=n("b");var l=n("l");var c=n("aa");var h=n("aA");var p=n("e");var d=n("L");var v=n("G");var m=n("v");var g=STK.core.util.browser.IE6;var y=function(e){this.config={data:[],total:null,albumdata:null,current:null,pageSize:36,dataurl:null,inpage:1};this.speed=4e3;this.stoptime=8e3;this.stoptimer=null;this.lay=null;this.showlistnum=8;this.timer=null;this.current=0;this.closeCallback=function(){};this.isStop=false;this.loaded=false;this.isend=false;this.isstart=false;this.config=l(this.config,e);this.config.data=this.initDB(this.config.data)};y.prototype={constructor:y,initDB:function(e){var t=this,n=t.config,r=[];r.length=n.total;var i=[(n.inpage-1)*n.pageSize,e.length].concat(e);r.splice.apply(r,i);return r},calculateSize:function(){var e=this,t=e.config,n=t.total,r=t.current,i=t.pageSize,s=t.inpage-1,o=e.showlistnum,u=e.photos,a=e.findPhoto(r,t.data)["current"];return{lastcount:n%i,datapage:Math.ceil(n/i),dataindex:a,index:s*i+a}},checkload:function(){var e=this,t=e.config,n=e.calculateSize();if(!t.dataurl)return;var r=n["dataindex"];var s=Math.ceil(e.showlistnum/2)+2;var o=r+s;var u=r-s;var a=i.builder().list["slide_list"][0];if(!t.data[o]&&o<=t.data.length){e.loaded=true;e.loadright(function(n){var r=n.data["photo_list"];for(var s=0,o=r.length;s<o;s++){t.data[t.inpage*t.pageSize+s]=r[s]}t.inpage++;i.insertHTML(i.sizzle("li:last",a)[0],e.createList(e.initDB(r)),"afterend");e.loaded=false})}else if(!t.data[u]&&u>0){e.loaded=true;e.loadleft(function(n){var r=n.data["photo_list"];for(var s=0,o=r.length;s<o;s++){t.data[(t.inpage-2)*t.pageSize+s]=r[s]}t.inpage--;i.insertHTML(i.sizzle("li:first",a)[0],e.createList(e.initDB(r)),"beforebegin");e.loaded=false})}if(r==t.total-1&&!t.data[0]){e.loadDB({page:1,count:e.config.pageSize},function(n){var r=n.data["photo_list"];for(var s=0,o=r.length;s<o;s++){t.data[s]=r[s]}i.insertHTML(a,e.createList(r),"beforebegin");e.loaded=false})}},successhandle:function(e,t){var n=this;if(e.result){t(e)}else{alert(e.msg||"照片获取失败")}},errorhandle:function(){var e=this;alert("数据获取超时");e.loaded=false},loadDB:function(e,t){var n=this;a({url:n.config.dataurl,args:e,onComplete:function(e){n.successhandle(e,t)},onError:function(){n.errorhandle()}})},loadright:function(e){var t=this;var n=t.config.inpage+1;var r={page:n,count:t.config.pageSize};t.loadDB(r,e)},loadleft:function(e){var t=this;var n=t.config.inpage-1;var r={page:n,count:t.config.pageSize};t.loadDB(r,e)},createTop:function(e,t){var n=this,r='<div class="topMenu" node-type="bar_top">            <div class="alpha"></div>                <div class="content">                    <div class="user">'+e+'</div>                    <div class="share">'+t+'</div>                    <div class="M_pages_a" node-type="top_pag"></div>                </div>            </div>';return r},createUserBox:function(){var e=this,t=' <div class="m_thumb m_thumb_c"><a title="'+$CONFIG["owner_data"]["name"]+'" href="'+o.baseURL+$CONFIG["owner_uid"]+"/photos"+'"><img src="'+$CONFIG["owner_data"]["profile_image_url"]+'"></a> </div>                    <span class="name"><a href="'+o.baseURL+$CONFIG["owner_uid"]+"/photos"+'">'+$CONFIG["owner_data"]["name"]+"</a></span>";return t},createTopBar:function(){var e=this,t='<a class="M_linke M_transmit_sm" title="分享" action-type="lay_transmit" href="#">                    <span class="M_ico M_icon4_ly"></span>                </a>			    <a class="M_linke M_comment_sm" title="评论" action-type="lay_comment" target="_blank" href="#">                    <span class="M_ico M_icon5_ly"></span>                </a>                <a class="M_linke M_like_sm" href="#" title="赞" action-type="lay_like">                    <span class="M_ico M_icon6"></span>                </a>';return t},createTopPag:function(e){var t=this;var n=i.C("div");n.style.textAlign="center";t.pag=new f({total:t.config.total,pageSize:1,node:n});t.pag.initUI=function(){var e=[],t=this.pageIndex;if(this.pageCount>1){e.push('<span class="count"><em>'+t+"</em>/<em>"+this.total+"</em></span>")}this.ui.innerHTML=e.join("")};t.pag.initUI();return t.pag.ui},createPic:function(){var e=this,t='<div class="pic" action-type="pic_box" node-type="pic_box"><img node-type="slide_pic"></div>';return t},createConsole:function(e,t){var n=this,r='<div class="console" node-type="bar_down">                        <div class="alpha"></div>                        <div class="content clearfix">'+t+'                             <div class="picLists">';r+='<ul node-type="slide_list">'+e+"</ul>";r+="</div></div></div>";return r},createList:function(e){var t=this,n=t.config,r="";for(var i=0;i<e.length;i++){var s=e[i];if(s){s["square_pic"]=u(s,"square");r+='<li action-type="preview_pic" current="'+i+'" style="position:absolute;top:12px;left:'+78*i+'px;" data-id="'+s["photo_id"]+'" class="'+(s["photo_id"]==t.config.current?"current":"")+'"><img width="60" height="60" src="'+s["square_pic"]+'"></li>'}}return r},createConsoleBar:function(){var e=this,t='<div class="play_prev"><span class="pause" action-type="control_slide"></span><span class="prev" action-type="prev_slide"></span></div>                    <div class="defl_next"><span class="next" action-type="next_slide"></span></span></div>';return t},createClose:function(){return'<div class="closearea" action-type="close_slide"><span class="M_ico M_icon41" title="关闭"></span></div>'},rebuildPic:function(){var e=this;e.imgLoaded=true;if(i.E("J_Slide_Loading"))i.removeNode(i.E("J_Slide_Loading"));var t=i.builder().list["slide_pic"][0],n=i.winSize().height*.8,r=i.winSize().width*.8,s=h(t),o=c(t),u=Math.max(r,o),a=Math.max(n,s);if(u>r||a>n){var f={};if(o>r&&o>s&&s<n){f["width"]=o*(r/o)}else{f["height"]=s*(n/s)}if(f["width"])t.style.width=f["width"]+"px";if(f["height"])t.style.height=f["height"]+"px"}e.removeTip();e.windowRest();e.fadeIn(t)},cacheDB:{},changePhoto:function(e,t){function a(){n.rebuildPic();n.cacheDB[this.src]=true;if(g){if(t){n.barshow();n.barhide()}n.barshow()}if(!n.isStop)n.play()}var n=this,r=n.config,s=n.findPhoto(e,n.config.data);if(e){if(s){n.imgLoaded=false;var f=i.builder().list["slide_list"][0];var l=i.sizzle("li",f);var c=i.builder().list["slide_pic"][0];c.onload=a;s["data"]["original_pic"]=u(s["data"],"mw690");c.src=s["data"]["original_pic"];i.setStyle(c,"opacity",0);c.style.width="";c.style.height="";p(c);if(n.cacheDB[s["data"]["original_pic"]]){setTimeout(function(){n.rebuildPic()},50)}if(!n.imgLoaded){if(i.E("J_Slide_Loading"))i.removeNode(i.E("J_Slide_Loading"));i.insertHTML(c,'<div id="J_Slide_Loading" class="M_loading" style="width:25px;height:25px;margin:'+(i.winSize().height-25)/2+'px auto 0px auto;"></div>',"afterend")}else{}n.current=s.current;if(n.current===0){n.isstart=true}else{n.isstart=false}if(n.current==r.total-1){n.isend=true}else{n.isend=false}r.current=e;n.photoid=e;n.fixPhotoList(t);var h=i.sizzle("li[class=current]",f)[0];if(h)i.removeClassName(h,"current");i.sizzle("li[current="+n.current+"]")[0].className="current";if(s["data"]["type"]==15){i.sizzle("a[action-type=lay_comment]")[0].setAttribute("href",o.baseURL+s["data"]["uid"]+"/talbum/detail/photo_id/"+s["data"]["photo_id"]+"/album_id/"+s["data"]["album_id"])}else{i.sizzle("a[action-type=lay_comment]")[0].setAttribute("href",s["data"]["photoURL"])}var d=i.sizzle("a[action-type=lay_like]>span")[0];d.className=s["data"]["is_liked"]?"M_ico M_icon6_on":"M_ico M_icon6";d.setAttribute("title",s["data"]["is_liked"]?"取消赞":"赞");var v=n.config.data[n.current];if(v["visible_type"]==1||v["visible_type"]==6||v["visible_type"]==3||v["visible_type"]==4||n.config.albumdata&&n.config.albumdata.property!=1||v["property"]&&v["property"]!=1){p(i.sizzle("a[action-type=lay_transmit]")[0])}else{i.sizzle("a[action-type=lay_transmit]")[0].style.display=""}n.checkend()}else{throw new Error("photo id is wrong")}}},play:function(){var e=this;e.timer=setTimeout(function(){e.isStop=false;e.moveright();e.pag.gotoPage(e.current+1)},e.speed);i.sizzle("span[action-type=control_slide]")[0].className="pause"},stop:function(){var e=this;if(e.timer)clearTimeout(e.timer);i.sizzle("span[action-type=control_slide]")[0].className="play";e.isStop=true},moveto:function(e){var t=this,n=i.builder().list["slide_list"][0],r=i.sizzle("li[current="+e+"]",n)[0].getAttribute("data-id");t.config.current=r;t.checkload();t.removeTip();t.changePhoto(r)},moveleft:function(){var e=this;if(e.current<1){e.stop();e.isstart=true;return}if(e.current<=0){return}if(e.loaded)return;e.current--;e.moveto(e.current);e.isstart=false},checkend:function(){var e=this;var t=i.sizzle("[action-type=prev_slide]",e.lay)[0];var n=i.sizzle("[action-type=next_slide]",e.lay)[0];if(e.isstart){t.className="prev_f"}else{t.className="prev"}if(e.isend){n.className="next_f"}else{n.className="next"}},lastTip:function(e){var t=this;var n="",r="",s,u='<div class="rbd" action-type="slide_replay" style="margin-top:150px;"><span class="replay"></span><em>再次播放</em></div>'+r;if(!e){s=o.baseURL+$CONFIG["owner_uid"]+"/albums/detail/album_id/"+t.config.albumdata["album_id"];if(t.config.albumdata["type"]==3){s=o.baseURL+$CONFIG["owner_uid"]+"/talbum/index"}n='<div class="user M_txte">                                  <div class="m_thumb m_thumb_b"> <a title="'+$CONFIG["owner_data"]["name"]+'" target="_blank" href="'+o.baseURL+$CONFIG["owner_uid"]+'/photos"><img src="'+$CONFIG["owner_data"]["profile_avatar_url"]+'"></a></div>                                  <div class="info">                                      <p class="user_album">来自 <a href="'+o.baseURL+$CONFIG["owner_uid"]+"/photos"+'" target="_blank">'+$CONFIG["owner_data"]["name"].cutString(20,"...")+'</a> 的专辑</p>                                      <p class="desc"><a href="'+s+'" target="_blank">'+t.config.albumdata["caption"]+"</a></p>                                  </div>                              </div>";r='<div class="b M_linkf"><a class="M_linkb" href="#" action-type="album_transmit"><span class="M_ico M_icon8"></span>分享</a></div>';if(t.config.albumdata["type"]==32||t.config.albumdata["type"]==42)r="";u='<div class="rbd" action-type="slide_replay"><span class="replay"></span><em>再次播放</em></div>'+r}var a='<div class="L_alpha L_alpha_b">                        <div style="height:400px;" class="alpha"></div>                            <div style="height:400px;" class="content">'+n+u+"                            </div>                    </div>";if(!t.tips){t.tips=i.C("div");t.tips.setAttribute("node-type","slide_tips");t.tips.innerHTML=a;t.lay.appendChild(t.tips);t.resetTips()}var f=i.sizzle("a[action-type=album_transmit]",t.tips)[0];if(t.config.albumdata&&t.config.albumdata.property!=1){p(f)}else{f.style.display=""}},moveright:function(){var e=this;if(e.current>e.config.total-2){e.stop();if(e.config.albumdata)e.lastTip();else e.lastTip(true);e.isend=true;return}if(e.current>=e.config.total-1){return}if(e.loaded)return;e.current++;e.isend=false;e.moveto(e.current)},initAction:function(){function r(){e.barshow();e.stoptimer=setTimeout(function(){e.barhide()},e.stoptime)}var e=this;var t=i.delegatedEvent(e.lay);var n=i.builder(e.lay).list["pic_box"][0];t.add("pic_box","mousemove",function(t){e.imageOnmousemove(t.evt)});t.add("pic_box","click",function(t){e.imageOnclick(t.evt)});t.add("prev_slide","click",function(t){e.stop();e.moveleft();e.pag.gotoPage(e.current+1);i.preventDefault()});t.add("next_slide","click",function(){e.stop();e.moveright();e.pag.gotoPage(e.current+1);i.preventDefault()});t.add("preview_pic","click",function(t){e.current=parseInt(t.el.getAttribute("current"),10);e.stop();e.moveto(e.current);e.pag.gotoPage(e.current+1);i.preventDefault()});t.add("close_slide","click",function(){e.close();i.preventDefault()});i.addEvent(e.lay,"mousemove",r);i.addEvent(e.lay,"click",r);r();t.add("control_slide","click",function(t){var n=t.el;var r=n.className;if(e.isend){e.replay()}else if(r=="pause"){e.stop()}else{e.play()}i.preventDefault()});t.add("slide_replay","click",function(t){e.replay();i.preventDefault()});t.add("lay_like","click",function(t){var n=t.el;var r=e.config.data[e.current];var s={like_uid:r["uid"],target_id:r["photo_id"],type:r["type"]};if(r["is_liked"]){m.cancel(s,function(e){n.innerHTML='<span class="M_ico M_icon6" title="赞"></span>';d(e.msg||"取消赞图成功");r["is_liked"]=false})}else{m.set(s,function(e){var t=e.data;s["is_feed"]=t.result.is_feed;m.likeTip(function(t){n.innerHTML='<span class="M_ico M_icon6_on" title="取消赞"></span>';d(e.msg||"赞图成功",{zIndex:11e3});r["is_liked"]=true;s=l(s,t);i.custEvent.fire(m,"sendFeed",s)},n)})}i.preventDefault()});t.add("lay_transmit","click",function(){var t=e.config.data[e.current];t["thumb150_pic"]=u(t,"thumb150");e.stop();var n={who:$CONFIG["owner_data"]["name"],uid:$CONFIG["owner_uid"],photoId:t["photo_id"],img:t["thumb150_pic"],url:t["thumb150_pic"],target_id:t["photo_id"],target_uid:t["uid"],haveMask:false,type:t["type"]==15?15:2,zIndex:10002,isAlbum:0,on_share:function(e){}};if(e.config.albumdata){n["caption"]=e.config.albumdata["caption"];v(n)}else{a({url:o.baseURL+"photos/get_photo_album_info",args:{photo_id:t["photo_id"],uid:t["uid"],type:t["type"]},onComplete:function(e){n["caption"]=e.data["caption"];v(n)}})}i.preventDefault()});t.add("album_transmit","click",function(){var t=e.config.albumdata,n=t["cover_pic"]!==""?t["cover_pic"]:o.baseIMG+"common/status_0.png";e.stop();var r={caption:t["caption"],who:$CONFIG["owner_data"]["name"],albumId:t["album_id"],img:n,haveMask:false,target_id:t["album_id"],target_uid:t["uid"],type:t["type"]==3?3:1,parent:".L_slide",zIndex:10001,isAlbum:1,on_share:function(e){}};v(r);i.preventDefault()})},fadeIn:function(e,t){e.style.display="";var n=this;i.tween(e,{duration:300,end:function(){if(i.getType(t)=="function"){t.call(n)}}}).play({opacity:1}).destroy()},fadeOut:function(e){i.tween(e,{animationType:"linear",duration:200,end:function(){e.style.display="none"}}).play({opacity:0}).destroy()},barshow:function(){var e=this;if(e.stoptimer)clearTimeout(e.stoptimer);var t=i.builder(e.lay).list["bar_top"][0];var n=i.builder(e.lay).list["bar_down"][0];var r=i.sizzle("[action-type=close_slide]",e.lay)[0];var s=i.core.util.browser;if(s.IE&&(s.IE7||s.IE6)){t.style.display="block";n.style.display="block"}else{e.fadeIn(t);e.fadeIn(n)}e.fadeIn(r)},barhide:function(){var e=i.builder(this.lay).list["bar_top"][0];var t=i.builder(this.lay).list["bar_down"][0];var n=i.sizzle("[action-type=close_slide]",this.lay)[0];var r=i.core.util.browser;if(r.IE&&(r.IE7||r.IE6)){e.style.display="none";t.style.display="none"}else{this.fadeOut(e);this.fadeOut(t)}this.fadeOut(n)},removeTip:function(){var e=this;if(e.tips){i.removeNode(e.tips);e.tips=null}i.builder(e.lay).list["pic_box"][0].style.display=""},replay:function(){var e=this;e.isStop=false;e.changePhoto(e.config.data[0]["photo_id"]);e.pag.gotoPage(1)},windowRest:function(){var e=this;e.reset();e.resetPic();e.resetTips()},moveList:function(e,t){var n=this,r=i.builder(n.lay).list["slide_list"][0],s=r.parentNode;s.style.position="relative";s.style.height="90px";r.style.position="absolute";if(t){r.style.top=0;r.style.left=-e*n.liwidth+"px"}else{i.tween(r,{duration:200}).play({top:0,left:-e*n.liwidth})}},fixPhotoList:function(e){var t=this,n=t.config.total,r=t.current,s=Math.ceil(t.showlistnum/2),o=i.builder(t.lay).list["slide_list"][0];if(!t.initWidth){var u=i.sizzle("li",o);t.liwidth=c(u[0]);o.style.width=t.liwidth*n+"px";o.style.height="90px";t.initWidth=true;o.style.position="absolute";o.style.top=0;o.style.left=r*t.liwidth*u.length+"px";o.style.width=t.liwidth*u.length+"px"}if(r<=s||n<=t.showlistnum){t.moveList(0,e)}else if(r>s&&r<n-s){t.moveList(r-s,e)}else if(r>=n-s){t.moveList(n-t.showlistnum-1,e)}},findPhoto:function(e,t){var n=false;for(var r=0;r<t.length;r++){if(t[r]&&t[r]["photo_id"]==e){n={data:t[r],current:r};break}}return n},getcursoper:function(e,t){var n=i.position(e);var r=(parseInt(t.clientX,10)-n.l)/i.core.dom.getSize(e).width;return r<.5?"left":"right"},imageOnmousemove:function(e){var t=this,n=e.target||e.srcElement,r=i.getEvent();if(t.current<1&&t.getcursoper(n,e)=="left"){i.removeClassName(n,"M_cur_ph_prev");i.removeClassName(n,"M_cur_ph_next");return false}if(t.current>t.config.total-2&&t.getcursoper(n,e)=="right"){i.removeClassName(n,"M_cur_ph_prev");i.removeClassName(n,"M_cur_ph_next");return false}if(t.getcursoper(n,e)=="left"){i.removeClassName(n,"M_cur_ph_next");i.addClassName(n,"M_cur_ph_prev")}else{i.removeClassName(n,"M_cur_ph_prev");i.addClassName(n,"M_cur_ph_next")}return false},imageOnclick:function(e){var t=this;var n=e.target||e.srcElement;var r={left:function(){t.stop();t.moveleft();t.pag.gotoPage(t.current+1)},right:function(){t.stop();t.moveright();t.pag.gotoPage(t.current+1)}};r[t.getcursoper(n,e)]();return false},createSlide:function(e){var t=this,n=t.config,r=t.findPhoto(n.current,e);if(!r)throw new Error("photo current id nonentity");var s=t.createPic(),o=t.createUserBox(),u=t.createTopBar(),a=t.createTop(o,u),f=t.createConsoleBar(),l=t.createList(n.data),c=t.createConsole(l,f,n.total),h=t.createClose();t.current=r.current;if(!t.lay)t.lay=i.C("div");t.lay.className="L_slide";t.lay.style.display="none";t.lay.innerHTML=s+a+c+h},reset:function(){var e=this.lay.style;var t=i.scrollPos();var n=i.winSize();e.width=n.width+"px";e.height=n.height+"px";e.position=g?"absolute":"fixed";e.top=g?t.top+"px":0;e.left=g?t.left+"px":0;e.zIndex=10001},resetTips:function(){var e=i.builder(this.lay).list["slide_tips"];if(!e)return;var t=this,e=e[0],n=400,r=400,s=i.winSize().height,o=i.winSize().width,u=e.style;u.top=parseInt((s-n)/2,10)+"px";u.left=parseInt((o-r)/2,10)+"px";u.width=r+"px";u.height=n+"px";u.position="absolute"},resetPic:function(){var e=this,t=i.builder(e.lay).list["slide_pic"][0],n=i.core.dom.getSize(t).height,r=i.winSize().height;t.style.marginTop=parseInt((r-n)/2,10)+"px"},init:function(){var e=this,t=e.config;e.createSlide(t.data);document.body.appendChild(e.lay);var n=e.createTopPag(t.data);i.builder(e.lay).list["top_pag"][0].appendChild(n);e.open(t.current);e.initAction()},update:function(e,t,n,r,s){var o=this,u=o.config;u.inpage=n;u.total=r;u.albumdata=s;u.data=o.initDB(t);u.current=e;i.removeNode(o.lay);o.createSlide(u.data);document.body.appendChild(o.lay);var a=o.createTopPag(u.data);i.builder(o.lay).list["top_pag"][0].appendChild(a);o.open(e)},destory:function(){},showPic:function(){var e=this;e.windowRest()},close:function(){var e=this;p(e.lay);i.removeEvent(window,"resize",e.winResize);i.removeEvent(window,"scroll",e.winResize);document.body.style.overflow="";e.stop();e.closeCallback(e.photoid,e.config.inpage);e.isStop=false;s.back()},open:function(e){var t=this;t.lay.style.display="";t.showPic();t.winResize=function(){t.windowRest()};i.addEvent(window,"resize",t.winResize);i.addEvent(window,"scroll",t.winResize);document.body.style.overflow="hidden";t.changePhoto(e,true);t.pag.gotoPage(t.current+1);t.checkload();s.showUnderNode(t.lay,{opacity:1})}};e.exports=y},aa:function(e,t,n,r){var i=n("A");var s=i.core.dom;var o=s.getStyle;e.exports=function(e){if(!s.isNode(e)){throw"Parameter must be an HTMLEelement!"}return s.getSize(e).width+(parseFloat(o(e,"marginLeft"))||0)+(parseFloat(o(e,"marginRight"))||0)}},aA:function(e,t,n,r){var i=n("A");var s=i.core.dom;var o=s.getStyle;e.exports=function(e){if(!s.isNode(e)){throw"Parameter must be an HTMLEelement!"}return s.getSize(e).height+(parseFloat(o(e,"marginTop"))||0)+(parseFloat(o(e,"marginBottom"))||0)}},ab:function(e,t,n,r){var i=n("A");var s=n("aB");var o=n("b");var u=n("c");n("o");var a=u.baseURL;var f=u.baseIMG;var l=$CONFIG.owner_uid;var c=$CONFIG.account_uid==$CONFIG.owner_uid;var h={pagination:null,albumData:{},parent:null,pageNode:null,init:function(e,t,n){var r=this;this.parent=e;this.pageNode=t;this.getAllAlbum(l,1,5,function(e,t){if(i.getType(n)=="function"){n.apply(r,arguments)}r.createAlbum(e)})},getAllAlbum:function(e,t,n,r){var i=this;s.get({url:a+"albums/get_all",args:{uid:e,page:t,count:n},onComplete:function(e){if(e&&e.result){total=e.data.total;if(!i.pagination){i.pagination=new o({total:total,pageSize:5,node:i.pageNode,callback:i.loadAlbums,scope:i});i.pagination.initUI=function(){var e=[],t=this.pageIndex;if(this.pageCount>1){e.push('<div class="M_pages">');if(t!==1){e.push('<a href="#" action-data="page=prev" class="up M_ico M_icon19" action-type="pageTo" title="上一页"></a>')}if(t!==this.pageCount){e.push('<a class="nt M_ico M_icon20" title="下一页" action-type="pageTo" action-data="page=next" href="#"></a>')}e.push("</div>")}this.ui.innerHTML=e.join("")}}if(r&&typeof r==="function"){r.call(i,e.data.album_list,total);i.pagination.initUI()}}}})},createAlbum:function(e){var t=this,n=[],r,i,s,o,u,h,p,d,v,m;if(e){for(var g=0,y=e.length;g<y;g++){r=e[g];m=r.album_id;t.albumData[m]=r;p=r.type;u=r.count;h=r.cover_pic;s=r.caption;i=r.isPay;v="";if(!h){if(parseInt(r.property,10)==5){d=r.answer;if(typeof d=="boolean"&&!d){v='action-type="answer"';h=f+"common/status_sm_3.png"}else{if(!h)h=f+"common/status_sm_0.png"}}else if(p==3){h=f+"common/status_sm_ilustri.png"}else if(p==18){h=f+"common/default_head.png"}else if(p==11){h=f+"common/status_big_4.png"}else{h=f+"common/status_sm_0.png"}}if(p==3){o=a+l+"/talbum/index"}else{o=a+l+"/albums/detail/album_id/"+r.album_id}n.push('<li action-data="aid='+m+'">');n.push('<div class="m_cover m_cover_a">');n.push('<div class="img_wrap">');if(!c&&!i&&(p==43||p==44)){n.push('<div class="pic_mask">');n.push('<div class="mask_bg"></div>');n.push('<a href="'+o+'" class="act_btn">'+(p==43?"开会员":"购 买")+"</a>");n.push("</div>")}n.push('<a title="'+s+'" href="'+o+'" '+v+">");n.push('<img height="90" width="90" src="'+h+'">');if(p==43||p==44){n.push('<span class="'+(p==43?"photo_vippic":"photo_paypic")+'"></span>')}n.push("</a></div>");n.push("</div>");n.push('<p><a title="'+r.caption+'" href="'+o+'" '+v+' class="M_linkb">'+r.caption.cutString(24,"...")+"</a></p>");n.push('<p class="M_txtb">(共'+u.photos+"张)</p>");n.push("</li>")}}if(this.parent)this.parent.innerHTML=n.join("")},loadAlbums:function(e){this.getAllAlbum(l,e.page,5,this.createAlbum)}};e.exports=h},aB:function(e,t,n,r){var i=n("A");var s=n("B");var o={};o.CacheDB={};o.get=function(e){var t=e.url+i.jsonToQuery(e.args);if(o.CacheDB[t]){if(i.getType(e.onComplete)=="function")e.onComplete(o.CacheDB[t])}else{var n=e.onComplete;e.onComplete=function(e){o.CacheDB[t]=e;n.apply(this,arguments)};s(e)}};o.destroy=function(e,t){if(e){var n=t?i.param(t):"";o.CacheDB[e+n]=undefined}else{o.CacheDB={}}};e.exports=o},ac:function(e,t,n,r){var i=n("A");var s=n("B");var o=n("j");var u=n("c");var a=n("m");var f=n("aC");var l=n("e");var c=function(e){function d(){var e="",t=l.orgFlag,n=l.eventRec,r=l.tagRec,i=l.userRec,s=l.orgRec,o=true,u=/^http(s?):\/\//.test(n.url)?n.url:"http://"+n.url;e+='<a href="#" action-type="cancel" class="close"></a>'+'<div class="L_guide">'+'<div class="guide_hd">'+'<h3 class="M_hidetxt">微相册推荐精彩内容</h3>'+'<div class="pic_area">'+'<a title="'+(n.name||"")+'" href="'+u+'" target="_blank"><img src="'+n.pic+'" alt=""></a>'+"</div>"+'<div class="m_box_mod hot_tags">'+'<div class="hd">'+'<h4><span class="M_ico M_icon81"></span>热门标签</h4>'+"</div>"+'<div class="bd">'+'<div class="m_photo_list_a">'+v(r)+"</div>"+"</div>"+"</div>"+"</div>"+'<div class="guide_bd">'+'<div class="m_box_mod famous_phor">'+'<div class="hd">'+'<h4><span class="M_ico M_icon82"></span>知名摄影人</h4>'+'<div class="act">'+'<label for="user_checkall" class="check_all">'+'<input id="user_checkall" value="list_user" class="M_checkbox" checked="'+o+'" type="checkbox">全选加关注'+"</label>"+"</div>"+"</div>"+'<div class="bd">'+'<div class="m_photo_list_a" node-type="list_user">'+m(i,o)+"</div>"+"</div>"+"</div>"+g(s,o,t)+"</div>"+'<div class="guide_ft">'+'<div class="btn_wrap">'+'<a href="#" action-type="try_now" class="M_btn_a"><span>立即体验</span></a>'+"</div>"+"</div>"+"</div>";return e}function v(e){var t=[],n,i,s;if(e){t.push('<ul class="photoList clearfix">');for(var o=0,u=e.length;o<u;o++){n=e[o];s=n.name;i=r+"tags/best/tag/"+s+"?prel=p7_2";t.push("<li>");t.push('<dl class="m_photoItem m_photoItem_a">');t.push('<dt class="photo">');t.push('<a href="'+i+'" target="_blank"><img src="'+n.pic+'" alt=""></a>');t.push("</dt>");t.push("<dd>");t.push('<p class="M_linkc desc"><a href="'+i+'" target="_blank" title="">'+s+"</a></p>");t.push("</dd>");t.push("</dl>");t.push("</li>")}t.push("</ul>")}return t.join("")}function m(e,t){var n=[],i,s,o;if(e){n.push('<ul class="photoList clearfix">');for(var u=0,a=e.length;u<a;u++){s=e[u];i=s.uid;o=r+i+"/albums";n.push("<li>");n.push('<dl class="m_photoItem m_photoItem_a">');n.push('<dt class="photo">');n.push('<a href="'+o+'" target="_blank"><img src="'+s.profile+'" alt=""></a>');n.push('<input class="M_checkbox" value="'+i+'" name="user" checked="'+!!t+'" type="checkbox">');n.push("</dt>");n.push("<dd>");n.push('<p class="M_linkc desc"><a href="'+o+'" target="_blank" title="">'+s.screen_name+"</a></p>");n.push("</dd>");n.push("</dl>");n.push("</li>")}n.push("</ul>")}return n.join("")}function g(e,t,n){var r="";if(!n){r='<div class="m_box_mod phor_agency">'+'<div class="hd">'+'<h4><span class="M_ico M_icon83"></span>摄影机构</h4>'+'<div class="act">'+'<label for="org_checkall" class="check_all">'+'<input id="org_checkall" value="list_org" class="M_checkbox" checked="'+!!t+'" type="checkbox">全选加关注'+"</label>"+"</div>"+"</div>"+'<div class="bd">'+'<div class="m_photo_list_a" node-type="list_org">'+m(e,t)+"</div>"+"</div>"+"</div>"}return r}var t=[];var n="1962310741";var r=u.baseURL;var l=null;var c=this;var h;t[0]='<dl class="guide_info">'+'<dt>新版"微相册"</dt>'+"<dd>围观Ta的生活映像，闪耀你的精致视界！</dd>"+"<dd>快速上传、美图、高清大图。</dd>"+'<dd class="follow"><label for="follow" action-type="check_fllow" class="follow"><input type="checkbox" checked="checked" id="follow">关注"微相册"官方微博</label></dd>'+'<dd class="btn_wrap"><a class="btn_next" href="javascript:void(0)">下一步</a></dd>'+"</dl>";var c=this;this.curStep=e||0;this.guideNode=i.C("div");this.guideNode.className="m_guide";var p=i.delegatedEvent(this.guideNode);this.do_step=function(){if(t[this.curStep]){this.guideNode.innerHTML=t[this.curStep]}};this.hide=function(){p||p.destroy();i.removeNode(c.guideNode);i.removeEvent(document,"click",this.goShareToWB)};this.shareToWB=function(){f({beforeHideFn:c.showRecommendLayer})};this.show=function(){this.guideNode.style.display=""};this.setPosition=function(){var e=i.core.dom.getSize(this.guideNode);var t=i.winSize().width-e.width/2;this.guideNode.style.top=0;this.guideNode.style.zIndex=1e4};this.getUserByUid=function(e,t){s({dataType:"json",url:r+"users/get_user",data:{uid:e},type:"get",success:function(e){if(t&&typeof t=="function"){t.call(c,e)}}})};this.do_follow=function(e,t){s({url:r+"users/follow",args:{uid:e},method:"post",onComplete:function(e){if(t&&typeof t=="function"){t.call(this,e)}}})};this.follow_batch=function(e,t){s({url:r+"users/follow_batch",args:{uids:e},method:"post",onComplete:function(e){if(t&&typeof t=="function"){t.call(this,e)}}})};this.addEvent=function(){p.add("check_fllow","click",function(e){e.stopEvent()});p.add("close","click",this.goShareToWB);i.addEvent(document,"click",this.goShareToWB)};this.goShareToWB=function(){var e=i.E("#follow");if(e&&e.checked){c.getUserByUid(n,function(e){if(e&&e.result){if(e.data&&!e.data.following){c.do_follow(n)}}})}c.hide();o.hide();c.shareToWB();i.preventDefault()};this.getRecommendData=function(e){if(l){if(e&&typeof e=="function"){e.apply(this,argumengts)}}else{s({url:r+"users/get_guide",method:"get",onComplete:function(t){if(t&&t.result){l=t.data;if(e&&typeof e=="function"){e.apply(c,arguments)}}}})}};this.showRecommendLayer=function(){c.getRecommendData(function(){h=a(d(),{title:false});h.setMiddle().show();c.addRecommendEvent(h.getBox())})};this.addRecommendEvent=function(e){function r(e){var t=e.target||e.srcElement;var n=t.value,r=i.builder(h.getBox()).list[n][0];nodes=i.sizzle("input:checkbox",r);window.setTimeout(function(){i.foreach(nodes,function(e,n){e.checked=t.checked})},10)}if(e){var t=i.E("org_checkall");var n=i.E("user_checkall");i.addEvent(org_checkall,"click",r);i.addEvent(n,"click",r);h.addEvent("try_now","click",function(){c.doTryNow(e);i.removeEvent(t,"click",r);i.removeEvent(n,"click",r);i.preventDefault()})}};this.doTryNow=function(e){var t=i.sizzle("input[type=checkbox][name=user]",e);var n=[];for(var r=0,s=t.length;r<s;r++){if(t[r].checked)n.push(t[r].value)}if(n.length){c.follow_batch(n.join(","))}h.hide()};this.init=function(){if($CONFIG&&$CONFIG.account_settings&&$CONFIG.account_settings.guide){document.body.appendChild(this.guideNode);o.showUnderNode(this.guideNode);this.do_step();this.show();this.setPosition();this.addEvent()}};this.init()};e.exports=c},aC:function(e,t,n,r){var i=n("A");var s=n("h");var o=n("B");var u=n("c");var a=n("ad");var f=n("D");var l=u.baseURL;e.exports=function(e){function h(e,t){o({url:l+"sina/update",args:e,method:"post",onComplete:function(e){if(t&&typeof t==="function"){t.call(this,e)}}})}var t,n,r,u=null;var f;var c={init:function(){c.pars();c.build();c.bind()},pars:function(){e=i.parseParam({title:"分享到微博",ok:i.funcEmpty,beforeHideFn:i.funcEmpty},e||{})},build:function(){n=s();n.setContent(a(e));n.setTitle(e.title);n.setClassName("L_shareWB");n.setMiddle().show();n.setBeforeHideFn(e.beforeHideFn);t=n.getBox();r=n.getDomList(true)},bind:function(){f=i.delegatedEvent(t);f.add("ok","click",function(){var e=i.sizzle("textarea",t)[0];h({content:e.value,type:1});n.hide()});i.custEvent.add(n,"hide",function(){i.custEvent.remove(n,"hide",arguments.callee);f.destroy();n.destroy()})}};c.init();u=n;return u}},ad:function(e,t,n,r){e.exports=function(e,t,n){t=t||function(e){return e};var r="",i=t('<div class="shareWB"><div class="txtarea"><textarea class="M_txtarea">我在用刚刚发布的#新版微相册#，看起来还不错～是个分享照片的好地方，想看看朋友们的照片吗？猛击这个链接[嘻嘻]</textarea></div><div class="shareTo"><a href="#" action-type="ok" class="M_btn_b"><span>开始使用微相册</span></a><a href="#" action-data="2" action-type="close" class="M_linkg">跳过</a></div></div>');r+=i;return r}}});