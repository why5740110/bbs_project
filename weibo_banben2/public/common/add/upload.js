(function(f){var c={};var i=function(k){return c[k];};var r=function(k){if(!c[k]){var m={exports:{}};try{f[k].call(m.exports,m,m.exports,r,i)}catch(e){};c[k]=m.exports;}return c[k];};return r('a');})({a:function(e,t,n,r){function J(e){var t=location.href,n,r=t.indexOf("#"),i,s,o,u,a=-1;n=t.substring(r+1);t=r!==-1?t.substring(0,r):t;if((r=t.indexOf("?"))!==-1){i=t.substring(r+1,t.length).split("&");while(s=i[++a],s=s&&s.split("=")){o=s[0];if(e===o)return s[1]}}return n}function Q(e,t){var n=A+"upload/photo";e=e||{};if(q["from"])e["from"]=q["from"];if(q["text"])e["subject"]=q["text"];if(q["eid"])e["event_id"]=q["eid"];if(W&&z&&U){var r=U.get();if(r){if(r.option)e["option"]=c.stringify(r.option);e["event_id"]=r.option["event_id"];n+="?eid="+r.option["event_id"];R=r.tags||""}}if(B.albumData[P]&&(B.albumData[P].type=="43"||B.albumData[P].type=="44")){e["album_type"]=B.albumData[P].type}h({method:"post",url:n,args:e,onComplete:function(e){if(t&&typeof t=="function"){t.call(this,e)}}})}var i=n("A");var s=n("b");var o=n("C");var u=n("d");var a=n("D");var f=n("e");var l=n("E");var c=n("F");var h=n("g");var p=n("G");var d=n("j");var v=n("J");var m=n("B");var g=n("O");var y=n("q");var b=n("p");var w=n("R");var E=n("k");var S=n("s");var p=n("G");var x=n("S");var T=n("T");var N=n("U");var C=n("w");var k=n("u");var L=n("z");n("c");n("Z")();var A=u.baseURL;var O=u.baseSWF;var M=u.cssVersion;var _=$CONFIG.account_uid;var D=i.E("uploadPanel");var P;var H=$CONFIG.account_settings.watermark;var B;var j=1e3;var F=false;var I=false;var q={};var R="";var U;var z=$GLOBAL_EVENT||"";var W=false;var X=new s;var V=function(e,t){var n,r={1:["所有人可见",""],2:["仅自己可见","M_ico  M_icon39"],3:["相互关注可见","M_ico M_icon39"],4:["相互关注可见","M_ico M_icon39"],5:["回答问题可见","M_ico M_icon39"],6:["私密微博配图","M_ico M_icon39"],7:["密友可见","M_ico M_icon39"],11:{43:["会员可见","ab_tag","会员"],44:["付费可见","ab_tag","付费"]}};var n=r[e];if(n){if(n instanceof Array){return n}if(n[t]){return n[t]}}return r[1]};var $=function(){function n(e){var t,n=true;if(W&&z&&z["extend"]){t=z["extend"]["is_need"];if(t){var r=i.sizzle("textarea",e),s,o;for(var u=0,a=r.length;u<a;u++){s=r[u];o=s.value.trim();if(o==""||o==s.title){i.addClassName(s,"M_txtarea_error");n=false}}}}return n}function r(e,t){h({url:A+"settings/set_tag_trip",method:"post",args:{tag_trip:e},onComplete:function(e){if(t&&typeof t=="function"){t.call(this,e)}}})}var e=this;var t="";this.commonTags=null;this.editLayer=null;this.maxTags=10;this.photoList=null;this.hiddenInputs=null;this.helpLayer=null;this.textareas=null;this.tags=null;this.albumData={};this.count=0;this.locked=false;this.composited_pic=null;this.available=true;this.flashCanUse=true;this.isOrig=0;this.commomUpload=i.E("common_upload");this.flashUpload=i.E("flash_upload");this.initFlash=function(){var e=document.title;if(!o.hasFlashPlayerVersion("11.3.0")){this.flashCanUse=false;i.E("upload").innerHTML='<span class="tip">您的机器尚未安装flash插件或flash插件版本过低，不能使用上传照片功能。</span>';return}var t={id:"upload",quality:"high",allowscriptaccess:"always",wmode:"transparent",allowfullscreen:false};var n={getTicketByJS:true};var r={id:"uploadid",name:"uploadid",align:"middle"};var s=O+"upload.swf?v="+M;if(i.core.util.browser.IE){s=O+"upload.swf?v="+(new Date).getTime();document.attachEvent("onpropertychange",function(t){if(t.propertyName==="title"&&document.title!==e){setTimeout(function(){document.title=e},1)}})}o.createSWF({data:s,id:"uploadid",width:950,height:576},t,"upload")};this.getAlbum=function(e){h({url:A+"albums/get_list",onComplete:function(t){if(t&&t.result){if(e&&typeof e=="function"){e.call(this,t.data)}}}})};this.formatSelectItem=function(e){var t=V(e.property,e.type);t='<span title="'+t[0]+'" class="'+t[1]+'">'+(t[2]?t[2]:"")+"</span>";return e.caption.cutString(14,"...")+"("+(e.count||0)+")"+t};this.formatData=function(t,n,r){var i=[],s,o,u=0,a=false;for(var f=0,l=t.length;f<l;f++){s=t[f];if(s.count<j){if(n&&n==s.album_id){u=i.length;a=true}else if(r&&r==s.caption){u=i.length;a=true}this.albumData[s.album_id]=s;o=e.formatSelectItem(s);i.push({name:o,id:s.album_id})}}return{list:i,index:u,isMatch:a}};this.initAlbum=function(t){var n=q["albumName"];var r=q["auhr"];e.getAlbum(function(t){var s=i.builder().list["album_select"][0];var o=J();var u=e.formatData(t,o,n);if(!u.isMatch&&n!=""){e.addAlbum(null,n,r)}X.init(s,u.list,{selectedIndex:u.index,lockedEvent:e.addAlbum,callback:window.callBack});e.initActivity(t)})};this.addAlbum=function(t,n,r){if(!e.available)return false;var s={title:d["11004"],name:n,type:"",property:1,price:"",prices:"",afterEvent:function(t){e.albumData[t.album_id]=t;X.appendData({name:e.formatSelectItem(t),id:t.album_id},true)}};if(t&&t.data){s=i.parseParam(s,t.data)}N(s,false);i.preventDefault()};this.setAddAlbumBtnStatus=function(e){var t=i.sizzle("a[action-type=album_add]")[0];this.available=e;if(e){i.removeClassName(t,"M_btn_disb")}else{i.addClassName(t,"M_btn_disb")}};this.switchLayer=function(e){var t=i.builder().list["upload"];var n;for(var r=0,s=t.length;r<s;r++){layer=t[r];if(layer.getAttribute("_tel")==e){layer.style.display="";this.editLayer=layer}else{m(layer)}}};this.uploadComplete=function(t){var n,r="",i;if(e.albumData[P]){n=e.albumData[P];r=n.caption;i=parseInt(n.property,10)}if(i==1){this.showDialog(this.count,r,t,q["text"])}else{x("保存成功");this.toAlbumPage()}};this.showDialog=function(n,r,s,o){function b(){var n=m.value;var r=v.getIds();e.publicWeibo({album_id:P,url:e.composited_pic,content:n,wbphoto_pids:r.pids.join(","),wbphoto_ids:r.ids.join(","),feed_id:t,photo_ids:s.photo_ids.join(",")})}var u=i.E("event_ckb");var a=u&&u.checked?e.showSpecialDiscount:e.toAlbumPage;var f="发一条微博告诉你的朋友吧";var l="上传了"+n+"张照片到“微相册”。";if(o){f="发条微博马上参赛哦";l=o}var c=w({title:"发布到微博",tip:f,content:l,count:n});var h=E(c,{cancelCallback:a,hideCallback:a,okCallback:b});h.setMiddle().show();var d=h.getDomList(true);var v=new S(s.data,d["select_panel"],{min:1,max:10},{w:80,h:80});v.initUI();var m=d["textEl"];h.addEvent("face","click",function(e){p.ShowFace(e.el,m);i.preventDefault()});y({nodeList:{textEl:m,wordNum:d["txt_tip"]},opts:{limitNum:130}});var g=C({nodeList:{textEl:m}});g.init()};this.publicWeibo=function(t){h({url:A+"sina/upload_retweet",method:"post",args:t,onComplete:function(e){}});var n=i.E("event_ckb");var r=n&&n.checked?e.showSpecialDiscount:e.toAlbumPage;window.setTimeout(r,500)};this.showSpecialDiscount=function(){var t=['<div class="layer_cp">','<a href="#" action-type="cancel" class="close_btn"></a>','<a href="#" action-type="ok" class="btn"></a>',"</div>"].join("");var n=E(t,{cancelCallback:e.toAlbumPage,hideCallback:e.toAlbumPage,okCallback:function(){window.location.href="http://snowbeer.jd.com/view_page-8663258.html"}});n.setMiddle().show()};this.toAlbumPage=function(){location.href=A+_+"/albums/detail/album_id/"+P};this.sendFeed=function(e){h({method:"post",url:A+"upload/up_feed",args:e,onComplete:function(e){if(e&&e.result){t=e.data.feed_id}}})};this.initEditLayer=function(t,n,s){function k(){var e=i.E("#chkbox_tag_tip");if(e&&e.checked){r(e.checked)}m(f);return false}var o,u,a,f,l={},c="",h,p=[];i.removeNode(i.E("uploadid"));e.composited_pic=n||e.composited_pic;I=false;F=false;e.switchLayer("edit");document.body.className="P_uppict_edit";o=e.createPhotoList(t);u=i.sizzle("input[node-type=batch_tag_input]",e.editLayer)[0];a=i.sizzle("div[node-type=photo_tags_batch]",e.editLayer)[0];f=i.sizzle("div[node-type=tag_tip]",e.editLayer)[0];e.sendFeed({album_id:P,photo_ids:o.photo_ids.join(",")});l.album_id=P;l.photo_ids=o.photo_ids.join(",");if(s)l.type=s;l.isOrig=e.isOrig;e.uploadLog(l);if($CONFIG&&$CONFIG.account_settings&&!$CONFIG.account_settings.tag_trip){f.style.display=""}if(R&&typeof R=="string"){R=R.replace(/;|；|\s+|　+/g,"");p=R.trim().split(",");for(var d=0,v=p.length;d<v;d++){h=p[d];c+='<a data="'+h+'" title="'+h+'" href="javascript:void(0)">'+h.cutString(12,"...")+"</a>"}a.innerHTML=c;i.sizzle("input[type=hidden][name=batch]",e.editLayer)[0].valule=R}e.tags=new g(e.editLayer,e.photoList);e.tags.getCommonTags(10,function(t){i.sizzle("div[node-type=common_tags]",e.editLayer)[0].innerHTML=e.tags.createCommonTags(t,true)});var w=i.builder(D).list;var E=i.sizzle("input[type=text]",e.editLayer);var S,x;for(var T=0,N=E.length;T<N;T++){y({nodeList:{textEl:E[T]},opts:{limitNum:10},before_cut:function(e,t){if(/(;|,|；|，|\s)$/.test(t)){return false}}});if(E[T].getAttribute("node-type")=="single_tag_input"){i.addEvent(E[T],"keyup",e.tags.onKeyup);i.addEvent(E[T],"focus",function(t){var n=t.target||t.srcElement;e.tags.onFocus.call(this,t);e.tags.showHelpLayer.call(this,n.name)});i.addEvent(E[T],"blur",function(t){e.tags.onBlur.call(this,t);e.tags.hideHelpLayer.call(this,t)});x=E[T].name;S=i.sizzle("textarea[name="+x+"]",e.photoList)[0];y({nodeList:{textEl:S},opts:{limitNum:140}});i.addEvent(S,"focus",function(e){var t=e.target||e.srcElement;if(t.value==t.title){t.value="";i.removeClassName(t,"M_txte")}});i.addEvent(S,"blur",function(e){var t=e.target||e.srcElement;if(t.value.trim()==""){t.value=t.title;if(W&&z&&z["extend"]["is_need"]){i.addClassName(t,"M_txtarea_error")}else{i.addClassName(t,"M_txte")}}else{i.removeClassName(t,"M_txtarea_error")}})}}var C=i.delegatedEvent(e.editLayer);C.add("tag_batch_box","click",function(e){u.focus();i.preventDefault()});C.add("tag_box","click",function(e){var t=e.el;var n=i.sizzle("input:text",t)[0];n.focus();i.preventDefault()});C.add("remove_tag","click",function(t){e.tags.removeTag(t.evt)});C.add("batch_add","click",function(t){var n=t.el.title,r="batch";e.tags.addTagsAll(n,r);var s=i.sizzle("input[type=text][name="+r+"]",e.editLayer)[0];i.removeClassName(s,"M_txte");s.value="";i.preventDefault()});C.add("single_add","click",function(t){var n=t.el,r=n.title,s=b(n,{expr:"li"})[0],o=s.getAttribute("photoid"),u=i.sizzle("input[type=hidden]",s)[0];i.sizzle("input[type=text][name="+o+"]",s)[0].value="";e.tags.createTag(r,o,u);i.preventDefault()});C.add("submit","click",function(t){e.submit(t.evt,o)});C.add("close_tag_tip","click",k);i.addEvent(u,"keyup",e.tags.onBatchInputKeyup);i.addEvent(u,"focus",e.tags.onBatchInputFocus);i.addEvent(u,"blur",e.tags.onBatchInputBlur)};this.uploadLog=function(e,t){h({method:"post",url:A+"photos/upload_log",args:e,onComplete:function(e){if(t&&typeof t=="function"){t.call(this,e)}}})};this.createPhotoList=function(e){var t=[],n,r,s=[],o=[],u,a,f=e.length,l=[],c,h="",p="最多140个字";var d=i.builder(D).list;this.count=f;d["upload_info"][0].innerHTML="上传成功"+f+"张，填写照片描述和标签";if(R&&typeof R=="string"){R=R.replace(/;|；|\s+|　+/g,"");l=R.trim().split(",");for(var v=0,m=l.length;v<m;v++){c=l[v];h+='<a data="'+c+'" title="'+c+'" href="javascript:void(0)">'+c.cutString(12,"...")+"</a>"}}if(W&&z){if(z["extend"]&&z["extend"]["is_need"]){p=z["extend"]["describe"]}}for(var g=f-1;g>=0;g--){n=e[g];u=n.photo_id;s.push(u);a=n.pid;r=n.zone||2;n.url=L(n,"square");o.push(a);t.push('<li photoid="'+u+'">');t.push('<div class="m_editphoto">');t.push('<div class="parea"><img alt="" src="'+L(n,"small")+'"></div>');t.push('<div class="editarea">');t.push('<dl class="desc">');t.push("<dt>描述：</dt>");t.push('<dd class="ddbox"><textarea title="'+p+'" name="'+u+'" class="M_txtarea M_txte">'+p+"</textarea></dd>");t.push("</dl>");t.push('<dl class="tag">');t.push("<dt>标签：</dt>");t.push('<dd class="ddbox">');t.push('<div class="inputbd clearfix" action-type="tag_box" photoid="'+u+'">');t.push('<div class="taglst m_tag_a" node-type="photo_tags_'+u+'">'+h+"</div>");t.push('<input type="text" value="最多10个标签" title="最多10个标签" name="'+u+'" node-type="single_tag_input" class="M_txte">');t.push('<input type="hidden" value="'+(l.join(" ")||"")+'" name="'+u+'">');t.push("</div>");t.push('<div class="set M_txtb" node-type="common_tag">');t.push('<dd class="M_txtb ddbox"><label><input type="radio" name="cover" value="'+u+'" class="M_radio">设为专辑封面</label></dd>');t.push("</div>");t.push("</dd>");t.push("</dl>");t.push("</div>");t.push("</div>");t.push("</li>")}this.photoList=d["photo_list"][0];this.photoList.innerHTML=t.join("");return{photo_ids:s,pids:o,data:e}};this.submit=function(t,r){if(!a.isLogin()){location.reload()}if(e.locked)return;i.preventDefault();var s,o;var u=i.sizzle("form[name=uploadEditForm]",e.editLayer)[0];if(!n(u)){k({text:"所有参赛照片都需要添加照片名称哦"});return false}var f=c.form2json(u,null,false,false,true);var l={};var p=f["cover"]||"";delete f["cover"];l.album_id=P;l.cover=p;l.data=c.stringify(f);var d="保存失败",v="error";e.locked=true;h({method:"post",url:A+"photos/update_batch",args:l,onComplete:function(t){e.locked=false;if(t&&t.result){e.uploadComplete(r)}else{x(t.msg||d,{type:v})}}})};this.getTicket=function(e){if(!a.isLogin()){location.reload();return}h({method:"post",url:A+"sina/get_ticket",onComplete:function(t){if(t&&t.result){if(e&&typeof e=="function"){e.call(this,t.data)}}}})};this.doCancelCommUpload=function(e){location.href=A+_+"/photos";return false};this.initEvent=function(){var t=i.delegatedEvent(D);var n;t.add("album_add","click",e.addAlbum);t.add("go_common_upload","click",function(t){var r=i.sizzle("div[node-type=event_menu]");if(r.lenght>1){m(r[0])}i.preventDefault();window.document.documentElement.scrollTop=0;window.document.body.scrollTop=0;if(n)return;n=new T(e.commomUpload,{link:'<a href="'+A+_+"/photos"+'">返回我的相册»</a>',initCbk:function(){e.commomUpload.style.display="";m(e.flashUpload)},uplaodCbk:function(){P=X.getValue();X.setAvailable(false);e.setAddAlbumBtnStatus(false)},getAlbumId:function(){return X.getValue()},getAlbumData:function(){return B.albumData},uploadCompleteCbk:window.breakout});n.init()})};this.getURLParams=function(){q["albumName"]=f("album",true);q["text"]=f("text",true);q["auhr"]=f("auhr",true)=="0"?false:true;q["from"]=f("from",true);q["eid"]=f("eid",true);q["show"]=f("show",true);R=f("tag",true)};this.initActivity=function(t){var n=i.E("event_ckb");if(z){if(z.type==1){U=new v(z.target,t,n,{onCreateNewAlbum:function(t,n){if(t){e.albumData[n.album_id]=n;X.appendData({name:e.formatSelectItem(n),id:n.album_id},true)}else{X.onSelected(n)}},callback:function(e){W=e},data:z});if(q["show"]){U.init();n.setAttribute("checked",true)}}else{if(q["show"])R=z.target}if(n){i.addEvent(n,n.addEventListener?"change":"click",function(e){if(n.checked){if(z.type==1){U.init()}else{W=true}}else{W=false;R=""}})}}var r;if(!q["show"]){r=i.builder();r.list["event_menu"]&&r.list["event_menu"][0]&&(r.list["event_menu"][0].style.display="")}};this.init=function(){this.getURLParams();this.initAlbum();this.initFlash();this.initEvent()}};window.getTicket=function(e){h({url:"http://login.sina.com.cn/sso/login.php",args:{entry:"tupian",service:"tupian",returntype:"TEXT",varname:"flashticket"},onComplete:function(t){var n="{";for(var r in t){n+='"'+r+'":"'+t[r]+'",'}n=n.substring(0,n.length-1)+"}";thisMovie("uploadid")&&thisMovie("uploadid")[e](n)}})};var K={};h({url:A+"users/get_watermark",onComplete:function(e){if(e&&e.data){var t=e.data;K["markpos"]=t.position;K["nick"]=t.nickname||"";K["name"]=$CONFIG.account_data.name;K["logo"]=t.logo||0;K["url"]=t.domain||""}}});window.savePhoto=function(e,t,n,r){if(!a.isLogin()){location.reload();return}Q({album_id:t,pid:n,isOrig:r},function(t){var n=c.stringify(t);try{thisMovie("uploadid")[e](n)}catch(r){}})};window.saveLog=function(e){if(!a.isLogin()){location.reload();return}e=e||{};e["jswm"]=K["wm"]||"";h({method:"post",url:A+"upload/log",args:e,onComplete:function(e){}})};window.thisMovie=function(e){if(navigator.appName.indexOf("Microsoft")!=-1){return window[e]}else{return document[e]}};window.callBack=function(){if(!a.isLogin()){location.reload();return}P=X.getValue();if(B.albumData[P]&&(B.albumData[P].type=="43"||B.albumData[P].type=="44")){K.pri=1}if(P==""){B.addAlbum();K.canUpload=false}else{K.canUpload=true}K.album_id=P;K.uid=_;K.album_type=B.albumData[P].type;K.watermark=H;K.baseURL=upload_url?upload_url:"";if(W&&U&&U.get()){var e=U.get()["wm"];if(e)K.wm=e}else{delete K["wm"]}thisMovie("uploadid")&&thisMovie("uploadid").setparams&&thisMovie("uploadid")&&thisMovie("uploadid").setparams(K);return false};window.breakout=function(e,t,n){if(e&&e!=""){var n=B.albumData[P].type;var r={};var s=i.foreach(e,function(e,t){e["small_pic"]=["http://ww",e.zone,".sinaimg.cn/small/",e.pid,".jpg"].join("");e["square_pic"]=["http://ww",e.zone,".sinaimg.cn/square/",e.pid,".jpg"].join("");r[e.pid]=t;return e.pid}).join(",");if(n=="43"||n=="44"){var o={album_id:P,uid:$CONFIG.account_uid,pids:s,size:"small,square",album_type:n};h({url:A+"sina/get_pay_url",method:"post",args:o,onComplete:function(i){if(i&&i.result&&i.data){for(var s in i.data){e[r[s]]["pic_type"]=2;e[r[s]]["pri_small_pic"]=i.data[s]["pri_small_pic"];e[r[s]]["pri_square_pic"]=i.data[s]["pri_square_pic"]}B.initEditLayer(e,t,n)}}});return}B.initEditLayer(e,t,n)}else{pop.alert("上传出错，请稍后重试")}return false};window.breakoutNew=function(){I=false;F=false;var e=X.getValue();location.href=A+_+"/albums/detail/album_id/"+e};B=new $;window.onbeforeunload=function(){if(I){return"您的照片还没有完成上传，确定离开吗？"}else if(F){return"离开将会丢失已选的所有相片，确定离开吗？"}};window.getUploadInfo=function(e,t){var n=i.E("event_ckb");F=e>0?true:false;I=t;X.setAvailable(!t);B.setAddAlbumBtnStatus(!t);if(t&&W&&z){n&&n.setAttribute("disabled",t);q["text"]=z.text}};window.getSaveTicket=function(e){B.getTicket(function(t){thisMovie("uploadid")&&thisMovie("uploadid")[e](t)})};window.saveUserAction=function(e){h({method:"post",url:A+"sina/upload_log",args:{step:e},onComplete:function(e){}})};l(i.E("nav_normal"));B.init()},A:function(e,t,n,r){e.exports=window.STK.getPKG("theia")},b:function(e,t,n,r){var i=n("A");var s=n("B");n("c");var o=function(){this._self=null;this._selected=null;this._list=null;this._selectArrow=null;this._activeOption=null;this._input=null;this._bodyinput=null;this._selectedIndex=0;this._adapter=null;this._locked=false;this._lockedEvent=null;this.maxHeight=400;this.callback=null};o.prototype={init:function(e,t,n){if(!e||!t)return;n=n||{};this._adapter=t;this.fn=n.fn;this.callback=n.callback;this._selectedIndex=n.selectedIndex||0;this._lockedEvent=n.lockedEvent;this.maxHeight=n.maxHeight||this.maxHeight;this._available=true;this.defaultText=n.defaultText||"";var r=this._self=i.C("div");this._self.className="m_smltSelect";var o=t[this._selectedIndex]?t[this._selectedIndex].id:"";if(this._selectedIndex==-1)o=this._selectedIndex;this._self.innerHTML='<div class="select"><span class="name M_txtb"></span><span class="chose_btn M_ico"></span></div>'+'<div class="items M_linkb" style="display:none"></div><input type="hidden" name="select" value="'+o+'"/>';this._selected=i.sizzle("span.name",r)[0];this._list=i.sizzle("div.items",r)[0];this._list.style.zIndex=n.zIndex||0;this._selectArrow=i.sizzle("span.M_ico",r)[0];this.create();e.appendChild(r);if(this._selectedIndex==-1)o=this._selectedIndex;this._input=i.sizzle("input[name=select]",r)[0];var u=this;i.addEvent(this._list,"click",function(e){var t=e.target||e.srcElement;var n=t.getAttribute("_index");while(!n&&(t=t.parentNode)){n=t.getAttribute("_index")}u.onSelected(n);i.preventDefault(e)});i.addEvent(this._selectArrow,"click",function(e){i.preventDefault(e);if(!u._available)return;if(!u._locked){if(u._list.style.display!="none"){s(u._list)}else{if(u._list.children.length){if(i.core.dom.getSize(u._list).height>u.maxHeight)u._list.style.height=u.maxHeight+"px";u._list.style.display=""}}}else{if(u._lockedEvent&&typeof u._lockedEvent==="function"){u._lockedEvent.call(u,ev)}}});i.addEvent(document,"click",function(e){var t=e.target||e.srcElement;if(u._selectArrow!==t&&!i.contains(u._self,t)){s(u._list)}})},create:function(){var e=this._adapter;this._locked=true;if(e&&e.length){var t=null,n,r="",i="",s="",o=false,u="",a=e.length;for(var f=0;f<a;f++){t=e[f];r=t.name;u=t.title||"";i="";if(this._selectedIndex==f){n=t;this._selected.innerHTML=r;if(typeof this.fn==="function"){this.fn.apply(this,[t])}}else{s+="<a ";if(t["disable"]){s+='class="M_linkf M_dis" '}else{this._locked=false}s+='href="#" title="'+u+'" _index="'+f+'">'+r+"</a>"}}this._list.innerHTML=s}else{}if(this._selectedIndex==-1){this._selected.setAttribute("title",this.defaultText);this._selected.innerHTML=this.defaultText}},onSelected:function(e){var t=this;e=parseInt(e,10);var n=this._adapter[e];if(!n||n.disable)return false;this._selectedIndex=e;this._input.value=n.id;this.create();s(this._list);if(t.callback)t.callback(n.id)},appendData:function(e,t){this._adapter.push(e);if(t)this._selectedIndex=this._adapter.length-1;this.onSelected(this._selectedIndex);this._locked=false},setAvailable:function(e){this._available=e;if(e){i.removeClassName(this._self,"M_dis")}else{i.addClassName(this._self,"M_dis")}},getValue:function(){return this._input.value}};e.exports=o},B:function(e,t,n,r){e.exports=function(e){if(!e||e.nodeType!==1){throw"/bp/dom/hide() need a element node as parameter"}e.style.display="none"}},c:function(e,t,n,r){String.prototype.trim=function(){var e=this.replace(/(^\s*)|(\s*$)/g,"");return e.replace(/(^　*)|(　*$)/g,"")};String.prototype.encodeHTML=function(){var e=document.createElement("div");e.appendChild(document.createTextNode(this));return e.innerHTML.replace(/\s/g,"&nbsp;").replace(/"/g,"&quot;")};String.prototype.getByteLength=function(){return this.replace(/[^\x00-\xff]/g,"rr").length};String.prototype.decodeHTML=function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&")};String.prototype.cutString=function(e,t,n){var r=this,t=t||"";if(!!n===false){r=this.decodeHTML();if(r.getByteLength()<=e)return r.encodeHTML();var i=Math.floor(e/2);for(var s=i,o=r.getByteLength();s<=o;s++){if(r.substr(0,s).getByteLength()>e){return(r.substr(0,s-1)+t).encodeHTML()}}return(r+t).encodeHTML()}else{if(r.getByteLength()<=e)return r;var i=Math.floor(e/2);for(var s=i,o=r.getByteLength();s<=o;s++){if(r.substr(0,s).getByteLength()>e){return r.substr(0,s-1)+t}}return r+t}};Object.keys||(Object.keys=function(e){var t=[];for(var n in e){t.push(n)}return t});String.prototype.hasDoubleByte=function(e){return e?/^[^\x00-\xff]+$/.test(this):/[^\x00-\xff]/.test(this)};String.prototype.getByteLength=function(){return this.hasDoubleByte()?this.replace(/[^\x00-\xff]/g,"**").length:this.length};String.prototype.sliceByte=function(e,t){var n=this.slice(0,e);if(n.hasDoubleByte()){var r=n.getByteLength();while(r>e){r-=n.charAt(n.length-1).getByteLength();n=n.slice(0,-1)}if(r<e&&t)n+=this.charAt(n.length)}return n};String.prototype.cutHtml=function(e,t,n){var r=arguments.length,i="",s=0,o=[],u=0;var a=/([\s\S]*?)(<\/?([a-zA-Z0-9]+)[^>]*>|$)/gi;var f=100,l=0,c=false;while(s<e&&a.exec(this)){l++;if(l>=f)break;var h=RegExp.$1,p=RegExp.$2,d=RegExp.$3,v=r>2?h.getByteLength():h.length;s+=v;if(p){if(p.indexOf("</")!==0){if(s>=e)p="</"+o.splice(o.length-1,1)+">";else o.push(d)}else if((u=o.lastIndexOf(d))>-1){o.splice(u,1)}}if(s>e){var m=r>2?h.sliceByte(e-s+v,n):h.slice(0,e-s+v);i+=m+t+p}else if(s==e)i+=h+t+p;else i+=h+p}var g=o.length;if(g){if($.msie&&/^(p|li|dt|dd|tr|th|td)$/i.test(o[g-1])&&!RegExp("</"+RegExp.$1+">$","i").test(i))i+="</"+o.splice(g-1,1)+">";o=o.filter(function(e){return!this.test(e)},$.msie?/^(abbr|br|col|img|input|link|meta|param|hr|area|embed|p|li|dt|dd|tr|th|td)$/i:/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i);if(o.length)i+="</"+o.reverse().join("></")+">"}return i}},C:function(e,t,n,r){var i=function(){function k(){if(w){return}try{var e=f.getElementsByTagName("body")[0].appendChild(z("span"));e.parentNode.removeChild(e)}catch(t){return}w=true;var n=h.length;for(var r=0;r<n;r++){h[r]()}}function L(e){if(w){e()}else{h[h.length]=e}}function A(t){if(typeof a.addEventListener!=e){a.addEventListener("load",t,false)}else if(typeof f.addEventListener!=e){f.addEventListener("load",t,false)}else if(typeof a.attachEvent!=e){W(a,"onload",t)}else if(typeof a.onload=="function"){var n=a.onload;a.onload=function(){n();t()}}else{a.onload=t}}function O(){if(c){M()}else{_()}}function M(){var n=f.getElementsByTagName("body")[0];var r=z(t);r.setAttribute("type",s);var i=n.appendChild(r);if(i){var o=0;(function(){if(typeof i.GetVariable!=e){var t=i.GetVariable("$version");if(t){t=t.split(" ")[1].split(",");N.pv=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)]}}else if(o<10){o++;setTimeout(arguments.callee,10);return}n.removeChild(r);i=null;_()})()}else{_()}}function _(){var t=p.length;if(t>0){for(var n=0;n<t;n++){var r=p[n].id;var i=p[n].callbackFn;var s={success:false,id:r};if(N.pv[0]>0){var o=U(r);if(o){if(X(p[n].swfVersion)&&!(N.wk&&N.wk<312)){$(r,true);if(i){s.success=true;s.ref=D(r);i(s)}}else if(p[n].expressInstall&&P()){var u={};u.data=p[n].expressInstall;u.width=o.getAttribute("width")||"0";u.height=o.getAttribute("height")||"0";if(o.getAttribute("class")){u.styleclass=o.getAttribute("class")}if(o.getAttribute("align")){u.align=o.getAttribute("align")}var a={};var f=o.getElementsByTagName("param");var l=f.length;for(var c=0;c<l;c++){if(f[c].getAttribute("name").toLowerCase()!="movie"){a[f[c].getAttribute("name")]=f[c].getAttribute("value")}}H(u,a,r,i)}else{B(o);if(i){i(s)}}}}else{$(r,true);if(i){var h=D(r);if(h&&typeof h.SetVariable!=e){s.success=true;s.ref=h}i(s)}}}}}function D(n){var r=null;var i=U(n);if(i&&i.nodeName=="OBJECT"){if(typeof i.SetVariable!=e){r=i}else{var s=i.getElementsByTagName(t)[0];if(s){r=s}}}return r}function P(){return!E&&X("6.0.65")&&(N.win||N.mac)&&!(N.wk&&N.wk<312)}function H(t,n,r,i){E=true;y=i||null;b={success:false,id:r};var s=U(r);if(s){if(s.nodeName=="OBJECT"){m=j(s);g=null}else{m=s;g=r}t.id=o;if(typeof t.width==e||!/%$/.test(t.width)&&parseInt(t.width,10)<310){t.width="310"}if(typeof t.height==e||!/%$/.test(t.height)&&parseInt(t.height,10)<137){t.height="137"}f.title=f.title.slice(0,47)+" - Flash Player Installation";var u=N.ie&&N.win?"ActiveX":"PlugIn",l="MMredirectURL="+encodeURI(a.location).toString().replace(/&/g,"%26")+"&MMplayerType="+u+"&MMdoctitle="+f.title;if(typeof n.flashvars!=e){n.flashvars+="&"+l}else{n.flashvars=l}if(N.ie&&N.win&&s.readyState!=4){var c=z("div");r+="SWFObjectNew";c.setAttribute("id",r);s.parentNode.insertBefore(c,s);s.style.display="none";(function(){if(s.readyState==4){s.parentNode.removeChild(s)}else{setTimeout(arguments.callee,10)}})()}F(t,n,r)}}function B(e){if(N.ie&&N.win&&e.readyState!=4){var t=z("div");e.parentNode.insertBefore(t,e);t.parentNode.replaceChild(j(e),t);e.style.display="none";(function(){if(e.readyState==4){e.parentNode.removeChild(e)}else{setTimeout(arguments.callee,10)}})()}else{e.parentNode.replaceChild(j(e),e)}}function j(e){var n=z("div");if(N.win&&N.ie){n.innerHTML=e.innerHTML}else{var r=e.getElementsByTagName(t)[0];if(r){var i=r.childNodes;if(i){var s=i.length;for(var o=0;o<s;o++){if(!(i[o].nodeType==1&&i[o].nodeName=="PARAM")&&!(i[o].nodeType==8)){n.appendChild(i[o].cloneNode(true))}}}}}return n}function F(n,r,i){var o,u=U(i);if(N.wk&&N.wk<312){return o}if(u){if(typeof n.id==e){n.id=i}if(N.ie&&N.win){var a="";for(var f in n){if(n[f]!=Object.prototype[f]){if(f.toLowerCase()=="data"){r.movie=n[f]}else if(f.toLowerCase()=="styleclass"){a+=' class="'+n[f]+'"'}else if(f.toLowerCase()!="classid"){a+=" "+f+'="'+n[f]+'"'}}}var l="";for(var c in r){if(r[c]!=Object.prototype[c]){l+='<param name="'+c+'" value="'+r[c]+'" />'}}u.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+l+"</object>";d[d.length]=n.id;o=U(n.id)}else{var h=z(t);h.setAttribute("type",s);for(var p in n){if(n[p]!=Object.prototype[p]){if(p.toLowerCase()=="styleclass"){h.setAttribute("class",n[p])}else if(p.toLowerCase()!="classid"){h.setAttribute(p,n[p])}}}for(var v in r){if(r[v]!=Object.prototype[v]&&v.toLowerCase()!="movie"){I(h,v,r[v])}}u.parentNode.replaceChild(h,u);o=h}}return o}function I(e,t,n){var r=z("param");r.setAttribute("name",t);r.setAttribute("value",n);e.appendChild(r)}function q(e){var t=U(e);if(t&&t.nodeName=="OBJECT"){if(N.ie&&N.win){t.style.display="none";(function(){if(t.readyState==4){R(e)}else{setTimeout(arguments.callee,10)}})()}else{t.parentNode.removeChild(t)}}}function R(e){var t=U(e);if(t){for(var n in t){if(typeof t[n]=="function"){t[n]=null}}t.parentNode.removeChild(t)}}function U(e){if(typeof e==="string"){return f.getElementById(e)}return e}function z(e){return f.createElement(e)}function W(e,t,n){e.attachEvent(t,n);v[v.length]=[e,t,n]}function X(e){var t=N.pv,n=e.split(".");n[0]=parseInt(n[0],10);n[1]=parseInt(n[1],10)||0;n[2]=parseInt(n[2],10)||0;return t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?true:false}function V(n,r,i,s){if(N.ie&&N.mac){return}var o=f.getElementsByTagName("head")[0];if(!o){return}var u=i&&typeof i=="string"?i:"screen";if(s){S=null;x=null}if(!S||x!=u){var a=z("style");a.setAttribute("type","text/css");a.setAttribute("media",u);S=o.appendChild(a);if(N.ie&&N.win&&typeof f.styleSheets!=e&&f.styleSheets.length>0){S=f.styleSheets[f.styleSheets.length-1]}x=u}if(N.ie&&N.win){if(S&&typeof S.addRule==t){S.addRule(n,r)}}else{if(S&&typeof f.createTextNode!=e){S.appendChild(f.createTextNode(n+" {"+r+"}"))}}}function $(e,t){if(!T){return}var n=t?"visible":"hidden";if(w&&U(e)){U(e).style.visibility=n}else{V("#"+e,"visibility:"+n)}}function J(t){var n=/[\\\"<>\.;]/;var r=n.exec(t)!=null;return r&&typeof encodeURIComponent!=e?encodeURIComponent(t):t}var e="undefined",t="object",n="Shockwave Flash",r="ShockwaveFlash.ShockwaveFlash",s="application/x-shockwave-flash",o="SWFObjectExprInst",u="onreadystatechange",a=window,f=document,l=navigator,c=false,h=[O],p=[],d=[],v=[],m,g,y,b,w=false,E=false,S,x,T=true,N=function(){var i=typeof f.getElementById!=e&&typeof f.getElementsByTagName!=e&&typeof f.createElement!=e,o=l.userAgent.toLowerCase(),u=l.platform.toLowerCase(),h=u?/win/.test(u):/win/.test(o),p=u?/mac/.test(u):/mac/.test(o),d=/webkit/.test(o)?parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,v=!+"1",m=[0,0,0],g=null;if(typeof l.plugins!=e&&typeof l.plugins[n]==t){g=l.plugins[n].description;if(g&&!(typeof l.mimeTypes!=e&&l.mimeTypes[s]&&!l.mimeTypes[s].enabledPlugin)){c=true;v=false;g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1");m[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10);m[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10);m[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof a.ActiveXObject!=e){try{var y=new ActiveXObject(r);if(y){g=y.GetVariable("$version");if(g){v=true;g=g.split(" ")[1].split(",");m=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}}}catch(b){}}return{w3:i,pv:m,wk:d,ie:v,win:h,mac:p}}(),C=function(){if(!N.w3){return}if(typeof f.readyState!=e&&f.readyState=="complete"||typeof f.readyState==e&&(f.getElementsByTagName("body")[0]||f.body)){k()}if(!w){if(typeof f.addEventListener!=e){f.addEventListener("DOMContentLoaded",k,false)}if(N.ie&&N.win){f.attachEvent(u,function(){if(f.readyState=="complete"){f.detachEvent(u,arguments.callee);k()}});if(a==top){(function(){if(w){return}try{f.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}k()})()}}if(N.wk){(function(){if(w){return}if(!/loaded|complete/.test(f.readyState)){setTimeout(arguments.callee,0);return}k()})()}A(k)}}();var K=function(){if(N.ie&&N.win){window.attachEvent("onunload",function(){var e=v.length;for(var t=0;t<e;t++){v[t][0].detachEvent(v[t][1],v[t][2])}var n=d.length;for(var r=0;r<n;r++){q(d[r])}for(var s in N){N[s]=null}N=null;for(var o in i){i[o]=null}i=null})}}();return{registerObject:function(e,t,n,r){if(N.w3&&e&&t){var i={};i.id=e;i.swfVersion=t;i.expressInstall=n;i.callbackFn=r;p[p.length]=i;$(e,false)}else if(r){r({success:false,id:e})}},getObjectById:function(e){if(N.w3){return D(e)}},embedSWF:function(n,r,i,s,o,u,a,f,l,c){var h={success:false,id:r};if(N.w3&&!(N.wk&&N.wk<312)&&n&&r&&i&&s&&o){$(r,false);L(function(){i+="";s+="";var p={};if(l&&typeof l===t){for(var d in l){p[d]=l[d]}}p.data=n;p.width=i;p.height=s;var v={};if(f&&typeof f===t){for(var m in f){v[m]=f[m]}}if(a&&typeof a===t){for(var g in a){if(typeof v.flashvars!=e){v.flashvars+="&"+g+"="+a[g]}else{v.flashvars=g+"="+a[g]}}}if(X(o)){var y=F(p,v,r);if(p.id==r){$(r,true)}h.success=true;h.ref=y}else if(u&&P()){p.data=u;H(p,v,r,c);return}else{$(r,true)}if(c){c(h)}})}else if(c){c(h)}},switchOffAutoHideShow:function(){T=false},ua:N,getFlashPlayerVersion:function(){return{major:N.pv[0],minor:N.pv[1],release:N.pv[2]}},hasFlashPlayerVersion:X,createSWF:function(e,t,n){if(N.w3){return F(e,t,n)}else{return undefined}},showExpressInstall:function(e,t,n,r){if(N.w3&&P()){H(e,t,n,r)}},removeSWF:function(e){if(N.w3){q(e)}},createCSS:function(e,t,n,r){if(N.w3){V(e,t,n,r)}},addDomLoadEvent:L,addLoadEvent:A,getQueryParamValue:function(e){var t=f.location.search||f.location.hash;if(t){if(/\?/.test(t)){t=t.split("?")[1]}if(e==null){return J(t)}var n=t.split("&");for(var r=0;r<n.length;r++){if(n[r].substring(0,n[r].indexOf("="))==e){return J(n[r].substring(n[r].indexOf("=")+1))}}}return""},expressInstallCallback:function(){if(E){var e=U(o);if(e&&m){e.parentNode.replaceChild(m,e);if(g){$(g,true);if(N.ie&&N.win){m.style.display="block"}}if(y){y(b)}}E=false}}}}();e.exports=i},d:function(e,t,n,r){var i="http://js.app.wcdn.cn/ops/photo/";var s="http://img.t.sinajs.cn/t4/appstyle/photo/";var o="http://img.app.wcdn.cn/ops/photo/style/";var u=$CONFIG.script_version;var a=$CONFIG.style_version;e.exports={baseURL:$CONFIG.base_url,baseIMG:s+"images/",baseCSS:s+"css/",baseSWF:"http://js.t.sinajs.cn/t5/album/static/swf/v5/",baseJS:i+"/js/v5/",base:o,imgVersion:a,jsVersion:u,cssVersion:a}},D:function(e,t,n,r){var i={isLogin:function(){var e=document.cookie+";";var t=["SUP","=([^;]*)?;"].join("");var n=["(\\?|&)","uid","=([^&]*)(&|$)"].join("");var r=e.match(new RegExp(t,"i"));r=r?r[1]||"":"";r=unescape(r);var i=r.match(new RegExp(n));i=i?i[2]||"":"";var s=$CONFIG.account_uid;if(i&&s==i)return true;return false}};e.exports=i},e:function(e,t,n,r){var i=function(e,t){var n,r=location.href,i=r.indexOf("#!");n=r.substring(i+3);if(n==="")return false;var s=n.split("/");for(var o=0,u=s.length;o<u;o++){if(decodeURIComponent(s[o])==e){if(t&&s[o+1])return decodeURIComponent(s[o+1]);return true}}return false};e.exports=i},E:function(e,t,n,r){function u(e){i.addClassName(o,"focus")}function a(e){i.removeClassName(o,"focus")}function f(e){var t=e;o=i.sizzle('[node-type="show_menu"]',t)[0];i.addEvent(o,"mouseover",u);i.addEvent(o,"mouseout",a);s.init(t);var n={};n.destroy=function(){};return n}var i=n("A");var s=n("f");var o;e.exports=f},f:function(e,t,n,r){var i=n("A");var s={inputEl:null,onsubmit:function(e){var t=i.trim(s.inputEl.value);if(t&&!i.hasClassName(s.inputEl,"M_txte"))location.href="/tags/search?tag="+encodeURIComponent(t);i.preventDefault(e)},onfocus:function(e){var t=e.target||e.srcElement;i.removeClassName(t,"M_txte");if(t.value==t.title)t.value=""},onblur:function(e){var t=e.target||e.srcElement;if(i.trim(t.value)===""){t.value=t.title;i.addClassName(t,"M_txte")}},init:function(e,t){var n=i.sizzle("form[name=searchForm]",e)[0];if(n){var r=this.inputEl=i.sizzle("input[node-type=search_input]",n)[0];var s=i.sizzle("a[node-type=search_btn]",n)[0];i.addEvent(r,"focus",this.onfocus);i.addEvent(r,"blur",this.onblur);i.addEvent(s,"click",this.onsubmit);n.onsubmit=this.onsubmit}}};e.exports=s},F:function(e,t,n,r){function d(e){if(!h[e]){h[e]="\\u"+("0000"+(+e.charCodeAt(0)).toString(16)).slice(-4)}return h[e]}function v(e){return'"'+e.replace(c,d)+'"'}function m(e,t,n){var r={},i=e.getAttribute(o)||e.getAttribute("id");if(i&&(t||!e.disabled)){switch(e.tagName){case"INPUT":var s=e.getAttribute("type");if(s==="radio"||s==="checkbox"){if(e.checked){r[o]=i;r[u]=e.value}else{r=false}}else if(s==="reset"||s==="submit"||s==="image"){r=false}else if(i){r[o]=i;if(n){r[u]=e.value.trim()==e.title?"":e.value.trim()}else{r[u]=e.value.trim()}}else{r=false}break;case"SELECT":if(e.multiple){var a=e.options;r[o]=i;r[u]=[];for(var f=0,l=a.length;f<l;f++){if(a[f].selected){r[u].push(a[f].value)}}}else{r[o]=i;r[u]=e.value}break;case"TEXTAREA":r[o]=i;if(n){r[u]=e.value.trim()==e.title?"":e.value.trim()}else{r[u]=e.value.trim()}break;case"BUTTON":default:r[o]=i;r[u]=e.value||e.getAttribute("value")||e.innerHTML||false;break}return r}return false}function g(e,t,n,r,a){t=t||["INPUT","TEXTAREA","BUTTON","SELECT"];if(typeof e==="string"){e=s.forms[e]}if(!e||e.nodeType!==1){return false}var f={},l=t.length>>0,c;while(l--){c=e.getElementsByTagName(t[l]);for(var h=0,p=c.length,d;h<p;h++){d=m(c[h],r,a);if(!d||n&&d[u]===""){continue}if(f[d[o]]||f[d[o]]==""){if(i.isArray(f[d[o]])){f[d[o]].push(d[u])}else{f[d[o]]=[f[d[o]]].concat(d[u])}}else{f[d[o]]=d.value}}}return f}function y(e){var t=[],n,r,i,s,o,u;switch(e.nodeType){case 1:i=e.tagName;t.push("<"+i);u=-1;s=e.attributes;while(o=s[++u]){t.push(" "+o.nodeName+'="'+o.nodeValue+'"')}if(e.hasChildNodes()){u=-1;s=e.childNodes;t.push(">");while(o=s[++u]){t.push(y(o))}t.push("</"+i+">")}else{if(l.test(i)){t.push(" />")}else{t.push("></"+i+">")}}break;case 3:t.push(e.nodeValue);break;case 4:t.push("<![CDATA["+e.data+"]]>");break;default:break}return t.join("")}function b(e){var t,n;try{if(window.DOMParser){n=new DOMParser;t=n.parseFromString(e,"text/xml")}else{t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}}catch(r){t=undefined}if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length){}return t}function w(e){function n(e,r){var i=e[r],s=typeof i,o=[],u=":",a=",",f="null",l,c,h,d,m;if(i&&typeof i==="object"&&typeof i.toJSON==="function"){i=i.toJSON(r)}if(i!==e[r]){s=typeof i}if(i===null)return f;switch(s){case"object":break;case"string":return v(i);case"number":return isFinite(i)?i+"":f;case"boolean":default:return String(i)}for(c=t.length-1;c>=0;--c){if(t[c]===i){throw new Error("JSON.stringify. Cyclical reference")}}l=p.call(i)==="[object Array]"||"length"in i&&i.slice;t.push(i);if(l){for(c=i.length-1;c>=0;--c){o[c]=n(i,c)||f}}else{h=i;c=0;for(d in h){if(h.hasOwnProperty(d)){m=n(i,d);if(m){o[c++]=v(d)+u+m}}}}t.pop();return l?"["+o.join(a)+"]":"{"+o.join(a)+"}"}var t=[];return n({"":e},"")}var i=n("A");n("c");var s=window.document,o="name",u="value",a=function(e,t,n){t=t===undefined?10:t;var r=arguments;if(r.length<4&&!n){return setTimeout(e,t)}r=r.length>3?Array["prototype"].slice.call(r,3):[];return setTimeout(function(){e.apply(n,r)},t)},f=window.clearTimeout,l=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i;var c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},p=Object.prototype.toString;var E=function(e){var t=e;t.focus();if(t.selectionStart){return t.selectionStart}if(s.selection){var n=s.selection.createRange();if(n==null){return t.value.length}var r=t.createTextRange();var i=r.duplicate();r.moveToBookmark(n.getBookmark());i.setEndPoint("EndToStart",r);return i.text.length}return t.value.length};var S=function(e,t){var n=e;n.focus();if(n.setSelectionRange){n.setSelectionRange(t,t)}else if(n.createTextRange){var r=n.createTextRange();r.collapse(true);r.moveEnd("character",t);r.moveStart("character",t);r.select()}};var x={getInputOffset:function(e,t){var n=this,r="{$clone_div}",i="{$cloneLeft}",o="{$cloneFocus}",u="{$cloneRight}",a='<span style="white-space:pre-wrap;"> </span>',f=e[r]||s.createElement("div"),l=e[i]||s.createElement("span"),c=e[o]||s.createElement("span"),h=e[u]||s.createElement("span"),p=n._offset(e),d=this._getFocus(e),v={left:0,top:0};if(!e[r]){e[r]=f;e[i]=l;e[o]=c;e[u]=h;f.appendChild(l);f.appendChild(c);f.appendChild(h);s.body.appendChild(f);c.innerHTML="|";c.style.cssText="display:inline-block;width:0px;overflow:hidden";f.className=this._cloneStyle(e);f.style.cssText="/*visibility:hidden;*/display:inline-block;position:absolute;z-index:-9999;left:0;top:0;visibility:hidden;word-wrap:break-word;word-break:break-all;overflow:hidden"}f.style.width=this._getStyle(e,"width");f.style.height=this._getStyle(e,"height");try{f.scrollLeft=e.scrollLeft;f.scrollTop=e.scrollTop}catch(m){}l.innerHTML=e.value.substring(0,d).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>").replace(/\s/g,a);h.innerHTML=e.value.substring(d,e.value.length).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>").replace(/\s/g,a);c.style.display="inline-block";try{v=this._offset(c)}catch(m){}c.style.display="none";return{left:p.left+v.left,top:p.top+v.top+(t?c.offsetHeight:0)}},_cloneStyle:function(e,t){if(!t&&e["${cloneName}"])return e["${cloneName}"];var n,r,i=/^(number|string)$/,s=/^(content|outline|outlineWidth)$/,o=[],u=e.style;for(r in u){if(!s.test(r)){val=this._getStyle(e,r);if(val!==""&&i.test(typeof val)){r=r.replace(/([A-Z])/g,"-$1").toLowerCase();o.push(r);o.push(":");o.push(val);o.push(";")}}}o=o.join("");e["${cloneName}"]=n="clone"+(new Date).getTime();this._addHeadStyle("."+n+"{"+o+"}");return n},_addHeadStyle:function(e){var t=this._style[s];if(!t){t=this._style[s]=s.createElement("style");s.getElementsByTagName("head")[0].appendChild(t)}t.styleSheet&&(t.styleSheet.cssText+=e)||t.appendChild(s.createTextNode(e))},_style:{},_getStyle:"getComputedStyle"in window?function(e,t){return getComputedStyle(e,null)[t]}:function(e,t){return e.currentStyle[t]},_addEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,false):e.attachEvent("on"+t,n)},_getFocus:function(e){var t=0;if(e.nodeName==="TEXTAREA"){if(s.selection){e.focus();var n=s.selection.createRange();var r=n.duplicate();r.moveToElementText(e);var t=-1;while(r.inRange(n)){r.moveStart("character");t++}}else if(e.selectionStart||e.selectionStart=="0"){t=e.selectionStart}var i=e.value.substring(0,t);var o=i.lastIndexOf("@");return o}else{if(s.selection){e.focus();var n=s.selection.createRange();n.moveStart("character",-e.value.length);t=n.text.length}else if(e.selectionStart||e.selectionStart=="0"){t=e.selectionStart}return t}},_offset:function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.body,i=n.documentElement,s=i.clientTop||r.clientTop||0,o=i.clientLeft||r.clientLeft||0,u=t.top+(self.pageYOffset||i.scrollTop)-s,a=t.left+(self.pageXOffset||i.scrollLeft)-o;return{left:a,top:u}}};e.exports={form2json:g,node2str:y,parseXML:b,stringify:w,textareaPosition:x,cookie:function(e,t,n,r){if(t===undefined){e+="=";t=s.cookie.split(";");for(var i=0,o=t.length;i<o;i++){for(r=t[i];r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0){return decodeURIComponent(r.substring(e.length,r.length))}}return null}else{var u="";if(n){u=new Date;u.setTime(u.getTime()+n*864e5);u="; expires="+u.toGMTString()}s.cookie=e+"="+t+u+"; path=/"+(r?";domain="+r:"")}},timer:function(e,t,n){var r=a(function i(){if(e.call(n)===true){r=a(i,t,this)}else{f(r);r=null}},t,n);return r}}},g:function(e,t,n,r){var i=n("A");var s=i.funcEmpty;e.exports=function(e){var t={};var n=[];var r=null;var o=false;var u=i.parseParam({url:"",method:"get",responseType:"json",args:{},timeout:30*1e3,onTraning:i.funcEmpty,isEncode:true},e);u.onComplete=function(t){o=false;if(typeof e.onComplete==="function"){e.onComplete(t,u.args)}};u.onFail=function(t){o=false;if(typeof e.onFail==="function"){try{s(u);e.onFail(t,u.args)}catch(n){}}};u.onTimeout=function(t){o=false;try{s(u);if(typeof e.onTimeout==="function"){e.onTimeout(t)}}catch(n){}};if(o&&u.needLock)return;o=true;i.ajax(u)}},G:function(e,t,n,r){function p(){if(h)h.style.display="none"}var i=n("A");var s=n("g");var o=$CONFIG["base_url"];var u=n("h");var a=n("H");var f=n("C");var l=n("I");var c={};var h=null;n("c");c.ShowFace=function(){function L(){A();y=new u({node:d,callback:j});b=new u({node:w,callback:P});B();M();var e=i.delegatedEvent(h);i.addEvent(document.body,"click",function(e){var n=e.target||e.srcElement;if(t!==n&&!i.contains(h,n)){p()}else{i.preventDefault(e)}});e.add("face_close","click",function(e){i.preventDefault(e.evt);p()});e.add("category","click",function(e){i.preventDefault(e.evt);var t=e.el.parentNode.children;for(var n=0,r=t.length;n<r;n++){i.removeClassName(t[n],"current")}i.addClassName(e.el,"current");i.core.dom.neighbor(e.el);var s=e.data["name"];if(s){if(s==E)return;E=s;q()}});i.addEvent(m,"click",function(e){if(v=="general")return;i.addClassName(m,"current");i.removeClassName(g,"current");f.style.display="block";z("general","face");i.preventDefault(e)});i.addEvent(g,"click",function(e){if(v=="magic")return;i.addClassName(g,"current");i.removeClassName(m,"current");f.style.display="none";n.innerHTML="";a.innerHTML='<li class="M_loading"></li>';z("magic","ani");i.preventDefault(e)});e.add("insert","click",function(e){var t=e.el;var n=e.data["text"];if(n&&r){N.insertText(n,k);k.start+=n.length;N.setCursor(k)}h.style.display="none"});e.add("play","click",function(e){var t=e.data["url"];c.PopUpSwfPlayer(t)})}function A(){var e='<div class="bg">                                <table border="0" cellspacing="0" cellpadding="0">                                        <tbody><tr>                                            <td>                                                <div class="content">                                                    <a href="#" class="close" action-type="face_close"></a>                                                    <div class="m_tab M_txtb">                                                      <p class="M_txtb"><a href="#" class="current" node-type="general">常用表情</a><em class="M_vline"></em><a href="#" node-type="magic"><span class="M_ico ico_magic"></span>魔法表情</a></p>                                                    </div>                                                    <div class="L_faces">                                                        <p class="tab_kind M_linka">                                                            <span class="right" node-type="tabPage"></span>                                                            <em node-type="categorys"></em>                                                        </p>                                                        <div class="detail">                                                            <ul class="faces_list faces_list_hot clearfix" node-type="hotFace"></ul>                                                            <ul class="faces_list clearfix" node-type="inner"><li class="M_loading"></li></ul>                                                            <div class="m_pages_minibtn M_linke" node-type="page"></div>                                                        </div>                                                    </div>                                                </div>                                            </td>                                        </tr>                                </tbody></table>                                <div class="arrow arrow_t" node-type="arrow"></div>                            </div>';h=i.C("div");h.innerHTML=e;h.className="L_layer";var t=i.builder(h).list;h.style.zIndex=C;n=t["categorys"][0];a=t["inner"][0];f=t["hotFace"][0];d=t["page"][0];w=t["tabPage"][0];m=t["general"][0];g=t["magic"][0];document.body.appendChild(h)}function O(e,t){s({method:"get",url:o+"sina/get_faces",args:{type:e},onComplete:function(e){if(t&&typeof t==="function"){t.apply(this,arguments)}}})}function M(){b.initUI=function(){var e=[];if(this.pageIndex>1){e.push('<a href="#" action-type="pageTo" action-data="page=prev" class="pre"></a>')}else{e.push('<a href="#" class="pre_d"></a>')}if(this.pageCount>1&&this.pageIndex<this.pageCount){e.push('<a href="#" action-type="pageTo" action-data="page=next" class="next"></a>')}else{e.push('<a href="#" class="next_d"></a>')}this.ui.innerHTML=e.join("")};b.init=function(e,t){this.pageIndex=1;this.pageSize=t;this.total=e;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1}}function _(e){var t=[];t=Object.keys(e);t.unshift("默认");return t}function D(){var t,n=[],r,i;if(e["general"]&&e["general"]["usual"]["hot"]){i=e["general"]["usual"]["hot"];for(var s=0,o=i.length;s<o&&s<12;s++){t=i[s];r=t.phrase.replace(/\[([^\]]+)\]/,"$1");n.push('<li action-type="insert" action-data="text='+t.value+'"><img title="'+r+'" alt="'+r+'" src="'+t.url+'"></li>')}}f.innerHTML=n.join("")}function P(e){var t=[],r;for(var i=e.start;i<=e.end;i++){r=x[i];t.push("<a "+(E==r?'class="current"':"")+' action-type="category" action-data="name='+r+'" href="#">'+r+"</a>");t.push('<em class="M_vline"></em>')}t.pop();n.innerHTML=t.join("")}function H(){x=_(v!=="magic"?e["general"]["more"]:e["magic"]["more"]);b.init(x.length,5);b.initUI();P(b.getDataRange())}function B(){y.initUI=function(){var e=[],t=this.pageIndex;if(this.pageCount>1){if(t!==1){e.push('<a class="reverse" action-type="pageTo" action-data="page=prev" href="#"></a>')}var n=this.pageCount;var r=1;r=r>this.pageCount?this.pageCount:r;for(var i=r;i<=n;i++){if(i!==t){e.push('<a href="#" action-type="pageTo" action-data="page='+i+'">'+i+"</a>")}else{e.push('<a href="#" class="current">'+i+"</a>")}}if(t!==this.pageCount){e.push('<a class="next" action-type="pageTo" action-data="page=next" href="#"></a>')}}this.ui.innerHTML=e.join("")};y.init=function(e,t){this.pageSize=t;this.total=e;this.pageIndex=1;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1}}function j(e){if(v!=="magic"){F(e)}else{I(e)}U()}function F(e){var t,n=[],r;if(S){for(var s=e.start,o=e.end;s<=o;s++){t=S[s];r=t.phrase.replace(/\[([^\]]+)\]/,"$1");n.push('<li action-type="insert" action-data="text='+t.value+'"><img title="'+r+'" alt="'+r+'" src="'+t.url+'"></li>')}}i.addClassName(a,"faces_list");i.removeClassName(a,"faces_magic_list");a.innerHTML=n.join("")}function I(e){var t,n=[],r;if(S){for(var s=e.start,o=e.end;s<=o;s++){t=S[s];r=t.phrase.replace(/\[([^\]]+)\]/,"$1");n.push('<li><a href="#" action-type="insert" action-data="text='+t.value+' " class="img"><img src="'+t.url+'" title="'+r+'" alt="'+r+'" /></a><a href="#" action-type="play" action-data="url='+t.swf+'" class="M_ico play" title="表情预览"></a><span>'+r+"</span></li>")}}i.addClassName(a,"faces_magic_list");i.removeClassName(a,"faces_list");a.innerHTML=n.join("")}function q(){var t=72,n;if(v!=="magic"){if(E!=="默认"){S=e["general"]["more"][E];f.style.display="none"}else{S=e["general"]["usual"]["norm"];f.style.display=""}}else{S=E!=="默认"?e["magic"]["more"][E]:e["magic"]["usual"]["norm"];t=12}y.init(S.length,t);y.initUI();n=y.getDataRange();j(n)}function R(){if(T){i.sizzle("div[node-type=arrow]")[0].className="arrow arrow_b"}h.style.display="block";document.body.appendChild(h)}function U(){var e=-30,n=5,r,s;if(t){var o=i.position(t);var u=i.core.dom.getSize(t).height;if(T){var a=i.core.dom.getSize(h).height;r=o.t-a-n;s=o.l+e}else{r=o.t+u;s=o.l+e}h.style.top=r+"px";h.style.left=s+"px"}}function z(t,n){v=t;E="默认";if(!e[t]){O(n,function(n){if(n&&n.data){e[t]=n.data;D();H();q()}})}else{H();q()}}var e={};var t=null;var n=null;var r=null;var a=null;var f=null;var d=null;var v="general";var m=null;var g=null;var y=null;var b=null;var w=null;var E="默认";var S=null;var x=null;var T=false;var N=null;var C=1000100;var k;return function(e,n,s,o){t=e||t;T=s||T;C=o||C;r=n||r;N=l(r);k=N.getCursor();if(!h)L();i.addClassName(m,"current");i.removeClassName(g,"current");z("general","face");R()}}();c.hide=function(){p()};c.popLay=function(){return h};c.PopUpSwfPlayer=function(){var e,t,n=360,r=440;return function(s){var o="view_ani",u,l=window,c=document,h=c.documentElement||{},p=c.body;if(!f.hasFlashPlayerVersion("9.0.0")){return}if(!e){e=i.C("div");e.style.position="absolute";e.style.zIndex=_zIndex;document.body.appendChild(e)}e.innerHTML='<div id="'+o+'"></div>';var d=function(){var t="fixed",s=(i.winSize().height-n)/2,o=(i.winSize().width-r)/2;if(i.core.util.browser.IE6){s+=i.scrollPos(document).top;o+=i.scrollPos(document).left;t="absolute"}s=s>0?s:0;o=o>0?o:0;e.style.position=t;e.style.top=s+"px";e.style.left=o+"px"};a.show();d();var v={id:"view_ani",quality:"high",allowScriptAccess:"never",wmode:"transparent",allowFullscreen:true,allownetworking:"internal"};var m={playMovie:"true"};var g=function(e){if(e&&e.keyCode!==27&&(e.type!=="mouseup"||u&&u==e.target)){return}clearInterval(t);f.removeSWF(o);a.hide();i.removeEvent(document.body,"mouseup",g);i.removeEvent(document.body,"keyup",g);if(!e){return}i.preventDefault(e)};f.embedSWF(s,o,r,n,"10.0.0",null,m,v);a.show();l.clearInterval(t);i.addEvent(document.body,"mouseup",g);i.addEvent(document.body,"keyup",g);t=setInterval(function(){var e=0;u=f.getObjectById(o);if(u&&u.PercentLoaded()==100){l.clearInterval(t);t=setInterval(function(){var t=u.CurrentFrame(),n;try{n=u.TotalFrames()}catch(r){n=u.TotalFrames}if(t<0){return}if(t<n&&e<=t){e=t}else{g()}},80)}},100)}}();e.exports=c},h:function(e,t,n,r){var i=n("A");var s=function(e){var t=this;var n=i.C("div");n.className="m_pages";this.total=e.total||0;this.pageSize=e.pageSize||2;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1;this.updateCount=function(){t.pageCount=t.total%t.pageSize===0?~~(t.total/t.pageSize):~~(t.total/t.pageSize)+1};this.pageIndex=e.pageIndex||1;this.maxShowNum=e.maxShowNum==undefined?10:e.maxShowNum;this.leftcallback=e.leftcallback||function(){};this.rightcallback=e.rightcallback||function(){};this.ui=e.node||n;this.callback=e.callback||function(){};this.scope=e.scope||this;this.uiMode=1;var r=i.delegatedEvent(this.ui);this.getDataRange=function(e){e=e||this.pageIndex;if(e>=1&&e<=this.pageCount){var t=this.pageSize*(e-1),n=t+this.pageSize-1;n=n>this.total-1?this.total-1:n;this.pageIndex=e;return{start:t,end:n,page:e}}};this.updateUI=function(e,t,n){this.total=e;this.pageIndex=t||this.pageIndex;this.pageSize=n||this.pageSize;this.pageCount=this.total%this.pageSize===0?~~(this.total/this.pageSize):~~(this.total/this.pageSize)+1;if(this.pageCount>1){if(this.uiMode==1){this.initUI(true)}else if(this.uiMode==2){this.initUI2()}else if(this.uiMode==3){this.initUI3()}}else{this.ui.innerHTML=""}};this.initUI=function(e){var t=[],n=this,s=parseInt(this.pageIndex,10);this.uiMode=1;if(this.pageCount>1){if(s!==1){t.push('<a href="#" action-type="pageTo" action-data="page=prev" class="M_btn_c pre">上一页</a>')}t.push('<div class="list" action-type="page_list">');t.push('<div class="its" style="display:none">');var o=parseInt(this.maxShowNum/2,10);var u=this.pageIndex+o<=this.maxShowNum?1:this.pageIndex-this.maxShowNum+o;u=u>0?u:1;var a=u+this.maxShowNum-1;a=a>this.pageCount?this.pageCount:a;for(var f=a;f>=u;f--){if(f!==s){t.push('<a href="#" action-type="pageTo" action-data="page='+f+'">第 '+f+" 页</a>")}else{t.push('<a href="#" class="current">第 '+f+" 页</a>")}}t.push("</div>");if(parseInt(this.maxShowNum,10)===0){t.push('<span class="t">第 '+s+" 页</span>")}else{t.push('<a class="M_linke" href="#"><span class="t">第 '+s+' 页</span><span class="M_ico M_icon31"></span></a>')}t.push("</div>");if(s!==this.pageCount){t.push('<a class="M_btn_c next" action-type="pageTo" action-data="page=next" href="#">下一页</a>')}t.push("</div>")}this.ui.innerHTML=t.join("");if(!e){var l,c=null,h=null;r.add("page_list","mouseover",function(e){if(n.maxShowNum>0){if(c)window.clearTimeout(c);if(h)window.clearTimeout(h);h=setTimeout(function(){l=i.sizzle(".its",e.el)[0];if(l)l.style.display="block"},500)}});r.add("page_list","mouseout",function(e){if(n.maxShowNum>0){l=i.sizzle(".its",e.el)[0];if(h)window.clearTimeout(h);c=window.setTimeout(function(){if(l)l.style.display="none"},500)}})}};this.initUI2=function(e){var t=[],n=this.pageIndex;this.uiMode=2;if(this.pageCount>1){if(n!==1){t.push('<a class="M_btn_c" href="#" action-type="pageTo" action-data="page=prev">上一页</a>')}var r=parseInt(this.maxShowNum/2,10);var i=this.pageIndex+r<=this.maxShowNum?1:this.pageIndex-this.maxShowNum+r;var s=i+this.maxShowNum-1;s=s>this.pageCount?this.pageCount:s;i=i>0?i:1;if(i>2){t.push('<a href="#" action-type="pageTo" action-data="page=1">1</a>');t.push('<span class="doccolor">...</span>')}for(var o=i;o<=s;o++){if(o!==n){t.push('<a href="#" action-type="pageTo" action-data="page='+o+'">'+o+"</a>")}else{t.push('<a href="#" class="current">'+o+"</a>")}}if(s<this.pageCount-1){t.push('<span class="doccolor">...</span>');t.push('<a href="#" action-type="pageTo" action-data="page'+this.pageCount+'">'+this.pageCount+"</a>")}if(n!==this.pageCount){t.push('<a class="M_btn_c" action-type="pageTo" action-data="page=next" href="#">下一页</a>')}}this.ui.innerHTML=t.join("")};this.initUI3=function(){var e=[],t=this.pageIndex;this.uiMode=3;if(this.pageCount>1){if(t!==1){e.push('<a class="M_btn_c" href="#" action-type="pageTo" action-data="page=prev">上一页</a>')}if(this.pageCount>1){e.push('<a href="#" class="current" action-type="pageTo" action-data="page='+t+'">'+t+"</a>")}if(t!==this.pageCount){e.push('<a class="M_btn_c" action-type="pageTo" action-data="page=next" href="#">下一页</a>')}}this.ui.innerHTML=e.join("")};this.gotoPage=function(e){var t=this;switch(e){case"prev":if(t.pageIndex-1>=1){t.pageIndex--}if(t.leftcallback&&typeof t.leftcallback==="function"){t.leftcallback.apply(t.scope,[t.pageIndex-1])}break;case"next":if(t.pageIndex+1<=t.pageCount){t.pageIndex++}if(t.rightcallback&&typeof t.rightcallback==="function"){t.rightcallback.apply(t.scope,[t.pageIndex-1])}break;default:e=parseInt(e,10)||parseInt(e.match(/\d{1,}/)[0],10);if(e===t.pageIndex){return}t.pageIndex=e;break}if(t.uiMode==1){t.initUI(true)}else if(t.uiMode==2){t.initUI2()}else if(t.uiMode==3){t.initUI3()}};this.init=function(){r.add("pageTo","click",function(e){var n=e.data["page"];window.setTimeout(function(){t.gotoPage(n);if(t.callback&&typeof t.callback==="function"){t.callback.apply(t.scope,[t.getDataRange()])}},0);i.preventDefault(e.evt)})};this.init();this.destroy=function(){r.destroy();i.removeNode(this.ui)}};e.exports=s},H:function(e,t,n,r){function d(){o=i.C("div");var e='<div node-type="outer">';if(i.core.util.browser.IE6){e+='<div style="position:absolute;width:100%;height:100%;"></div>'}e+="</div>";o=i.builder(e).list["outer"][0];document.body.appendChild(o);f=true;a=s(o,"lt");var t=function(){var e=i.core.util.winSize();o.style.cssText=i.core.dom.cssText(o.style.cssText).push("width",e.width+"px").push("height",e.height+"px").getCss()};p.add(a,"beforeFix",t);t()}function v(e){var t;if(!(t=e.getAttribute(l))){e.setAttribute(l,t=i.getUniqueKey())}return">"+e.tagName.toLowerCase()+"["+l+'="'+t+'"]'}var i=n("A");var s=n("i");var o,u=[],a,f=false,l="STK-Mask-Key";var c=i.core.dom.setStyle,h=i.core.dom.getStyle,p=i.core.evt.custEvent;var m={getNode:function(){return o},show:function(e,t){if(f){e=i.core.obj.parseParam({opacity:.3,background:"#000000"},e);o.style.background=e.background;c(o,"opacity",e.opacity);o.style.display="";a.setAlign("lt");t&&t()}else{d();m.show(e,t)}return m},hide:function(){o.style.display="none";u=[];return m},showUnderNode:function(e,t){if(i.isNode(e)){m.show(t,function(){c(o,"zIndex",h(e,"zIndex"));var t=v(e);var n=i.core.arr.indexOf(u,t);if(n!=-1){u.splice(n,1)}u.push(t);i.core.dom.insertElement(e,o,"beforebegin")})}return m},back:function(){if(u.length<1){return m}var e,t;u.pop();if(u.length<1){m.hide()}else if((t=u[u.length-1])&&(e=i.sizzle(t,document.body)[0])){c(o,"zIndex",h(e,"zIndex"));i.core.dom.insertElement(e,o,"beforebegin")}else{m.back()}return m},resetSize:function(){var e=i.core.util.winSize();o.style.cssText=i.core.dom.cssText(o.style.cssText).push("width",e.width+"px").push("height",e.height+22+"px").getCss();return m},destroy:function(){p.remove(a);o.style.display="none"}};e.exports=m},i:function(e,t,n,r){function u(e){return i.core.dom.getStyle(e,"display")!="none"}function a(e){e=i.core.arr.isArray(e)?e:[0,0];for(var t=0;t<2;t++){if(typeof e[t]!="number")e[t]=0}return e}function f(e,t,n){if(!u(e))return;var r="fixed",o,a,f,l,c=e.offsetWidth,h=e.offsetHeight,p=i.core.util.winSize(),d=0,v=0,m=i.core.dom.cssText(e.style.cssText);if(!s){r="absolute";var g=i.core.util.scrollPos();d=o=g.top;v=a=g.left;switch(t){case"lt":o+=n[1];a+=n[0];break;case"lb":o+=p.height-h-n[1];a+=n[0];break;case"rt":o+=n[1];a+=p.width-c-n[0];break;case"rb":o+=p.height-h-n[1];a+=p.width-c-n[0];break;case"c":default:o+=(p.height-h)/2+n[1];a+=(p.width-c)/2+n[0];break}f=l=""}else{o=l=n[1];a=f=n[0];switch(t){case"lt":l=f="";break;case"lb":o=f="";break;case"rt":a=l="";break;case"rb":o=a="";break;case"c":default:o=(p.height-h)/2+n[1];a=(p.width-c)/2+n[0];l=f="";break}}if(t=="c"){if(o<d)o=d;if(a<v)a=v}m.push("position",r).push("top",o+"px").push("left",a+"px").push("right",f+"px").push("bottom",l+"px");e.style.cssText=m.getCss()}var i=n("A");var s=!(i.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),o=/^(c)|(lt)|(lb)|(rt)|(rb)$/;e.exports=function(e,t,n){var r,u,l=true,c;if(i.core.dom.isNode(e)&&o.test(t)){var h={getNode:function(){return e},isFixed:function(){return l},setFixed:function(t){(l=!!t)&&f(e,r,u);return this},setAlign:function(t,n){if(o.test(t)){r=t;u=a(n);l&&f(e,r,u)}return this},destroy:function(){if(!s){s&&i.core.evt.removeEvent(window,"scroll",p)}i.core.evt.removeEvent(window,"resize",p);i.core.evt.custEvent.undefine(c)}};c=i.core.evt.custEvent.define(h,"beforeFix");h.setAlign(t,n);function p(t){t=t||window.event;i.core.evt.custEvent.fire(c,"beforeFix",t.type);if(l&&(!s||r=="c")){f(e,r,u)}}if(!s){i.core.evt.addEvent(window,"scroll",p)}i.core.evt.addEvent(window,"resize",p);return h}}},I:function(e,t,n,r){var i=n("A");e.exports=function(e,t){var n,r;n={};r=i.parseParam({},t);var s=function(t){return i.core.dom.selectText(e,t)};var o=function(){e["__areaQuery"]=i.jsonToQuery(i.core.dom.textSelectArea(e))};var u=function(){e["__areaQuery"]=false};i.addEvent(e,"beforedeactivate",o);i.addEvent(e,"active",u);var a=function(){var t=null;try{t=i.core.dom.textSelectArea(e)}catch(n){t=i.queryToJson(e["__areaQuery"])}if(t.start===0&&t.len===0&&e["__areaQuery"]){t=i.queryToJson(e["__areaQuery"])}t.start=parseInt(t.start,10);t.len=parseInt(t.len,10);return t};var f=function(t,n){var r=e.value;var i=n.start;var s=n.len||0;var o=r.slice(0,i);var u=r.slice(i+s,r.length);e.value=o+t+u;r=null;o=null;u=null;i=null;s=null};n.setCursor=function(e){s(e)};n.getCursor=function(){return a()};n.insertCursor=function(e){var t=a();f(e,t);t.len=e.length;s(t)};n.TempletCursor=function(t){var n,r,o;n=a();if(n.len>0){r=e.value.substr(n.start,n.len)}else{r=""}o=i.templet(t,{origin:r});f(o,n);n.start=n.start+t.indexOf("#{origin");n.len=o.length-t.replace(/#\{[origin].+?\}/,"").length;s(n)};n.insertText=f;n.destroy=function(){i.removeEvent(e,"beforedeactivate",o);i.removeEvent(e,"active",u);e=null};return n}},j:function(e,t,n,r){e.exports={10001:"保存成功",10002:"分享成功",10003:"封面设置成功",10004:"头像设置成功",10005:"复制链接成功",10006:"关注成功",10007:"确定",10008:"取消",10009:"创建",10010:"操作失败，请重试",10011:"请选择一个你的好友",10012:"数据已经被删除或无权访问",10013:"复制连接地址成功",10014:"头像设置成功",10015:"头像设置失败",10016:"分享内容不能为空",10017:"操作成功",10018:"取消成功",11001:"创建成功",11002:"确定删除该专辑吗？",11003:"删除专辑成功",11004:"新建专辑",11005:"编辑专辑",11006:"删除专辑失败",11007:"该专辑已满",11008:"封面设置成功",11009:"封面设置失败",11010:"新建会员专辑",11011:"新建收费专辑",12001:"确定删除该照片吗？",12002:"删除照片成功",12003:"移动照片成功",12004:"排序已更改，是否保存？",12005:"删除照片失败",12006:"移动照片成功",12007:"移动照片失败",12008:"排序保存成功",12009:"排序保存失败",12010:"确定将照片移动到此专辑？",12011:"照片还未完全载入",12012:"高宽小于100px的图片不能进行圈人操作",12013:"此照片为私密微博图片",12014:"旋转保存失败",12015:"照片不存在或无权查看",12016:"请先关闭圈人再旋转照片",12017:"此操作将同时删除该条微博以及它包含的所有图片，确定删除？",12018:"此照片为密友可见图片",12019:"确定要移除该照片吗？",12020:"移除照片成功",12021:"移除照片失败",13001:"赞图成功",13002:"取消赞成功",13003:"确定取消赞吗？",13004:"取消赞失败",13005:"赞失败",13006:"获取喜欢列表失败",14001:"收藏成功",14002:"取消收藏成功",14003:"确定取消收藏吗？",14004:"取消收藏",14005:"收藏专辑",14006:"收藏照片",14007:"收藏失败",14008:"取消收藏失败",15001:"评论成功",15002:"删除评论成功",15003:"休息一下，相同内容的微博发一条就够啦",16001:"圈人成功",16002:"删除圈人成功",16003:"圈人失败",17001:"存在重复的标签",17002:"请输入标签",18001:"您选择的文件格式有错误",18002:"上传失败",18003:"请选择图片",18004:"未上传图片",18005:"上传照片不可大于20M"}},J:function(e,t,n,r){function d(e,t,n,r){this.eventId=e;this.albumdata=t;this.checkbox=n;this.data=null;this.config=r||{}}var i=n("A");var s=n("g");var o=n("k");var u=n("d");var a=n("n");var f=n("N");var l=n("B");var c=n("o");window.onerror=function(e){if(e==="TypeError: non-native scope object")return true};var h=u.baseURL,p=u.baseIMG;d.prototype={get:function(){return this.data},set:function(e){this.data=e;if(i.getType(this.config.callback)=="function"){this.config.callback(!!e)}},cancel:function(){if(this.checkbox)this.checkbox.checked=false;this.set(null)},init:function(){var e=d.map[this.eventId];if(d[e]){d[e].parent=this;d[e].initUI(e)}else{throw"该活动不并存在，或还未注册"}}};d.snowbeer={initUI:function(e){var t=this.parent.get();this.pop()},getProvinces:function(){var e=[],t=a.provinces.split(","),n=a.provcodes.split(",");for(var r=0;r<t.length;r++){if(t[r]!="海外"&&t[r]!="其他"){e.push({name:t[r],code:n[r]})}}return e}(),hasCreateAlbum:function(e){for(var t=0;t<e.length;t++){if(e[t].caption=="2014年雪花纯生古建筑摄影"){if(i.getType(this.parent.config.onCreateNewAlbum)==="function"){this.parent.config.onCreateNewAlbum(false,t)}return false}}return true},pop:function(){var e=this,t=e.parent.config.data,n=e.hasCreateAlbum(e.parent.albumdata),r=c({name:$GLOBAL_INFO.account_data.name,mainPic:"http://ww3.sinaimg.cn/mw690/74f67c55jw1ec6c3rh3slj205a05aq30.jpg",createAlbum:n,provinces:e.getProvinces,info:t.info,tip:["拍摄范围为西安、洛阳、南京、安阳、开封、商丘、北京、大同、郑州、杭州等中国历代古都。","拍摄范围包括古代宫殿、陵墓、坛庙、宗教、园林、住宅等所有中国古建筑题材。"]});var s=e.layer=o(r,{title:"2014年雪花纯生古建筑摄影",cancelCallback:function(){e.parent.cancel()}});s.setMiddle().show();var u=e.domList=s.getDomList(true);var a=u["desc"];i.addEvent(a,"focus",function(){if(i.trim(a.value)===a.title){a.value=""}});i.addEvent(a,"blur",function(){if(i.trim(a.value)===""){a.value=a.title}});var h=false,p=u["provinces_choose"];s.addEvent("select_local","click",function(){if(!h){f(p);h=true}else{l(p);h=false}});i.addEvent(p,"click",function(e){i.preventDefault();var t=e||window.event;var n=t.target||t.srcElement;if(n.tagName==="A"){if(h){var r=n.getAttribute("data-code");var s=n.title;var o=u["select_result"];o.innerHTML=s;o.setAttribute("data-code",r);o.setAttribute("data-name",s);l(p);h=false}}});s.addEvent("submit","click",function(t){i.preventDefault();e.submit(t.evt)})},hideMsg:function(){var e=this.domList;var t=e["check_description"];l(e["check_local"]);l(e["check_part"]);if(t){l(t)}},checkVal:function(){var e=this,t=e.getVal(),n=e.domList;e.hideMsg();if(!t.option.event_id){f(n["check_part"]);return false}if(!t.option.province){f(n["check_local"]);return false}if(t.hasOwnProperty("createAlbumData")){var r=t.createAlbumData.description||"";if(i.bLength(r)>280){n["msg"].innerHTML="描述不能多于140个字";f(n["check_description"]);return false}}e.hideMsg();return true},getVal:function(){var e=this,t=e.domList,n=e.layer.getBox();if(n){var r=t["select_result"],s=t["part"],o,u;if(s.length){for(var a=0,f=s.length;a<f;a++){var l=s[a];if(l.checked){o=l.value;u=l.getAttribute("data-name");break}}}else{o=s.checked?s.value:"";u=s.getAttribute("data-name")}var c=r.getAttribute("data-name"),h=r.getAttribute("data-code"),p=e.hasCreateAlbum(e.parent.albumdata),d={};d.option={event_id:o,province:c};d.tags=c+","+u;d.wm=4;if(p){d["createAlbumData"]={caption:i.trim(t["caption"].value),description:i.trim(t["desc"].value),property:1,album_id:"",answer:"",question:""}}return d}return null},createAlbum:function(e,t){s({url:h+"albums/create",method:"post",args:e,onComplete:function(e){if(i.getType(t)==="function")t.call(this,e.data)}})},save:function(e){this.parent.set(e);this.layer.hide()},submit:function(e){var t=this;if(t.checkVal()){var n=t.getVal();if(n.hasOwnProperty("createAlbumData")){t.createAlbum(n.createAlbumData,function(e){delete n["createAlbumData"];if(i.getType(t.parent.config.onCreateNewAlbum)==="function"){t.parent.config.onCreateNewAlbum(true,e)}t.save(n)})}else{delete n["createAlbumData"];var n=t.getVal();t.save(n)}}}};d.map={34:"snowbeer",35:"snowbeer",11:"creativeImaging"};e.exports=d},k:function(e,t,n,r){var i=n("A");var s=n("K");var o=n("M");e.exports=function(e,t){var n={};var r,u,a,f,l,c;var h=10003;var p;var d;var v={box:'<div class="L_layer" node-type="outer" style="position:absolute;clear:both;display:none;">'+'<div node-type="inner" class="bg">'+'<table border="0" cellpadding="0" cellspacing="0">'+"<tbody><tr><td>"+'<div class="content" node-type="content"></div>'+"</td></tr></tbody>"+"</table>"+"</div>"+"</div>"};var m={ok:function(e){i.stopEvent(e.evt);if(i.getType(t.okCallback)=="function"&&t.okCallback(e)==false){return}n.hide()},cancel:function(e){i.stopEvent(e.evt);if(i.getType(t.cancelCallback)=="function"){t.cancelCallback(e)}n.hide()}};var g={init:function(){g.pars();g.build();g.bind()},pars:function(){t=i.parseParam({okCallback:i.funcEmpty,cancelCallback:i.funcEmpty,showCallback:i.funcEmpty,hideCallback:i.funcEmpty,draggable:true,mask:true},t||{})},build:function(){var n=i.builder(v.box).list;a=n.outer[0];r=s(a);f=n.inner[0];content=n.content[0];content.innerHTML=e||"";u=r.getDomList(true);l=u.title;if(t.mask){r.setMask()}c=i.objSup(r,["destroy"])},bind:function(){d=i.delegatedEvent(a);d.add("ok","click",m.ok);d.add("cancel","click",m.cancel);if(l&&t.draggable){o(l,{actObj:r,moveDom:a})}i.custEvent.add(r,"hide",function(){i.custEvent.remove(r,"hide",arguments.callee);n.destroy();o.destroy()})}};g.init();n=r;n.layer_size=r.getSize();n.setContent=function(e){if(typeof e=="string"){content.innerHTML=e}else{content.appendChild(e)}return n};n.setLayerXY=function(e){if(!e){i.log("ui.tip.setLayerXY need element as pNode")}var t=i.position(e);var s=t.l;var o=e.offsetWidth;var u=e.offsetHeight;var a=n.layer_size.w;var f=Math.min(Math.max(s+(o-a)/2,i.scrollPos().left),i.scrollPos().left+STK.winSize().width-a);var l=t.t+u;var c=[";"];c.push("height:",n.tipHeight,"px;");c.push("top:",l,"px;");c.push("left:",f,"px;");r.getBox().style.cssText+=c.join("")};n.addEvent=function(e,t,n){d.add(e,t,n)};n.destroy=function(){c.destroy();d.destroy();r=null};return n}},K:function(e,t,n,r){var i=n("A");var s=n("l");var o=n("H");var u=n("L");e.exports=function(e,t){var n,r,a;var f=false;var l;var c={init:function(){c.pars();c.build();c.bind()},pars:function(){},build:function(){n=u(e,t);r=n.getBox();a=i.builder(r).list},bind:function(){}};c.init();l=n;l.getDomList=function(e){if(e){a=s(i.builder(r).list)}return a};l.setMask=function(){i.custEvent.add(n,"show",function(){if(!f){o.showUnderNode(r)}f=true});i.custEvent.add(n,"hide",function(){o.back();f=false})};return l}},l:function(e,t,n,r){e.exports=function(e){for(var t in e){if(e[t]&&e[t].length==1){e[t]=e[t][0]}}return e}},L:function(e,t,n,r){var i=n("A");var s=n("m");var o=n("i");var u=n("M");var a='<div node-type="outer" class="L_layer" style="display:none;position:absolute;"></div>';var f=100100;e.exports=function(e,t){var n,r,l,c;var h=null;var p=function(e){var t={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";t.w=e.offsetWidth;t.h=e.offsetHeight;e.style.display="none";e.style.visibility="visible"}else{t.w=e.offsetWidth;t.h=e.offsetHeight}return t};var d=function(e,t){t=t||"topleft";var n={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";n=i.core.dom.position(e);e.style.display="none";e.style.visibility="visible"}else{n=i.core.dom.position(e)}var r=p(e);switch(t){case"topleft":break;case"topright":n["l"]=n["l"]+r["w"];break;case"bottomleft":n["t"]=n["t"]+r["h"];break;case"bottomright":n["l"]=n["l"]+r["w"];n["t"]=n["t"]+r["h"];break;default:break}return n};var v={show:function(){r.style.display="";document.body.appendChild(r);i.custEvent.fire(v,"show");return v},hide:function(){r.style.display="none";i.custEvent.fire(v,"hide");return v},getState:function(){if(r.style.display=="none"){return false}else{return true}},getID:function(){return n.id},getBox:function(){return r},html:function(e){if(typeof e==="string"){r.innerHTML=e}else{r.appendChild(e)}return v},setTop:function(){r.parentNode&&r.parentNode.appendChild(r);return v},setPosition:function(e){r.style.top=e["t"]+"px";r.style.left=e["l"]+"px";return v},getPosition:function(e){return d(r,e)},setLayoutPos:function(e,t){s(r,e,t);return v},setMiddle:function(){var e=i.winSize();var t=v.getSize(true);var s=i.scrollPos()["top"]+(e.height-t.h)/2;r.style.top=(s>0?s:0)+n.offset[1]+"px";r.style.left=(e.width-t.w)/2+n.offset[0]+"px";return v},setAlign:function(e){e=i.parseParam({type:"c",offset:[0,0]},e||{});c=o(r,e.type,e.offset);return v},getSize:function(e){if(e||!h){h=p(r)}return h},setIndex:function(e){r.style.zIndex=e},destroy:function(){r.style.display="none";i.removeNode(r);c&&c.destroy();r=null}};var m={init:function(){m.pars();m.build();m.bind()},pars:function(){n=i.parseParam({id:"layer_"+i.core.util.getUniqueKey(),node:null,template:"",appendTo:document.body,draggable:false,zIndex:null,offset:[0,0]},t||{});if(i.isNode(e)){n.node=e||n.node}else{switch((typeof e||"").toLowerCase()){case"string":n.id=e||n.id;n.node=i.E(n.id)||null;break;case"object":n=i.parseParam(n,e||{});break}}},build:function(){r=n.node;l=n.appendTo;if(!r){nodes=i.builder(n.template||a);r=nodes.list["outer"][0];l&&l.appendChild(r)}else{if(!i.contains(l,r)){l&&l.appendChild(r)}}v.setIndex(n.zIndex||f);r.id=n.id},bind:function(){i.custEvent.define(v,["show","hide"]);if(n.draggable){u(r,{actObj:r,moveDom:r})}}};m.init();return v}},m:function(e,t,n,r){var i=n("A");e.exports=function(e,t,n){if(!i.isNode(t)){throw"kit.dom.layerOutElement need element as first parameter"}if(t===document.body){return false}if(!t.parentNode){return false}if(t.style.display==="none"){return false}var r,s,o,u,a,f,l;r=i.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},n);s=t;if(!s){return false}while(s!==document.body){s=s.parentNode;if(s.style.display==="none"){return false}f=i.getStyle(s,"position");l=s.getAttribute("layout-shell");if(f==="absolute"||f==="fixed"){break}if(l==="true"&&f==="relative"){break}}s.appendChild(e);o=i.position(t,{parent:s});u={w:t.offsetWidth,h:t.offsetHeight};a=r["pos"].split("-");if(a[0]==="left"){e.style.left=o.l+r.offsetX+"px"}else if(a[0]==="right"){e.style.left=o.l+u.w+r.offsetX+"px"}else if(a[0]==="center"){e.style.left=o.l+u.w/2+r.offsetX+"px"}if(a[1]==="top"){e.style.top=o.t+r.offsetY+"px"}else if(a[1]==="bottom"){e.style.top=o.t+u.h+r.offsetY+"px"}else if(a[1]==="middle"){e.style.top=o.t+u.h/2+r.offsetY+"px"}return true}},M:function(e,t,n,r){var i=n("A");e.exports=function(e,t){var n,r,s,o,u,a,f,l;var c=function(){h();p()};var h=function(){n=i.parseParam({moveDom:e,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},t);s=n.moveDom;r={};o={};u=i.drag(e,{actObj:n.actObj});if(n["dragtype"]==="perch"){a=i.C("div");f=false;l=false;s=a}e.style.cursor="move"};var p=function(){i.custEvent.add(n.actObj,"dragStart",d);i.custEvent.add(n.actObj,"dragEnd",v);i.custEvent.add(n.actObj,"draging",m)};var d=function(t,r){document.body.style.cursor="move";var s=i.core.util.pageSize()["page"];o=i.core.dom.position(n.moveDom);o.pageX=r.pageX;o.pageY=r.pageY;o.height=n.moveDom.offsetHeight;o.width=n.moveDom.offsetWidth;o.pageHeight=s["height"];o.pageWidth=s["width"];if(n["dragtype"]==="perch"){var u=[];u.push(n["perchStyle"]);u.push("position:absolute");u.push("z-index:"+(n.moveDom.style.zIndex+10));u.push("width:"+n.moveDom.offsetWidth+"px");u.push("height:"+n.moveDom.offsetHeight+"px");u.push("left:"+o["l"]+"px");u.push("top:"+o["t"]+"px");a.style.cssText=u.join(";");l=true;setTimeout(function(){if(l){document.body.appendChild(a);f=true}},100)}if(e.setCapture!==undefined){e.setCapture()}};var v=function(t,r){document.body.style.cursor="auto";if(e.setCapture!==undefined){e.releaseCapture()}if(n["dragtype"]==="perch"){l=false;n.moveDom.style.top=a.style.top;n.moveDom.style.left=a.style.left;if(f){document.body.removeChild(a);f=false}}};var m=function(e,t){var r=o.t+(t.pageY-o.pageY);var i=o.l+(t.pageX-o.pageX);var u=r+o["height"];var a=i+o["width"];var f=o["pageHeight"]-n["pagePadding"];var l=o["pageWidth"]-n["pagePadding"];if(u<f&&r>0){s.style.top=r+"px"}else{var c;if(u>=f){c=f-o["height"]}if(r<0||c<0){c=0}s.style.top=c+"px"}if(a<l&&i>0){s.style.left=i+"px"}else{if(i<0){s.style.left="0px"}if(a>=l){s.style.left=l-o["width"]+"px"}}};c();r.destroy=function(){document.body.style.cursor="auto";if(typeof s.setCapture==="function"){s.releaseCapture()}if(n["dragtype"]==="perch"){l=false;if(f){document.body.removeChild(a);f=false}}i.custEvent.remove(n.actObj,"dragStart",d);i.custEvent.remove(n.actObj,"dragEnd",v);i.custEvent.remove(n.actObj,"draging",m);if(u.destroy){u.destroy()}n=null;s=null;o=null;u=null;a=null;f=null;l=null};r.getActObj=function(){return n.actObj};return r}},n:function(e,t,n,r){var i={prov0:"城市/地区",code0:"0",prov34:"合肥,芜湖,蚌埠,淮南,马鞍山,淮北,铜陵,安庆,黄山,滁州,阜阳,宿州,巢湖,六安,亳州,池州,宣城",code34:"1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18",prov11:"东城区,西城区,崇文区,宣武区,朝阳区,丰台区,石景山区,海淀区,门头沟区,房山区,通州区,顺义区,昌平区,大兴区,怀柔区,平谷区,密云县,延庆县",code11:"1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17,28,29",prov50:"万州区,涪陵区,渝中区,大渡口区,江北区,沙坪坝区,九龙坡区,南岸区,北碚区,万盛区,双桥区,渝北区,巴南区,黔江区,长寿区,綦江县,潼南县,铜梁县,大足县,荣昌县,璧山县,梁平县,城口县,丰都县,垫江县,武隆县,忠县,开县,云阳县,奉节县,巫山县,巫溪县,石柱土家族自治县,秀山土家族苗族自治县,酉阳土家族苗族自治县,彭水苗族土家族自治县,江津区,合川区,永川区,南川区",code50:"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,40,41,42,43,81,82,83,84",prov35:"福州,厦门,莆田,三明,泉州,漳州,南平,龙岩,宁德",code35:"1,2,3,4,5,6,7,8,9",prov62:"兰州,嘉峪关,金昌,白银,天水,武威,张掖,平凉,酒泉,庆阳,定西,陇南,临夏,甘南",code62:"1,2,3,4,5,6,7,8,9,10,24,26,29,30",prov44:"广州,韶关,深圳,珠海,汕头,佛山,江门,湛江,茂名,肇庆,惠州,梅州,汕尾,河源,阳江,清远,东莞,中山,潮州,揭阳,云浮",code44:"1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,51,52,53",prov45:"南宁,柳州,桂林,梧州,北海,防城港,钦州,贵港,玉林,百色,贺州,河池,来宾,崇左",code45:"1,22,3,4,5,6,7,8,9,10,11,12,13,14",prov52:"贵阳,六盘水,遵义,安顺,铜仁,黔西南,毕节,黔东南,黔南",code52:"1,2,3,4,22,23,24,26,27",prov46:"海口,三亚,其他",code46:"1,2,90",prov13:"石家庄,唐山,秦皇岛,邯郸,邢台,保定,张家口,承德,沧州,廊坊,衡水",code13:"1,2,3,4,5,6,7,8,9,10,11",prov23:"哈尔滨,齐齐哈尔,鸡西,鹤岗,双鸭山,大庆,伊春,佳木斯,七台河,牡丹江,黑河,绥化,大兴安岭",code23:"1,2,3,4,5,6,7,8,9,10,11,12,27",prov41:"郑州,开封,洛阳,平顶山,安阳,鹤壁,新乡,焦作,濮阳,许昌,漯河,三门峡,南阳,商丘,信阳,周口,驻马店,济源",code41:"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18",prov42:"武汉,黄石,十堰,宜昌,襄阳,鄂州,荆门,孝感,荆州,黄冈,咸宁,随州,恩施土家族苗族自治州,仙桃,潜江,天门,神农架",code42:"1,2,3,5,6,7,8,9,10,11,12,13,28,29,30,31,32",prov43:"长沙,株洲,湘潭,衡阳,邵阳,岳阳,常德,张家界,益阳,郴州,永州,怀化,娄底,湘西土家族苗族自治州",code43:"1,2,3,4,5,6,7,8,9,10,11,12,13,31",prov15:"呼和浩特,包头,乌海,赤峰,通辽,鄂尔多斯,呼伦贝尔,兴安盟,锡林郭勒盟,乌兰察布盟,巴彦淖尔盟,阿拉善盟",code15:"1,2,3,4,5,6,7,22,25,26,28,29",prov32:"南京,无锡,徐州,常州,苏州,南通,连云港,淮安,盐城,扬州,镇江,泰州,宿迁",code32:"1,2,3,4,5,6,7,8,9,10,11,12,13",prov36:"南昌,景德镇,萍乡,九江,新余,鹰潭,赣州,吉安,宜春,抚州,上饶",code36:"1,2,3,4,5,6,7,8,9,10,11",prov22:"长春,吉林,四平,辽源,通化,白山,松原,白城,延边朝鲜族自治州",code22:"1,2,3,4,5,6,7,8,24",prov21:"沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,盘锦,铁岭,朝阳,葫芦岛",code21:"1,2,3,4,5,6,7,8,9,10,11,12,13,14",prov64:"银川,石嘴山,吴忠,固原,中卫",code64:"1,2,3,4,5",prov63:"西宁,海东,海北,黄南,海南,果洛,玉树,海西",code63:"1,21,22,23,25,26,27,28",prov14:"太原,大同,阳泉,长治,晋城,朔州,晋中,运城,忻州,临汾,吕梁",code14:"1,2,3,4,5,6,7,8,9,10,23",prov37:"济南,青岛,淄博,枣庄,东营,烟台,潍坊,济宁,泰安,威海,日照,莱芜,临沂,德州,聊城,滨州,菏泽",code37:"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17",prov31:"黄浦区,卢湾区,徐汇区,长宁区,静安区,普陀区,闸北区,虹口区,杨浦区,闵行区,宝山区,嘉定区,浦东新区,金山区,松江区,青浦区,南汇区,奉贤区,崇明县",code31:"1,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,30",prov51:"成都,自贡,攀枝花,泸州,德阳,绵阳,广元,遂宁,内江,乐山,南充,眉山,宜宾,广安,达州,雅安,巴中,资阳,阿坝,甘孜,凉山",code51:"1,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,32,33,34",prov12:"和平区,河东区,河西区,南开区,河北区,红桥区,塘沽区,汉沽区,大港区,东丽区,西青区,津南区,北辰区,武清区,宝坻区,宁河县,静海县,蓟县,滨海新区,保税区",code12:"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,21,23,25,26,27",prov54:"拉萨,昌都,山南,日喀则,那曲,阿里,林芝",code54:"1,21,22,23,24,25,26",prov65:"乌鲁木齐,克拉玛依,吐鲁番,哈密,昌吉,博尔塔拉,巴音郭楞,阿克苏,克孜勒苏,喀什,和田,伊犁,塔城,阿勒泰,石河子",code65:"1,2,21,22,23,27,28,29,30,31,32,40,42,43,44",prov53:"昆明,曲靖,玉溪,保山,昭通,楚雄,红河,文山,思茅,西双版纳,大理,德宏,丽江,怒江,迪庆,临沧",code53:"1,3,4,5,6,23,25,26,27,28,29,31,32,33,34,35",prov33:"杭州,宁波,温州,嘉兴,湖州,绍兴,金华,衢州,舟山,台州,丽水",code33:"1,2,3,4,5,6,7,8,9,10,11",prov61:"西安,铜川,宝鸡,咸阳,渭南,延安,汉中,榆林,安康,商洛",code61:"1,2,3,4,5,6,7,8,9,10",prov71:"台北市,高雄市,基隆市,台中市,台南市,新竹市,嘉义市,台北县,宜兰县,桃园县,新竹县,苗栗县,台中县,彰化县,南投县,云林县,嘉义县,台南县,高雄县,屏东县,澎湖县,台东县,花莲县,其他",code71:"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,90",prov81:"中西区,东区,九龙城区,观塘区,南区,深水埗区,黄大仙区,湾仔区,油尖旺区,离岛区,葵青区,北区,西贡区,沙田区,屯门区,大埔区,荃湾区,元朗区,其他",code81:"2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1",prov82:"花地玛堂区,圣安多尼堂区,大堂区,望德堂区,风顺堂区,氹仔,路环,其他",code82:"2,3,4,5,6,7,8,1",prov400:"美国,英国,法国,俄罗斯,加拿大,巴西,澳大利亚,印尼,泰国,马来西亚,新加坡,菲律宾,越南,印度,日本,新西兰,韩国,德国,意大利,爱尔兰,荷兰,瑞士,乌克兰,南非,芬兰,瑞典,奥地利,西班牙,比利时,挪威,丹麦,波兰,阿根廷,白俄罗斯,哥伦比亚,古巴,埃及,希腊,匈牙利,伊朗,蒙古,墨西哥,葡萄牙,沙特阿拉伯,土耳其,其他",code400:"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,16",prov100:"",code100:"",provinces:"北京,安徽,重庆,福建,甘肃,广东,广西,贵州,海南,河北,黑龙江,河南,湖北,湖南,内蒙古,江苏,江西,吉林,辽宁,宁夏,青海,山西,山东,上海,四川,天津,西藏,新疆,云南,浙江,陕西,台湾,香港,澳门,海外,其他",provcodes:"11,34,50,35,62,44,45,52,46,13,23,41,42,43,15,32,36,22,21,64,63,14,37,31,51,12,54,65,53,33,61,71,81,82,400,100"};e.exports=i},N:function(e,t,n,r){e.exports=function(e){if(!e||e.nodeType!==1){throw"fn-->show need a element node as parameter"}e.style.display="block"}},o:function(e,t,n,r){e.exports=function(e,t,n){t=t||function(e){return e};var r="",i=t('<div class="title" style="cursor: move;" node-type="title">2014年雪花纯生古建筑摄影</div><a href="#" action-type="cancel" class="close"></a><div class="L_pho_building">    <div class="intro clearfix">        <div class="txt_wrap">            <p class="tit M_txtc">雪花纯生中国古建筑摄影大赛•2014光影园林</p>            <p class="txt">“雪花纯生中国古建筑摄影大赛•2014光影园林”由华润雪花啤酒（中国）有限公司与清华大学建筑学院联合主办，此项赛事经过5届的成功举办，目前已成为全国规模最大的中国古建筑类摄影赛事。</br>            大赛在雪花纯生•中国古建筑官网 www.archfans.com征集作品，还将联手中国摄影家协会、大众摄影、华盖创意、纽约摄影学院、新浪、腾讯、网易、搜狐、人人网、色影无忌、POCO等平台共同征集。            </p>            <div class="more_wrap">                <a class="more" target="_blank" href="/events/snowbeer/2014">去活动页查看详情>></a>            </div>        </div>        <div class="pic">            <a target="_blank" href="/events/snowbeer/2014"><img src="'),s=t('" height="190" width="190" alt="雪花纯生古建筑摄影大赛"></a>        </div>    </div>    <div class="txt_wrap">        <p class="tit M_txtc">开始参加活动吧！</p>    </div>    <div class="form_items">    	<dl class="m_Layform item_part clearfix">            <dt><span class="M_required">*</span>昵称：</dt>            <dd class="contBox">'),o=t('</dd>       </dl>       <dl class="m_Layform item_part clearfix">            <dt><span class="M_required">*</span>选择参赛栏目：</dt>            <dd class="contBox">'),u=t('<label ><input name="part" node-type="part" class="M_radio" type="radio" data-name="'),a=t('" value="'),f=t('">'),l=t("(新浪分赛区)</label>"),c=t('            </dd>            <dd class="tipBox" style="display:none;" node-type="check_part">                <div class="m_ly_tip"><span class="txt">此项不能为空</span></div>            </dd>       </dl>       <dl class="m_Layform item_area clearfix">            <dt><span class="M_required">*</span>照片拍摄地区：</dt>            <dd class="contBox clearfix">                <div class="m_smltSelect">                    <div class="select" action-type="select_local">                        <span class="name M_txtb" node-type="select_result" data-code="" data-name="">地区选择</span>                        <span class="chose_btn M_ico"></span>                    </div>                    <div style="display:none;" node-type="provinces_choose" class="items M_linkh">                        '),h=t('                            <a title="'),p=t('" href="#" data-code="'),d=t("</a>                        "),v=t('                    </div>                </div>            </dd>            <dd class="tipBox" style="display:none;" node-type="check_local">                <div class="m_ly_tip"><span class="txt">此项不能为空</span></div>            </dd>       </dl>    </div>    '),m=t('    <div class="txt_wrap">        <p class="txt M_txtc">新建专辑</p>    </div>    <div class="album_info">        <div class="m_Layform clearfix">            <dt>专辑名称：</dt>            <dd class="contBox">                <input class="M_inpt" name="caption" type="text" node-type="caption" value="2014年雪花纯生古建筑摄影" readonly="true">            </dd>        </div>        <div class="m_Layform clearfix">            <dt>专辑描述：</dt>            <dd class="contBox">                <textarea name="description" class="M_txtarea" title="讲讲你和照片的故事…" node-type="desc">讲讲你和照片的故事…</textarea>            </dd>            <dd class="tipBox" style="display:none;" node-type="check_description">            <div class="m_ly_tip"><span class="txt" node-type="msg"></span></div>        </div>    </div>    '),g=t('    <div class="save_cal">        <a class="M_btn_e" action-type="submit" href="#"><span>确定</span></a>        <a class="M_btn_e" action-type="cancel" href="#"><span>取消</span></a>    </div></div>');r+=i;r+=e.mainPic;r+=s;r+=e.name;r+=o;for(e.info.i=0,e.info.len=e.info.length;e.info.i<e.info.len;e.info.i++){e.item=e.info[e.info.i];r+=u;r+=e.item.name;r+=a;r+=e.item.target_id;r+=f;r+=e.item.name;r+=l}r+=c;for(e.provinces.i=0,e.provinces.len=e.provinces.length;e.provinces.i<e.provinces.len;e.provinces.i++){e.item=e.provinces[e.provinces.i];r+=h;r+=e.item.name;r+=p;r+=e.item.code;r+=f;r+=e.item.name;r+=d}r+=v;if(e.createAlbum){r+=m}r+=g;return r}},O:function(e,t,n,r){function c(e,t){var n=e;var r=n.split("&");var i={};for(var s=0;s<r.length;s++){var o=r[s].split("=");var u=o[0],a=o[1];i[u]=a;if(u==t){return i.s1}}return i}var i=n("A");var s=n("d");var o=n("B");var u=n("g");var a=n("p");n("c");var f=s.baseURL;var l=function(e,t,n,r,s){var l=this;var c=null;this.helper=null;this.editLayer=e;this.photoList=t||e;this.maxTags=n||10;this.maxByteLength=r||20;this.maxShowLength=s||13;this.getCommonTags=function(e,t){var n=this;if(this.commonTags){if(t&&typeof t=="function"){t.call(this,this.commonTags)}return}u({url:f+"tags/suggest_tags",args:{count:e},onComplete:function(e){if(e&&e.result){n.commonTags=e.data;if(t&&typeof t=="function"){t.call(n,n.commonTags)}}}})};this.createCommonTags=function(e,t){var n,r=[];for(var i=0,s=e.length;i<s;i++){n=e[i];r.push('<a title="'+n+'" href="#" action-type="'+(t?"batch_add":"single_add")+'">'+n+"</a>")}return r.join("")};this.onBatchInputKeyup=function(e){var t=this.value,n=this.name;if(/(;|,|；|，|\s+|　+)$/.test(t)){t=t.substring(0,t.length-1);l.addTagsAll(t,n);this.value=""}e.preventDefault()};this.addTagsAll=function(e,t,n){var r,s;var o=i.sizzle("input[type=hidden][name="+t+"]",l.editLayer)[0];l.createTag(e,t,o,true);if(!l.hiddenInputs)l.hiddenInputs=i.sizzle("input[type=hidden]",l.photoList);for(var u=0,a=l.hiddenInputs.length;u<a;u++){s=l.hiddenInputs[u];r=s.name;(function(t,n){window.setTimeout(function(){i.sizzle("input[type=text][name="+t+"]",l.editLayer)[0].value="";l.createTag(e,t,n,true)},1)})(r,s)}};this.onBatchInputFocus=function(e){var t=e.target||e.srcElement;t.value="";i.removeClassName(t,"M_txte")};this.onBatchInputBlur=function(e){var t=e.target||e.srcElement;value=t.value,name=t.name,$hiddenInput=i.sizzle("input[type=hidden][name="+name+"]",l.editLayer);if(i.trim(value)==""){if($hiddenInput.value==""){i.addClassName(t,"M_txte");t.value=t.title}else{t.value=""}return}l.addTagsAll(value,name);t.value=""};this.onKeyup=function(e){var t=e.target||e.srcElement;var n=t.value;var r=t.name;if(/(;|,|；|，|\s+|　+)$/.test(n)){n=n.substring(0,n.length-1);var s=i.sizzle("input[type=hidden][name="+r+"]",l.editLayer)[0];l.createTag(n,r,s,true);t.value="";t.focus()}i.preventDefault()};this.onFocus=function(e){var t=e.target||e.srcElement;t.value="";i.removeClassName(t,"M_txte");i.preventDefault()};this.hideHelpLayer=function(e){c=window.setTimeout(function(){if(l.helpLayer)o(l.helpLayer)},150)};this.showHelpLayer=function(e){function s(){window.clearTimeout(c);window.setTimeout(function(){if(c){window.clearTimeout(c);c=null}},20);if(l.helpLayer)l.helpLayer.style.display=""}var t=i.sizzle("li[photoid="+e+"]",l.photoList)[0];var n=i.sizzle("div.tagarea",t)[0];var r;if(!n||!n.length){if(!l.helpLayer){l.helpLayer=i.C("div");l.helpLayer.className="tagarea";l.getCommonTags(10,function(e){l.helpLayer.innerHTML='<p class="t"><span class="M_ico M_icon29" action-type="close_help" title="关闭"></span>热门标签：</p>'+'<div class="m_tag_a">'+l.createCommonTags(e,false)+"</div>"});i.builder(t).list["common_tag"][0].appendChild(l.helpLayer);r=i.delegatedEvent(l.helpLayer);r.add("close_help","click",l.hideHelpLayer);i.addEvent(document.body,"click",function(e){var t=e.target||e.srcElement;if(l.helpLayer==t||i.contains(l.helpLayer,t)){if(t.getAttribute("action-type")!="close_help"){s()}}else{if(t.getAttribute("node-type")!="single_tag_input"&&t.getAttribute("action-type")!="remove_tag"){l.hideHelpLayer(e)}}})}else{i.builder(t).list["common_tag"][0].appendChild(l.helpLayer)}}s()};this.onBlur=function(e,t){var n=e.target||e.srcElement;var r=n.value;var s=n.name;var o=i.sizzle("input[type=hidden][name="+s+"]",l.editLayer)[0];l.createTag(r,s,o,true);if(!o.value||t){n.value=n.title;i.addClassName(n,"M_txte")}else{n.value=""}};this.createTag=function(e,t,n,r){if(e.trim()!==""){e=e.decodeHTML();var s=e.split(/\s+|,|;|；|，|　+/),o,u,a,f,c;for(var h=0,p=s.length;h<p;h++){o=s[h].trim();u=o.cutString(l.maxByteLength);c=o.cutString(l.maxByteLength,"",true);a=l.createTagHtml(o,t);if(u=="")continue;if(l.checkAndWriteData(n,c)){var d=i.sizzle("div[node-type=photo_tags_"+t+"]",l.editLayer)[0];(function(e){window.setTimeout(function(){i.addHTML(d,e)},100)})(a)}}}};this.createTagHtml=function(e,t,n){var r=e.cutString(l.maxByteLength);var i=r.cutString(l.maxShowLength,"...");var s='<span class="M_ico M_icon29" pid="'+t+'" tag="'+r+'" action-type="remove_tag" title="删除"></span>';if(n)s="";return'<a href="javascript:void(0)" title="'+r+'" data="'+r+'">'+i+s+"</a>"};this.checkAndWriteData=function(e,t){var n=e.value;var r=n==""?[]:n.split(/[,|\s]/);var i=r.length;if(i>=l.maxTags)return false;for(var s=0;s<i;s++){if(r[s]==t)return false}r.push(t);e.value=r.join(" ");return true};this.removeData=function(e,t,n){var r=e.value;var s=e.getAttribute("name");var o=i.sizzle("input[type=text][name="+s+"]",l.editLayer)[0];var u=r.split(" ");for(var a=0,f=u.length;a<f;a++){if(u[a]==t){u.splice(a,1);break}}e.value=i.trim(u.join(" "));if(!o.value&&n=="batch"){o.blur()}};this.removeTag=function(e){var t=e.target||e.srcElement;var n=t.getAttribute("tag");var r=t.getAttribute("pid");var s=i.sizzle("input[type=hidden][name="+r+"]",l.editLayer)[0];l.removeData(s,n);i.removeNode(a(t,{expr:"a"})[0]);if(r=="batch"){if(!l.hiddenInputs)l.hiddenInputs=i.sizzle("input[type=hidden]",l.photoList);for(var o=0,u=l.hiddenInputs.length;o<u;o++){l.removeData(l.hiddenInputs[o],n,r);i.removeNode(i.sizzle('a[data="'+n+'"]',l.photoList)[0])}}i.preventDefault()}};e.exports=l},p:function(e,t,n,r){var i=n("A");var s=n("P");e.exports=function(e,t){t=i.parseParam({expr:undefined,endpoint:document,maxLength:1},t);var n=t.expr;if(!e||!n){i.log("kit parents: node or opts.expr is undefined.");return}return s(e,t)}},P:function(e,t,n,r){var i=n("A");e.exports=function(e,t){t=i.parseParam({dir:"parentNode",expr:undefined,endpoint:document,maxLength:1},t);var n=t.dir,r=t.expr,s=t.endpoint,o=t.maxLength;if(!e||!r){i.log("kit dir: node or opts.expr is undefined.");return}var u=[],a=e[n];while(a){if(a.nodeType==1&&i.sizzle(r,null,null,[a]).length>0){u.push(a);if(u.length==o){break}}if(a==s){break}a=a[n]}return u}},q:function(e,t,n,r){function u(e,t){var n=s(e);var r={overflow:false,sum:n,overnum:Math.abs(t-n)};if(n>t){r.overflow=true}return r}var i=n("A");var s=n("Q");var o=n("r");e.exports=function(e){function v(e){var t=e.textEl;if(!t){throw"[editor plugin count]: plz check nodeList"}i.removeEvent(t,"focus",m);i.removeEvent(t,"blur",g)}function m(){if(p){return}p=true;d=false;l=setInterval(function(){b()},100)}function g(e){if(d){return}d=true;p=false;if(l){clearInterval(l)}}var t=e.nodeList;var n=e.opts;var r=e.fn||false;var s=e.before_cut||i.funcEmpty;var a=o;var f=n.limitNum;var l;v(t);var c=t.textEl;var h=t.wordNum;var p=false;var d=false;i.addEvent(c,"focus",m);i.addEvent(c,"blur",g);var y=i.trim;var b=function(){var e=c.value;var t=y(e);var n;t=t.replace(/\r\n/g,"\n");var o=u(t,f);if(o.overflow){if(s(o,t)!==false){c.value=i.leftB(t,f*2)}n=0}else{n=o.overnum}if(h&&1===h.nodeType){var a="";if(r&&"function"===i.getType(r)){a=r(n)}else{a="还可以输入<span>"+n+"</span>个字"}h.innerHTML=a}};return{destroy:function(){i.removeEvent(c,"focus",m);i.removeEvent(c,"blur",g);c=null}}}},Q:function(e,t,n,r){var i=n("A");e.exports=function(e){return Math.ceil(i.bLength(e)/2)}},r:function(e,t,n,r){var i=n("A");window.$LANG||(window.$LANG={});e.exports=function(e){var t=[].splice.call(arguments,1,arguments.length);var n=[e,$LANG].concat(t);var r=i.core.util.language.apply(this,n);return r}},R:function(e,t,n,r){e.exports=function(e,t,n){t=t||function(e){return e};var r="",i=t('<div class="title">'),s=t('</div><a class="close" action-type="cancel" href="#"></a><div class="L_sendweibo">    <div class="m_forward">      <p class="prompt M_txta">照片已保存，'),o=t('</p>      <p class="M_txtb letrCount" node-type="txt_tip">还可以输入<span>130</span>个字</p>      <div class="txtarea">      <textarea class="M_txtarea M_txta" node-type="textEl">'),u=t('</textarea>      </div>      <div class="face_cmn clearfix">        <div class="face">          <span class="M_ico M_icon30" action-type="face"></span><span class="M_txtb"></span>        </div>      </div>    </div>    <div class="m_box_mod select_pic_box">        <div class="hd  M_dotted_x clearfix">            <h4 class="M_txtc">选择展示图片<span class="M_txtb tip">(最多选10张)</span></h4>            <div class="act"> <span class="M_txte count">共'),a=t('张</span></div>        </div>        <div class="bd">            <ul class="m_selectpic_list clearfix" node-type="select_panel"></ul>        </div>    </div>    <div class="submit_centr"><a class="M_btn_e" action-type="ok" href="#"><span>发微博</span></a><a class="btn_skip" action-type="cancel" href="#"><span>跳过</span></a></div></div>');r+=i;r+=e.title;r+=s;r+=e.tip;r+=o;r+=e.content;r+=u;r+=e.count;r+=a;return r}},s:function(e,t,n,r){var i=n("A");var s=function(e,t,n,r,s){this.photos=e;this.selectedClass=s||"selected";this.imgSize=r||{w:"",h:""},this.limitCount=n||{min:1,max:6};this.container=t;this.selectedIds={};this.selectedCount=0;this.locked=false;var o=this;if(this.container){var u=i.delegatedEvent(this.container);u.add("select_photo","click",function(e){if(!o.locked){o.locked=true;var t=e.el;var n=e.data["photo_id"];var r=e.data["pid"];if(i.hasClassName(t,"selected")){if(o.selectedCount>o.limitCount.min&&n in o.selectedIds){delete o.selectedIds[n];o.selectedCount--;i.removeClassName(t,"selected")}}else{if(o.selectedCount<o.limitCount.max&&!(n in o.selectedIds)){o.selectedIds[n]={photo_id:n,pid:r};o.selectedCount++;i.addClassName(t,"selected")}}o.locked=false}return false})}this.initUI=function(){if(this.container&&this.photos){var e,t,r,i,s,o="",u="";for(var a=this.photos.length;a>0;a--){u="";e=this.photos[a-1];i=e.photo_id;s=e.pid;if(this.selectedCount<n.max){this.selectedCount++;this.selectedIds[i]={photo_id:i,pid:s};u=this.selectedClass}o+='<li class="'+u+'" action-data="pid='+s+"&photo_id="+i+'" action-type="select_photo"><div class="pic M_loading"><a href="javascript:void(0)"><img width="80" alt="" src="'+e.url+'"><span class="M_ico M_icon58"></span></a></div></li>'}this.container.innerHTML=o}};this.getIds=function(){var e=[],t=[];for(var n in this.selectedIds){e.push(n);t.push(this.selectedIds[n]["pid"])}return{ids:e,pids:t}}};e.exports=s},S:function(e,t,n,r){var i=n("A");var s=n("k");var o=n("t");var u='<div class="L_min_prompt">'+'<div class="prompt M_txtc">'+'<span class="mk_ico" node-type="icon"></span><span class="cont" node-type="msg"></span>'+"</div>"+"</div>";var a={suced:"mk_suced",error:"mk_fail",remind:"mk_remind"};e.exports=function(e,t){var n,r,f,l={};var c={init:function(){c.pars();c.build();c.bind()},pars:function(){t=o({temp:"",mask:false,type:"suced",timer:2e3},t)},build:function(){r=s(t.temp||u,t);f=r.getDomList(true);if(f.icon){i.addClassName(f.icon,a[t["type"]||"suced"])}if(f.msg){f.msg.innerHTML=e}r.setMiddle().show()},bind:function(){var e=parseInt(t.timer,10);if(e){setTimeout(function(){r.hide()},e)}}};c.init();l.layer=r;return l}},t:function(e,t,n,r){var i=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=Array.apply([],arguments),r=1,s,o=typeof n[n.length-1]=="boolean"?n.pop():true;if(n.length===1){e=!this.window?this:{};r=0}while(t=n[r++]){for(s in t){if(i.call(t,s)&&(o||!(s in e))){e[s]=t[s]}}}return e}},T:function(e,t,n,r){var i=n("A");var s=n("g");var o=n("d");var u=n("j");var a=n("S");var f=n("u");var l=n("B");var c=o.baseURL;var h=$CONFIG.account_uid;var p=function(e,t){function p(e,t){s({method:"post",url:c+"upload/photo",args:e,onComplete:function(e){if(i.getType(t)=="function"){t.call(this,e)}}})}t=t||{};var n=this,r=t.inputName||"album_id",o,h;this.logFrom=t.logFrom;this.container=e;this.commUploadPhotos=[];this.commUploadList=null;this.link=t.link||"";this.initCbk=t.initCbk;this.uplaodCbk=t.uplaodCbk;this.uploadCompleteCbk=t.uploadCompleteCbk;this.getAlbumId=t.getAlbumId||function(){return-1};this.getAlbumData=t.getAlbumData||function(){return{}};this.watermark=t.watermarkChkbox;this.param=t.param;this.oriPic=t.oriPicChkbox;this.doCommUpload=function(e){var t=e.el;var r=t.getAttribute("action-data");var s=i.sizzle("form[name=commUploadForm"+r+"]",n.container)[0];var p=i.sizzle("input:file",s)[0];var d="";var v;o=n.getAlbumId();h=n.getAlbumData();if(h[o]&&(h[o].type=="43"||h[o].type=="44")){d+="&pri=1"+"&type="+h[o].type}if(o==-1){a("请先选择一个专辑",{type:"remind"});return}if(p.value==""){f({text:u["18003"]});return}if(n.watermark&&n.watermark.checked){if(n.param){for(var m in n.param){d+="&"+m+"="+n.param[m]}}}s.setAttribute("action","http://picupload.service.weibo.com/interface/pic_upload.php?s=rdxt&app=miniblog"+d+"&cb="+c+"upload/simple_upload/pic/"+r);l(t);v=i.builder(s).list["up_status"][0];v.className="up_ing";v.style.display="";s.submit();return false};this.doCommUploadComplete=function(e){i.preventDefault();if(n.commUploadPhotos.length==0){f({text:u["18004"]});return}if(i.getType(n.uploadCompleteCbk)=="function"){var t="http://ww3.sinaimg.cn/mw690/"+n.commUploadPhotos[0].pid+".jpg";n.uploadCompleteCbk.call(n,n.commUploadPhotos,t,o)}};this.destroy=function(){};this.init=function(e){n.container=e||n.container;n.container.className="m_upPic";n.container.innerHTML=n.createCommonUpload();n.commUploadList=i.builder(n.container).list["comm_upload_list"][0];var t=i.delegatedEvent(n.container);t.add("comm_upload","click",n.doCommUpload);t.add("com_upload_complete","click",n.doCommUploadComplete);window.commonUploadComplete=function(e,t){var r,s=u["18002"],a;var c=i.sizzle("form[name=commUploadForm"+t+"]",n.container)[0];var h=i.sizzle("a[action-type=comm_upload]",c)[0];var d=i.builder(c).list["up_status"][0];var v={};if(i.getType(e)=="object"){r=parseInt(e.ret,10);if(r>0){a=e.pid;o=n.getAlbumId();if(n.logFrom)v["from"]=n.logFrom;v["album_id"]=o;v["pid"]=a;v["upload_type"]=1;p({album_id:o,pid:a,upload_type:1,isOrig:n.oriPic&&n.oriPic.checked?1:0},function(e){if(e&&e.result){n.commUploadPhotos.push({photo_id:e.data,pid:a,zone:2});n.insertUploadFormAndBtn();d.className="M_mkIco M_suced"}else{l(d);h.style.display="";f({text:e.msg||s});d.setAttribute("class","M_mkIco M_fail")}});return}else if(r==-9){s=u["18001"]}else if(r==-10){s=u["18005"]}}l(d);h.style.display="";f({text:s})};if(i.getType(n.initCbk)=="function")n.initCbk.apply(n,arguments);return false};this.insertUploadFormAndBtn=function(e){var t=this.commUploadList.children.length;var n=t+1;if(t<5){var r="<li>"+'<form name="commUploadForm'+n+'" target="uploadIframe'+n+'" method="POST" enctype="multipart/form-data">'+'<input type="file" contenteditable="false" name="pic1" size="41" class="ipt_fl"><a class="M_btn_e" action-type="comm_upload" action-data="'+n+'" href="#"><span>上传</span></a><span style="display:none;" node-type="up_status"></span>'+'<iframe name="uploadIframe'+n+'" style="display:none"></iframe>'+"</form>"+"</li>";i.insertHTML(this.commUploadList,r)}if(this.commUploadPhotos.length==1){this.composited_pic="http://ww3.sinaimg.cn/mw690/"+this.commUploadPhotos[0].pid+".jpg";i.insertHTML(this.container,'<div class="submit_fl"><a class="M_btn_e" href="#" action-type="com_upload_complete"><span>下一步</span></a></div>');if(i.getType(this.uplaodCbk)=="function"){this.uplaodCbk.call(this,arguments)}}};this.createCommonUpload=function(){var e='<p class="tip M_txtb">支持jpg/gif/png/jpeg格式，单张照片不超过20M'+this.link+"</p>"+'<ul class="up_list" node-type="comm_upload_list">'+"<li>"+'<form name="commUploadForm1" target="uploadIframe1"  method="POST" enctype="multipart/form-data">'+'<input type="file" name="pic1" size="41" contenteditable="false" class="ipt_fl"><a class="M_btn_e" action-type="comm_upload" action-data="1" href="#"><span>上传</span></a><span style="display:none;" node-type="up_status"></span>'+'<iframe name="uploadIframe1" style="display:none"></iframe>'+"</form>"+"</li>"+"</ul>";return e}};e.exports=p},u:function(e,t,n,r){var i=n("A");var s=n("k");var o='<#et temp data><div class="title" node-type="title">${data.title}</div>'+'<a href="#" class="close" action-type="cancel"></a>'+'<div class="L_prompt">'+'<div class="prompt M_txtc">'+'<span class="mk_ico ${data.icon}"></span><span class="cont" node-type="text">${data.text}</span>'+"</div>"+'<div class="submit_centr">'+'<a href="javascript:void(0)" class="M_btn_e" node-type="ok" action-type="ok"><span>确定</span></a>'+"</div>"+"</div></#et>";var u={success:"mk_suced",error:"mk_fail",remind:"mk_remind"};e.exports=function(e){var t,n;var r={};var u=i.core.util.easyTemplate;var a={init:function(){a.pars();a.build();a.bind()},pars:function(){t=i.parseParam({title:"提示",text:"",icon:"remind",ok:i.funcEmpty},e)},build:function(){var e=u(o,{title:t.title,text:t.text,icon:t.icon}).toString();n=s(e,t);n.setMiddle().show();var r=n.getDomList(true);var i=r.ok;i.focus()},bind:function(){i.custEvent.add(n,"hide",function(){i.custEvent.remove(n,"hide",arguments.callee);t["ok"]()})}};a.init();r.layer=n;return r}},U:function(e,t,n,r){function y(e,t,n){if(!u.isLogin()){location.reload();return}f({url:a+"albums/"+(t?"update":"create"),args:m(e),method:"post",onComplete:function(e){if(n&&i.getType(n)==="function"){n.call(this,e)}}})}var i=n("A");var s=n("v");var o=n("S");var u=n("D");var a=n("d").baseURL;var f=n("g");var l=n("N");var c=n("B");var h=n("q");var p=n("Q");var d=n("j");var v=n("V");var m=function(e){return i.htmlToJson(e)};var g=function(e,t){var n=true;var r=e.description;var s=e.error_tip;if(r.title==r.value){r.value=""}var o=e.caption;if(i.trim(o.value)===""){s.innerHTML='<span class="txt">专辑名称不能为空</span>';l(s);o.focus();return n=false}var u=i.sizzle("[name=property]:checked")[0].value;if(t.type==="44"){if(!i.sizzle("[name=price]:checked")[0]){s.innerHTML='<span class="txt">价格不能为空</span>';l(s);return n=false}}if(parseInt(u,10)==5){var a=e.question;if(i.trim(a.value)===""){s.innerHTML='<span class="txt">问题不能为空</span>';l(s);a.focus();return n=false}var f=e.answer;if(i.trim(f.value)===""){s.innerHTML='<span class="txt">答案不能为空</span>';l(s);f.focus();return n=false}}return n};e.exports=function(e,t){var n,r,u=null,a,f=null;var m;var b,w,E,S;var x=false;var T={init:function(){T.pars();T.build();T.bind()},pars:function(){e=i.parseParam({title:"编辑专辑",name:"",description:"讲讲你和照片的故事...（非必填）",auth:"1",price:"",prices:"",question:"",answer:"",album_id:"",isDefault:false,property:"1",type:"",afterEvent:i.funcEmpty},e||{});var n=t?"保存":"创建";e.disabled=t?"disabled":"";e.btn_text=n;e.auth==3&&(e.auth=4);e.type==31&&(e.isDefault=true);e.prices&&(e.prices=e.prices.split(","));e.counter={caption:p(e.name),desc:p(e.description),question:p(e.question),answer:p(e.answer)}},build:function(){r=s();r.setContent(v(e));r.setTitle(e.title);r.setMiddle().show();n=r.getBox();a=r.getDomList(true);u=a.ask_layer;var t=i.sizzle(":radio[name=property][value="+e.auth+"]",n)[0];var o=i.sizzle(":radio[name=price]",n)[0];var f=i.sizzle(":radio[name=price][value="+parseFloat(e.price,10)+"]",n)[0];if(t){t.checked=true}if(f){f.checked=true}else if(o){o.checked=true}if(e.auth==5){l(u)}w=h({nodeList:{textEl:a.caption,wordNum:a.caption_w},opts:{limitNum:15},fn:function(e){return e+"/15"}});b=h({nodeList:{textEl:a.description,wordNum:a.description_w},opts:{limitNum:140},fn:function(e){return e+"/140"}});E=h({nodeList:{textEl:a.question,wordNum:a.question_w},opts:{limitNum:20},fn:function(e){return e+"/20"}});S=h({nodeList:{textEl:a.answer,wordNum:a.answer_w},opts:{limitNum:20},fn:function(e){return e+"/20"}})},bind:function(){var s=function(e){var t=e.evt.target;if(t.value==5&&t.checked){l(u)}else{c(u)}};var f=function(e){var t=e.target||e.srcElement;if(t.value==t.title)t.value=""};var h=function(e){var t=e.target||e.srcElement;if(t.value==="")t.value=t.title};var p=function(n){i.preventDefault();var s=g(a,e);if(s&&!x){x=true;var u=n.el;i.addClassName(u,"M_btn_disb");y(a.album_form,t,function(n){x=false;i.removeClassName(u,"M_btn_disb");r.hide();if(n&&n.result){var s=e.afterEvent;if(s&&i.getType(s)==="function"){s.call(this,n.data)}o(t?d["10001"]:d["11001"])}else{o(n.msg||d["10010"],{type:"error"})}})}};m=i.delegatedEvent(n);m.add("change_permission","click",s);m.add("submit","click",p);i.addEvent(a.description,"focus",f);i.addEvent(a.description,"blur",h);i.custEvent.add(r,"hide",function(){i.custEvent.remove(r,"hide",arguments.callee);m.remove("change_permission","click");m.remove("submit","click");i.removeEvent(a.description,"focus",f);i.removeEvent(a.description,"blur",h);r.destroy();b.destroy();w.destroy();E.destroy();S.destroy()})}};T.init();f=r;return f}},v:function(e,t,n,r){var i=n("A");var s=n("M");var o=n("K");var u=n("t");var a=""+'<div class="L_layer" node-type="outer" style="display:none;position:absolute;">'+'<div class="bg">'+'<table border="0" cellspacing="0" cellpadding="0">'+"<tr><td>"+'<div class="content" node-type="layoutContent">'+'<div node-type="title" class="title" style="cursor: move;"><span node-type="title_content"></span></div>'+'<a node-type="close" action-type="close" title="关闭" href="javascript:void(0)" class="close"></a>'+'<div node-type="inner"></div>'+"</div>"+"</td></tr>"+"</table>"+"</div>"+"</div>";e.exports=function(e,t){var n,r,f,l,c,h,p,d,v;var m;var g;var y=function(){m.hide()};var b={close:function(e){i.stopEvent();m.hide()},show:function(){if(i.IE){document.body.focus()}else{document.documentElement.focus()}i.hotKey.add(document.documentElement,["esc"],y,{type:"keyup",disableInInput:true})}};var w={init:function(){w.pars();w.build();w.bind()},pars:function(){t=u({haveMask:true},t);t.template=a},build:function(){n=o(e,t);r=n.getBox();f=n.getDomList(true);l=f["title"];c=f["title_content"];v=f["layoutContent"];h=f["inner"];p=f["close"];t.haveMask&&n.setMask();d=i.objSup(n,["hide"])},bind:function(){var e=i.delegatedEvent(r);e.add("close","click",b.close);s(l,{actObj:n,moveDom:r});i.custEvent.add(n,"show",b.show);i.custEvent.add(n,"hide",function(){i.custEvent.remove(n,"hide",arguments.callee);i.custEvent.remove(n,"show",b.show);e.destroy();i.hotKey.remove(document.documentElement,["esc"],y,{type:"keyup"});s.destroy()})}};w.init();m=n;m.hide=function(e){if(typeof g==="function"&&!e){if(g()===false){return false}}d.hide();return m};m.setClassName=function(e){v.className=e;return m};m.setTitle=function(e){c.innerHTML=e;return m};m.setContent=function(e){h.innerHTML="";if(typeof e==="string"){h.innerHTML=e}else{h.appendChild(e)}return m};m.insertElement=function(e,t){t=t||"beforeend";i.core.dom.insertElement(h,e,t);return m};m.clearContent=function(){while(h.children.length){i.removeNode(h.children[0])}return m};m.setBeforeHideFn=function(e){g=e};m.clearBeforeHideFn=function(){g=null};m.getClose=function(){return p};m.getIndex=function(){var e=r.style.zIndex||0;return parseInt(e,10)};return m}},V:function(e,t,n,r){e.exports=function(e,t,n){t=t||function(e){return e};var r="",i=t('<div class="L_editalbum">\n  <form name="albumForm" node-type="album_form">\n    <div class="m_ly_tip" node-type="error_tip" style="display:none"></div>\n    <div class="album_info">\n        <dl class="m_Layform clearfix">\n            <dt>专辑名称：</dt>\n            <dd class="contBox"><input type="text" value="'),s=t('" '),o=t("disabled"),u=t(' name="caption" class="M_inpt" node-type="caption"></dd>\n            <dd class="tipBox"><span class="M_txte" node-type="caption_w">'),a=t('/15</span></dd>\n        </dl>\n        <dl class="m_Layform clearfix">\n            <dt>专辑描述：</dt>\n            <dd class="contBox"><textarea name="description" '),f=t(' title="讲讲你和照片的故事...（非必填）" class="M_txtarea" node-type="description">'),l=t('</textarea></dd>\n            <dd class="tipBox"><span class="M_txte" node-type="description_w">'),c=t('/140</span></dd>\n        </dl>\n    </div>\n    <div class="authority" '),h=t('style="display:none"'),p=t('>\n      <dl class="set_authort clearfix">\n        <dt>设置权限：</dt>\n        <dd class="M_txtb">\n            '),d=t('            	<p class="vip_value">我的会员可见</p>\n            	<input type="hidden" name="type" value="'),v=t('">\n            	<input type="radio" value="11" class="M_radio" id="vip" checked style="display:none" name="property" action-type="change_permission">\n            '),m=t(' <p class="opt_choose">'),g=t('<label><input type="radio" name="price" '),y=t(' value="'),b=t('" class="M_radio">'),w=t("元</label>"),E=t('<input type="radio" name="property" checked value="11" style="display:none" class="M_radio">\n<input type="hidden" name="type" value="'),S=t('">\n </p>\n <p class="vip_value M_txtb">专辑创建后，价格不可再修改</p>'),x=t('<p>谁可以看到这个专辑？</p>\n<ul class="userlist">\n<li><input type="radio" value="1" class="M_radio" id="all" checked name="property" action-type="change_permission"><label for="all">所有人</label></li>\n<li><input type="radio" value="4" class="M_radio" id="each_o" name="property" action-type="change_permission"><label for="each_o">相互关注的人</label></li>\n<li><input type="radio" value="2" class="M_radio" id="self" name="property" action-type="change_permission"><label for="self">仅自己</label></li>\n<li><input type="radio" value="5" class="M_radio" id="ask" name="property" action-type="change_permission"><label for="ask">问题访问</label></li>\n</ul>\n            '),T=t('        <input type="hidden" name="album_id" value="'),N=t('">\n        </dd>\n      </dl>\n      <div class="ask_q" node-type="ask_layer" style="display:none">\n        <dl class="m_Layform clearfix">\n            <dt>问题：</dt>\n            <dd class="contBox"><input type="text" name="question" value="'),C=t('" class="M_inpt" node-type="question"></dd>\n            <dd class="tipBox"><span class="M_txte" node-type="question_w">'),k=t('/20</span></dd>\n        </dl>\n        <dl class="m_Layform clearfix">\n            <dt>答案：</dt>\n            <dd class="contBox"><input type="text" name="answer" value="'),L=t('" class="M_inpt" node-type="answer"></dd>\n            <dd class="tipBox"><span class="M_txte" node-type="answer_w">'),A=t('/20</span></dd>\n        </dl>\n      </div>\n    </div>\n    <div class="save_cal">\n        <a href="#" action-type="submit" class="M_btn_e"><span>'),O=t('</span></a><a href="#" action-type="close" class="M_btn_e"><span>取消</span></a>\n    </div>\n  </form>\n</div>');r+=i;r+=e.name;r+=s;if(e.type==="45"){r+=o}r+=u;r+=15-e.counter.caption;r+=a;if(e.type==="45"){r+=o}r+=f;r+=e.description;r+=l;r+=140-e.counter.desc;r+=c;if(!e.auth){r+=h}r+=p;if(e.property==="11"&&e.type==="43"){r+=d;r+=e.type;r+=v}else if(e.property==="11"&&e.type==="44"&&e.prices&&e.prices.length){r+=m;for(e.prices.i=0,e.prices.len=e.prices.length;e.prices.i<e.prices.len;e.prices.i++){e.item=e.prices[e.prices.i];r+=g;r+=e.disabled;r+=y;r+=e.item;r+=b;r+=e.item;r+=w}r+=E;r+=e.type;r+=S}else{r+=x}r+=T;r+=e.album_id;r+=N;r+=e.question;r+=C;r+=20-e.counter.question;r+=k;r+=e.answer;r+=L;r+=20-e.counter.answer;r+=A;r+=e.btn_text;r+=O;return r}},w:function(e,t,n,r){var i=n("A");var s=n("m");var o=n("W");var u=n("r");var a=n("x");var f=n("Y");var l=n("g");var c=u;var h=""+'<div class="L_menu_list">'+'<span class="title">想用@提到谁？</span>'+'<ul class="atList" node-type="suggestWrap">'+"</ul>"+"</div>";var p={"@":{normalTitle:c("#L{选择昵称或轻敲空格完成输入}"),moreTitle:c("#L{选择最近@的人或直接输入}"),noTilte:c("#L{轻敲空格完成输入}")},"#":{normalTitle:c("#L{想用什么话题？}")}};var d={"@":"<#et temp data>"+"<#list data.data as list>"+'<li action-type="item" '+"<#if (list_index == 0)>"+'class="cur" '+"</#if>"+'action-data="value=${list.nickname}" value="${list.nickname}"><a href="#">${list.nickname}<#if (list.remark)>(${list.remark})</#if></a></li>'+"<#if (list.count)>"+"<span>${list.count}</span>"+"</#if>"+"</#list>"+"</#et>"};var v,m,g,y,b,w=false,E;var S;var x={"@":"followList","#":"topicList"};var T=0;var N=function(){setTimeout(function(){i.custEvent.fire(v,"close")},200)};var C=function(){b.style.display="none"};var k=function(){i.custEvent.add(v,"onIndexChange",function(e,t){_(t)});i.custEvent.add(v,"onSelect",function(e,t,n,r){T=0;i.core.evt.stopEvent();var s=S[t].getAttribute("value")+"";s=s.replace(/\(.*\)/,"");try{n.focus()}catch(u){}var a=o.selectionStart(n)*1;var f=new RegExp(r+"([a-zA-Z0-9一-龥_-]{0,20})$");var l=n.value.replace(/\r+/g,"").slice(0,a).match(f);var c=n.value.slice(a,a+1);l=l&&l[1]?l[1].length:0;var h=o;if(r=="#"){if(typeof c!="undefined"&&c!=r){s=s+r+" "}}else{s=s+" "}h.insertText(n,s,a,l);var p=h.getCursorPos(n);if(r=="#"&&c==r){h.setCursor(n,p+1);h.insertText(n," ",p+1,0)}p=h.getCursorPos(n);var d=h.getSelectedText(n);var m=d===""||d===null?0:d.length;n.setAttribute("range",p+"&"+m);i.custEvent.fire(v,"close")});i.addEvent(g.textEl,"blur",N);i.custEvent.add(v,"onClose",C);i.custEvent.add(v,"onOpen",function(e,t){y.style.display="";b.style.display="";w=true;setTimeout(function(){i.custEvent.fire(v,"indexChange",0)},100)})};var L=function(e,t,n){var r="";if(t.result){r=i.core.util.easyTemplate(d[e],t.data)}return r};var A=function(){i.custEvent.add(m,"hidden",function(e,t){i.custEvent.fire(v,"close")});var e="";i.custEvent.add(m,"at",function(t,n){var r=e=n.key;var s=n.flag;if(r.length===0&&s!=="@"){i.custEvent.fire(v,"close");return}l({url:$CONFIG.base_url+"sina/aj_searchat",args:{key:r,count:20},onComplete:function(t){var o=L(s,t,r);if(!o){i.custEvent.fire(v,"close");return}if(e===r){var u=n.textarea;i.custEvent.fire(v,"openSetFlag",s);i.custEvent.fire(v,"open",u);var a=i.core.dom.builder(o);var f=a.box;y.innerHTML=f;b.style.cssText=["width:180px;z-index:11001;background-color:#ffffff;position:absolute;"].join("");var l=n.l;if(document.body.clientWidth<n.fl+i.core.dom.getSize(b).width&&n.fl>i.core.dom.getSize(b).width){l=n.l-i.core.dom.getSize(b).width}var c=i.position(u);b.style.top=c.t+n.t+"px";b.style.left=c.l+n.l+"px"}},onFail:function(){i.custEvent.fire(v,"close")}})})};var O=function(){E=g.textEl;m=a({textEl:E,flag:"@|#"})};var M=function(e){T=0;b&&(b.style.display="none");b&&(b.innerHTML="");b=STK.C("div");document.body.appendChild(b);if(b.innerHTML.length===0){b.innerHTML=h;y=i.sizzle('[node-type="suggestWrap"]',b)[0];b.style.display="none"}v&&i.custEvent.fire(v,"close");v&&i.custEvent.remove(v);v=f({textNode:e,uiNode:y,actionType:"item",actionData:"value",flag:"@"});k()};var _=function(e){S=i.sizzle("li[class!=suggest_title]",y);S&&S[0]&&i.core.dom.removeClassName(S[T],"cur");i.core.dom.addClassName(S[e],"cur");T=e};e.exports=function(e,t){g=e.nodeList;var n={};n.init=function(){O();M(g.textEl);A()};return n}},W:function(e,t,n,r){var i={},s=document.selection;i.selectionStart=function(e){if(!s){try{return e.selectionStart}catch(t){return 0}}var n=s.createRange(),r,i,o=0;var u=document.body.createTextRange();try{u.moveToElementText(e)}catch(t){}for(o;u.compareEndPoints("StartToStart",n)<0;o++){u.moveStart("character",1)}return o};i.selectionBefore=function(e){return e.value.slice(0,i.selectionStart(e))};i.selectText=function(e,t,n){e.focus();if(!s){e.setSelectionRange(t,n);return}var r=e.createTextRange();r.collapse(1);r.moveStart("character",t);r.moveEnd("character",n-t);r.select()};i.insertText=function(e,t,n,r){e.focus();r=r||0;if(!s){var o=e.value,u=n-r,a=u+t.length;e.value=o.slice(0,u)+t+o.slice(n,o.length);i.selectText(e,a,a);return}var f=s.createRange();f.moveStart("character",-r);f.text=t};i.replaceText=function(e,t){e.focus();var n=e.value;var r=i.getSelectedText(e);var o=r.length;if(r.length==0){i.insertText(e,t,i.getCursorPos(e))}else{var u=i.getCursorPos(e);if(s){var a=s.createRange();a.text=t;i.setCursor(e,u+t.length)}else{var f=u+r.length;e.value=n.slice(0,u)+t+n.slice(u+o,n.length);i.setCursor(e,u+t.length);return}}};i.getCursorPos=function(e){var t=0;if(STK.core.util.browser.IE){e.focus();var n=null;n=s.createRange();var r=n.duplicate();r.moveToElementText(e);r.setEndPoint("EndToEnd",n);e.selectionStartIE=r.text.length-n.text.length;e.selectionEndIE=e.selectionStartIE+n.text.length;t=e.selectionStartIE}else if(e.selectionStart||e.selectionStart=="0"){t=e.selectionStart}return t};i.getSelectedText=function(e){var t="";var n=function(e){if(e.selectionStart!=undefined&&e.selectionEnd!=undefined)return e.value.substring(e.selectionStart,e.selectionEnd);else return""};if(window.getSelection){t=n(e)}else{t=s.createRange().text}return t};i.setCursor=function(e,t,n){t=t==null?e.value.length:t;n=n==null?0:n;e.focus();if(e.createTextRange){var r=e.createTextRange();r.move("character",t);r.moveEnd("character",n);r.select()}else if(e.setSelectionRange){e.setSelectionRange(t,t+n)}};i.unCoverInsertText=function(e,t,n){n=n==null?{}:n;n.rcs=n.rcs==null?e.value.length:n.rcs*1;n.rccl=n.rccl==null?0:n.rccl*1;var r=e.value,i=r.slice(0,n.rcs),s=r.slice(n.rcs+n.rccl,r==""?0:r.length);e.value=i+t+s;this.setCursor(e,n.rcs+(t==null?0:t.length))};e.exports=i},x:function(e,t,n,r){var i=n("A");var s=n("X");var o=n("W");var u=n("y");var a=window,f=document,l=i.core.util.browser,c="font-family:Tahoma,宋体;",h=o.selectionStart;var p;var d,v,m,g;var y=function(){var e={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',c,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',c,'"> </span>'].join("")};return function(t){var n=t.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(t){return e[t]});return n}}();var b=function(){var e=[],t=p.textEl.style.cssText,n;i.foreach(["margin","padding","border"],function(t){i.foreach(["Top","Left","Bottom","Right"],function(n){var r;if(t!="border"){r=e.push(t,"-",n.toLowerCase(),":",i.getStyle(p.textEl,t+n),";");return}i.foreach(["Style","Width"],function(r){e.push(t,"-",n.toLowerCase(),"-",r.toLowerCase(),":",i.getStyle(p.textEl,[t,n,r].join("")),";")})})});e.push("font-size:"+i.getStyle(p.textEl,""+"fontSize")+";");return s([t,e.join(""),c,"        word-wrap: break-word;        line-height: 18px;        overflow-y:auto;        overflow-x:hidden;        outline:none;    "].join("")).getCss()};var w=function(){var e=i.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list;var t=e["wrap"][0],n=e["flag"][0],r=e["after"][0],s=e["before"][0],o=0,u,a,c;var h=function(e){if(l.MOZ){return-2}if(l.MOBILE&&l.SAFARI&&(l.IPAD||l.ITOUCH||l.IPHONE)){return-2}return 0};return{bind:function(){if(a===p.textEl){return}g=i.position(p.textEl);var e=["left:",g.l,"px;top:",g.t+20,"px;"].join("");a=p.textEl;var n=b();a.style.cssText=n;c=[e,n,"                position:absolute;                filter:alpha(opacity=0);                opacity:0;                z-index:-1000;            "].join("");t.style.cssText=c;if(!o){o=1;f.body.appendChild(t)}},content:function(e,o,f,l){t.style.cssText=[c,"                width:",(parseInt(i.getStyle(a,"width"))||a.offsetWidth)+h(),"px;                height:",parseInt(i.getStyle(a,"height"))||a.offsetHeight,"px;                overflow-x:hidden;                overflow-y:",/webkit/i.test(navigator.userAgent)?"hidden":i.getStyle(a,"overflowY"),";            "].join("");s.innerHTML=y(e);n.innerHTML=y(o)||"&thinsp;";r.innerHTML=y([f,l].join(""));clearTimeout(u);u=setTimeout(function(){var e=i.position(n);i.custEvent.fire(p.eId,"at",{t:e.t-a.scrollTop-g.t,l:e.l-g.l,fl:e.l,key:f,flag:o,textarea:p.textEl})},200)},hide:function(){t.style.display="none"},show:function(){t.style.display=""}}}();var E=function(){if(u(p.textEl)){clearInterval(d);return}var e=p.textEl.value.replace(/\r/g,"");var t=h(p.textEl);if(t<0||t==m){return}m=t;var n=e.slice(0,t);var r=n.match(new RegExp(["(",p["flag"],")([a-zA-Z0-9一-龥_-]{0,20})$"].join("")));if(!r){i.custEvent.fire(p.eId,"hidden");return}var s=e.slice(t);n=n.slice(0,-r[0].length);w.content(n,r[1],r[2],s)};e.exports=function(e){if(!e||!e["textEl"]){return}e=i.parseParam({textEl:null,flag:"@",eId:i.custEvent.define({},["at","hidden"])},e);var t=function(){if(!p){return}clearInterval(d);i.removeEvent(p.textEl,"blur",t);w.hide()};var n=function(){t();p=e;m=null;w.bind();w.show();d=setInterval(E,200);i.addEvent(e.textEl,"blur",t)};i.addEvent(e.textEl,"focus",n);return e["eId"]}},X:function(e,t,n,r){var i=function(e,t){var n=(e+";"+t).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),r;while(n&&(r=n.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i))){n=n.replace(r[1]+r[2]+r[3],"")}return n};e.exports=function(e){e=e||"";var t=[],n={push:function(e,r){t.push(e+":"+r);return n},remove:function(e){for(var r=0;r<t.length;r++){if(t[r].indexOf(e+":")==0){t.splice(r,1)}}return n},getStyleList:function(){return t.slice()},getCss:function(){return i(e,t.join(";"))}};return n}},y:function(e,t,n,r){e.exports=function(e){return!(e.parentNode&&e.parentNode.nodeType!=11&&!e.disabled)}},Y:function(e,t,n,r){var i=n("A");var s=null,o=i.custEvent,u=o.define,a=o.fire,f=o.add,l=i.addEvent,c=i.removeEvent,h=i.stopEvent;var p=[],d={};var v={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9};var m=function(e){var t=-1,n=[],r=e["textNode"],s=e["uiNode"];var o=i.core.evt.delegatedEvent(s);var p=u(r,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen","openSetFlag"]);p.setFlag=d;var d=function(t){e.flag=t};var m=function(){return i.sizzle(["[action-type=",e["actionType"],"]"].join(""),s)};var g=function(){t=-1;c(r,"keydown",y);o.destroy()};var y=function(n){var s,o;if(!(s=n)||!(o=s.keyCode)){return}if(o==v["ENTER"]){a(p,"onSelect",[t,r,e.flag]);i.preventDefault()}if(o==v["UP"]){h();var u=m().length;t=t<1?u-1:t-1;a(p,"onIndexChange",[t]);return false}if(o==v["DOWN"]){h();var u=m().length;t=t==u-1?0:t+1;a(p,"onIndexChange",[t]);return false}if(o==v["ESC"]){h();g();a(p,"onClose");return false}if(o==v["TAB"]){g();a(p,"onClose");return false}};var b=function(t){a(p,"onSelect",[i.core.arr.indexOf(t.el,m()),r,e["flag"]])};var w=function(e){t=i.core.arr.indexOf(e.el,m());a(p,"onIndexChange",[i.core.arr.indexOf(e.el,m())])};f(p,"open",function(t,n){r=n;g();l(n,"keydown",y);o.add(e["actionType"],"mouseover",w);o.add(e["actionType"],"click",b);a(p,"onOpen",[e.flag])});f(p,"openSetFlag",function(e,t){d(t)});f(p,"close",function(){g();a(p,"onClose",[e.flag])});f(p,"indexChange",function(n,r){t=r;a(p,"onIndexChange",[t,e.flag])});return p};var g=function(e){var t=e["textNode"];var n=i.core.arr.indexOf(t,p);if(!d[n]){p[n=p.length]=t;d[n]=m(e)}return d[n]};e.exports=function(e){if(!e["textNode"]||!e["uiNode"]){return}e=i.parseParam({textNode:s,uiNode:s,actionType:"item",actionData:"index",flag:""},e);return g(e)}},z:function(e,t,n,r){var i=function(e,t){if(!e)return undefined;if(e["pic_type"]==2&&e["pri_"+t+"_pic"]){return e["pri_"+t+"_pic"]}var n=e["pic_host"],r=e["pic_type"],i=e["uid"],s=e["pic_name"];if(n&&s){if(r==1){return n+"/"+t+"/"+s}else if(r==0&&e["avatar_large"]){return e["avatar_large"]}}else{return e[t+"_pic"]}};e.exports=i},Z:function(e,t,n,r){var i=n("A");var s=n("g");var o=n("H");var u=n("d");var a=n("k");var f=n("aa");var l=n("B");var c=function(e){function d(){var e="",t=l.orgFlag,n=l.eventRec,r=l.tagRec,i=l.userRec,s=l.orgRec,o=true,u=/^http(s?):\/\//.test(n.url)?n.url:"http://"+n.url;e+='<a href="#" action-type="cancel" class="close"></a>'+'<div class="L_guide">'+'<div class="guide_hd">'+'<h3 class="M_hidetxt">微相册推荐精彩内容</h3>'+'<div class="pic_area">'+'<a title="'+(n.name||"")+'" href="'+u+'" target="_blank"><img src="'+n.pic+'" alt=""></a>'+"</div>"+'<div class="m_box_mod hot_tags">'+'<div class="hd">'+'<h4><span class="M_ico M_icon81"></span>热门标签</h4>'+"</div>"+'<div class="bd">'+'<div class="m_photo_list_a">'+v(r)+"</div>"+"</div>"+"</div>"+"</div>"+'<div class="guide_bd">'+'<div class="m_box_mod famous_phor">'+'<div class="hd">'+'<h4><span class="M_ico M_icon82"></span>知名摄影人</h4>'+'<div class="act">'+'<label for="user_checkall" class="check_all">'+'<input id="user_checkall" value="list_user" class="M_checkbox" checked="'+o+'" type="checkbox">全选加关注'+"</label>"+"</div>"+"</div>"+'<div class="bd">'+'<div class="m_photo_list_a" node-type="list_user">'+m(i,o)+"</div>"+"</div>"+"</div>"+g(s,o,t)+"</div>"+'<div class="guide_ft">'+'<div class="btn_wrap">'+'<a href="#" action-type="try_now" class="M_btn_a"><span>立即体验</span></a>'+"</div>"+"</div>"+"</div>";return e}function v(e){var t=[],n,i,s;if(e){t.push('<ul class="photoList clearfix">');for(var o=0,u=e.length;o<u;o++){n=e[o];s=n.name;i=r+"tags/best/tag/"+s+"?prel=p7_2";t.push("<li>");t.push('<dl class="m_photoItem m_photoItem_a">');t.push('<dt class="photo">');t.push('<a href="'+i+'" target="_blank"><img src="'+n.pic+'" alt=""></a>');t.push("</dt>");t.push("<dd>");t.push('<p class="M_linkc desc"><a href="'+i+'" target="_blank" title="">'+s+"</a></p>");t.push("</dd>");t.push("</dl>");t.push("</li>")}t.push("</ul>")}return t.join("")}function m(e,t){var n=[],i,s,o;if(e){n.push('<ul class="photoList clearfix">');for(var u=0,a=e.length;u<a;u++){s=e[u];i=s.uid;o=r+i+"/albums";n.push("<li>");n.push('<dl class="m_photoItem m_photoItem_a">');n.push('<dt class="photo">');n.push('<a href="'+o+'" target="_blank"><img src="'+s.profile+'" alt=""></a>');n.push('<input class="M_checkbox" value="'+i+'" name="user" checked="'+!!t+'" type="checkbox">');n.push("</dt>");n.push("<dd>");n.push('<p class="M_linkc desc"><a href="'+o+'" target="_blank" title="">'+s.screen_name+"</a></p>");n.push("</dd>");n.push("</dl>");n.push("</li>")}n.push("</ul>")}return n.join("")}function g(e,t,n){var r="";if(!n){r='<div class="m_box_mod phor_agency">'+'<div class="hd">'+'<h4><span class="M_ico M_icon83"></span>摄影机构</h4>'+'<div class="act">'+'<label for="org_checkall" class="check_all">'+'<input id="org_checkall" value="list_org" class="M_checkbox" checked="'+!!t+'" type="checkbox">全选加关注'+"</label>"+"</div>"+"</div>"+'<div class="bd">'+'<div class="m_photo_list_a" node-type="list_org">'+m(e,t)+"</div>"+"</div>"+"</div>"}return r}var t=[];var n="1962310741";var r=u.baseURL;var l=null;var c=this;var h;t[0]='<dl class="guide_info">'+'<dt>新版"微相册"</dt>'+"<dd>围观Ta的生活映像，闪耀你的精致视界！</dd>"+"<dd>快速上传、美图、高清大图。</dd>"+'<dd class="follow"><label for="follow" action-type="check_fllow" class="follow"><input type="checkbox" checked="checked" id="follow">关注"微相册"官方微博</label></dd>'+'<dd class="btn_wrap"><a class="btn_next" href="javascript:void(0)">下一步</a></dd>'+"</dl>";var c=this;this.curStep=e||0;this.guideNode=i.C("div");this.guideNode.className="m_guide";var p=i.delegatedEvent(this.guideNode);this.do_step=function(){if(t[this.curStep]){this.guideNode.innerHTML=t[this.curStep]}};this.hide=function(){p||p.destroy();i.removeNode(c.guideNode);i.removeEvent(document,"click",this.goShareToWB)};this.shareToWB=function(){f({beforeHideFn:c.showRecommendLayer})};this.show=function(){this.guideNode.style.display=""};this.setPosition=function(){var e=i.core.dom.getSize(this.guideNode);var t=i.winSize().width-e.width/2;this.guideNode.style.top=0;this.guideNode.style.zIndex=1e4};this.getUserByUid=function(e,t){s({dataType:"json",url:r+"users/get_user",data:{uid:e},type:"get",success:function(e){if(t&&typeof t=="function"){t.call(c,e)}}})};this.do_follow=function(e,t){s({url:r+"users/follow",args:{uid:e},method:"post",onComplete:function(e){if(t&&typeof t=="function"){t.call(this,e)}}})};this.follow_batch=function(e,t){s({url:r+"users/follow_batch",args:{uids:e},method:"post",onComplete:function(e){if(t&&typeof t=="function"){t.call(this,e)}}})};this.addEvent=function(){p.add("check_fllow","click",function(e){e.stopEvent()});p.add("close","click",this.goShareToWB);i.addEvent(document,"click",this.goShareToWB)};this.goShareToWB=function(){var e=i.E("#follow");if(e&&e.checked){c.getUserByUid(n,function(e){if(e&&e.result){if(e.data&&!e.data.following){c.do_follow(n)}}})}c.hide();o.hide();c.shareToWB();i.preventDefault()};this.getRecommendData=function(e){if(l){if(e&&typeof e=="function"){e.apply(this,argumengts)}}else{s({url:r+"users/get_guide",method:"get",onComplete:function(t){if(t&&t.result){l=t.data;if(e&&typeof e=="function"){e.apply(c,arguments)}}}})}};this.showRecommendLayer=function(){c.getRecommendData(function(){h=a(d(),{title:false});h.setMiddle().show();c.addRecommendEvent(h.getBox())})};this.addRecommendEvent=function(e){function r(e){var t=e.target||e.srcElement;var n=t.value,r=i.builder(h.getBox()).list[n][0];nodes=i.sizzle("input:checkbox",r);window.setTimeout(function(){i.foreach(nodes,function(e,n){e.checked=t.checked})},10)}if(e){var t=i.E("org_checkall");var n=i.E("user_checkall");i.addEvent(org_checkall,"click",r);i.addEvent(n,"click",r);h.addEvent("try_now","click",function(){c.doTryNow(e);i.removeEvent(t,"click",r);i.removeEvent(n,"click",r);i.preventDefault()})}};this.doTryNow=function(e){var t=i.sizzle("input[type=checkbox][name=user]",e);var n=[];for(var r=0,s=t.length;r<s;r++){if(t[r].checked)n.push(t[r].value)}if(n.length){c.follow_batch(n.join(","))}h.hide()};this.init=function(){if($CONFIG&&$CONFIG.account_settings&&$CONFIG.account_settings.guide){document.body.appendChild(this.guideNode);o.showUnderNode(this.guideNode);this.do_step();this.show();this.setPosition();this.addEvent()}};this.init()};e.exports=c},aa:function(e,t,n,r){var i=n("A");var s=n("v");var o=n("g");var u=n("d");var a=n("aA");var f=n("D");var l=u.baseURL;e.exports=function(e){function h(e,t){o({url:l+"sina/update",args:e,method:"post",onComplete:function(e){if(t&&typeof t==="function"){t.call(this,e)}}})}var t,n,r,u=null;var f;var c={init:function(){c.pars();c.build();c.bind()},pars:function(){e=i.parseParam({title:"分享到微博",ok:i.funcEmpty,beforeHideFn:i.funcEmpty},e||{})},build:function(){n=s();n.setContent(a(e));n.setTitle(e.title);n.setClassName("L_shareWB");n.setMiddle().show();n.setBeforeHideFn(e.beforeHideFn);t=n.getBox();r=n.getDomList(true)},bind:function(){f=i.delegatedEvent(t);f.add("ok","click",function(){var e=i.sizzle("textarea",t)[0];h({content:e.value,type:1});n.hide()});i.custEvent.add(n,"hide",function(){i.custEvent.remove(n,"hide",arguments.callee);f.destroy();n.destroy()})}};c.init();u=n;return u}},aA:function(e,t,n,r){e.exports=function(e,t,n){t=t||function(e){return e};var r="",i=t('<div class="shareWB"><div class="txtarea"><textarea class="M_txtarea">我在用刚刚发布的#新版微相册#，看起来还不错～是个分享照片的好地方，想看看朋友们的照片吗？猛击这个链接[嘻嘻]</textarea></div><div class="shareTo"><a href="#" action-type="ok" class="M_btn_b"><span>开始使用微相册</span></a><a href="#" action-data="2" action-type="close" class="M_linkg">跳过</a></div></div>');r+=i;return r}}});